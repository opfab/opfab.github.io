<!DOCTYPE html>
<html lang="">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.18">
<title>Deployment and Administration of OperatorFabric</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/*! Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment the following line when using as a custom stylesheet */
/* @import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700"; */
html{font-family:sans-serif;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
b,strong{font-weight:bold}
abbr{font-size:.9em}
abbr[title]{cursor:help;border-bottom:1px dotted #dddddf;text-decoration:none}
dfn{font-style:italic}
hr{height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type=button],input[type=reset],input[type=submit]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type=checkbox],input[type=radio]{padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,::before,::after{box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;line-height:1;position:relative;cursor:auto;-moz-tab-size:4;-o-tab-size:4;tab-size:4;word-wrap:anywhere;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ul.square{list-style-type:square}
ul.circle ul:not([class]),ul.disc ul:not([class]),ul.square ul:not([class]){list-style:inherit}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:1px solid #dedede;word-wrap:normal}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre).nobreak{word-wrap:normal}
:not(pre).nowrap{white-space:nowrap}
:not(pre).pre-wrap{white-space:pre-wrap}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;border-radius:3px;box-shadow:0 1px 0 rgba(0,0,0,.2),inset 0 0 0 .1em #fff;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin:0 auto;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:flex;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border:1px solid #e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:none;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:hsla(0,0%,100%,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details{margin-left:1.25rem}
details>summary{cursor:pointer;display:block;position:relative;line-height:1.6;margin-bottom:.625rem;outline:none;-webkit-tap-highlight-color:transparent}
details>summary::-webkit-details-marker{display:none}
details>summary::before{content:"";border:solid transparent;border-left:solid;border-width:.3em 0 .3em .5em;position:absolute;top:.5em;left:-1.25rem;transform:translateX(15%)}
details[open]>summary::before{border:solid transparent;border-top:solid;border-width:.5em .3em 0;transform:translateY(15%)}
details>summary::after{content:"";width:1.25rem;height:1em;position:absolute;top:.3em;left:-1.25rem}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class=paragraph]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6);word-wrap:anywhere}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border:1px solid #e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border:1px solid #dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{border-radius:4px;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class=highlight],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos,pre.pygments .linenos{border-right:1px solid;opacity:.35;padding-right:.5em;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}
pre.pygments span.linenos{display:inline-block;margin-right:.75em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans-serif;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;font-size:.85rem;text-align:left;margin-right:0}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:1.25em;word-wrap:anywhere}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>*>tr>*{border-width:1px}
table.grid-cols>*>tr>*{border-width:0 1px}
table.grid-rows>*>tr>*{border-width:1px 0}
table.frame-all{border-width:1px}
table.frame-ends{border-width:1px 0}
table.frame-sides{border-width:0 1px}
table.frame-none>colgroup+*>:first-child>*,table.frame-sides>colgroup+*>:first-child>*{border-top-width:0}
table.frame-none>:last-child>:last-child>*,table.frame-sides>:last-child>:last-child>*{border-bottom-width:0}
table.frame-none>*>tr>:first-child,table.frame-ends>*>tr>:first-child{border-left-width:0}
table.frame-none>*>tr>:last-child,table.frame-ends>*>tr>:last-child{border-right-width:0}
table.stripes-all>*>tr,table.stripes-odd>*>tr:nth-of-type(odd),table.stripes-even>*>tr:nth-of-type(even),table.stripes-hover>*>tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
li>p:empty:only-child::before{content:"";display:inline-block}
ul.checklist>li>p:first-child{margin-left:-1em}
ul.checklist>li>p:first-child>.fa-square-o:first-child,ul.checklist>li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist>li>p:first-child>input[type=checkbox]:first-child{margin-right:.25em}
ul.inline{display:flex;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
td.hdlist2{word-wrap:anywhere}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:4px solid #fff;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);border-radius:50%;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt,summary{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt,summary{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]{border-bottom:1px dotted}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#header,#content,#footnotes,#footer{max-width:none}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media amzn-kf8,print{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<style>
/*! Stylesheet for CodeRay to loosely match GitHub themes | MIT License */
pre.CodeRay{background:#f7f7f8}
.CodeRay .line-numbers{border-right:1px solid;opacity:.35;padding:0 .5em 0 0;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}
.CodeRay span.line-numbers{display:inline-block;margin-right:.75em}
.CodeRay .line-numbers strong{color:#000}
table.CodeRay{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.CodeRay td{vertical-align:top;line-height:inherit}
table.CodeRay td.line-numbers{text-align:right}
table.CodeRay td.code{padding:0 0 0 .75em}
.CodeRay .debug{color:#fff!important;background:navy!important}
.CodeRay .annotation{color:#007}
.CodeRay .attribute-name{color:navy}
.CodeRay .attribute-value{color:#700}
.CodeRay .binary{color:#509}
.CodeRay .comment{color:#998;font-style:italic}
.CodeRay .char{color:#04d}
.CodeRay .char .content{color:#04d}
.CodeRay .char .delimiter{color:#039}
.CodeRay .class{color:#458;font-weight:bold}
.CodeRay .complex{color:#a08}
.CodeRay .constant,.CodeRay .predefined-constant{color:teal}
.CodeRay .color{color:#099}
.CodeRay .class-variable{color:#369}
.CodeRay .decorator{color:#b0b}
.CodeRay .definition{color:#099}
.CodeRay .delimiter{color:#000}
.CodeRay .doc{color:#970}
.CodeRay .doctype{color:#34b}
.CodeRay .doc-string{color:#d42}
.CodeRay .escape{color:#666}
.CodeRay .entity{color:#800}
.CodeRay .error{color:#808}
.CodeRay .exception{color:inherit}
.CodeRay .filename{color:#099}
.CodeRay .function{color:#900;font-weight:bold}
.CodeRay .global-variable{color:teal}
.CodeRay .hex{color:#058}
.CodeRay .integer,.CodeRay .float{color:#099}
.CodeRay .include{color:#555}
.CodeRay .inline{color:#000}
.CodeRay .inline .inline{background:#ccc}
.CodeRay .inline .inline .inline{background:#bbb}
.CodeRay .inline .inline-delimiter{color:#d14}
.CodeRay .inline-delimiter{color:#d14}
.CodeRay .important{color:#555;font-weight:bold}
.CodeRay .interpreted{color:#b2b}
.CodeRay .instance-variable{color:teal}
.CodeRay .label{color:#970}
.CodeRay .local-variable{color:#963}
.CodeRay .octal{color:#40e}
.CodeRay .predefined{color:#369}
.CodeRay .preprocessor{color:#579}
.CodeRay .pseudo-class{color:#555}
.CodeRay .directive{font-weight:bold}
.CodeRay .type{font-weight:bold}
.CodeRay .predefined-type{color:inherit}
.CodeRay .reserved,.CodeRay .keyword{color:#000;font-weight:bold}
.CodeRay .key{color:#808}
.CodeRay .key .delimiter{color:#606}
.CodeRay .key .char{color:#80f}
.CodeRay .value{color:#088}
.CodeRay .regexp .delimiter{color:#808}
.CodeRay .regexp .content{color:#808}
.CodeRay .regexp .modifier{color:#808}
.CodeRay .regexp .char{color:#d14}
.CodeRay .regexp .function{color:#404;font-weight:bold}
.CodeRay .string{color:#d20}
.CodeRay .string .string .string{background:#ffd0d0}
.CodeRay .string .content{color:#d14}
.CodeRay .string .char{color:#d14}
.CodeRay .string .delimiter{color:#d14}
.CodeRay .shell{color:#d14}
.CodeRay .shell .delimiter{color:#d14}
.CodeRay .symbol{color:#990073}
.CodeRay .symbol .content{color:#a60}
.CodeRay .symbol .delimiter{color:#630}
.CodeRay .tag{color:teal}
.CodeRay .tag-special{color:#d70}
.CodeRay .variable{color:#036}
.CodeRay .insert{background:#afa}
.CodeRay .delete{background:#faa}
.CodeRay .change{color:#aaf;background:#007}
.CodeRay .head{color:#f8f;background:#505}
.CodeRay .insert .insert{color:#080}
.CodeRay .delete .delete{color:#800}
.CodeRay .change .change{color:#66f}
.CodeRay .head .head{color:#f4f}
</style>
</head>
<body class="article toc2 toc-left">
<div id="header">
<h1>Deployment and Administration of OperatorFabric</h1>
<div class="details">
<span id="revnumber">version 4.7.0.RELEASE,</span>
<span id="revdate">05 May 2025</span>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_deployment">1. Deployment</a></li>
<li><a href="#_user_computer">2. User computer</a></li>
<li><a href="#_configuration">3. Configuration</a>
<ul class="sectlevel2">
<li><a href="#_business_service_configuration">3.1. Business service configuration</a>
<ul class="sectlevel3">
<li><a href="#_shared_service_configuration">3.1.1. Shared service configuration</a>
<ul class="sectlevel4">
<li><a href="#_mongo_configuration">3.1.1.1. Mongo configuration</a></li>
<li><a href="#_rabbitmq">3.1.1.2. RabbitMQ</a></li>
<li><a href="#_internal_account">3.1.1.3. Internal account</a></li>
<li><a href="#_optional_configuration_values">3.1.1.4. Optional configuration values</a></li>
</ul>
</li>
<li><a href="#_service_specific_configurations">3.1.2. Service specific configurations</a>
<ul class="sectlevel4">
<li><a href="#_businessconfig_service">3.1.2.1. Businessconfig service</a></li>
<li><a href="#_users_service">3.1.2.2. Users service</a></li>
<li><a href="#cards-pub-conf">3.1.2.3. Cards-publication service</a></li>
<li><a href="#_cards_consultation_service">3.1.2.4. Cards-consultation service</a></li>
<li><a href="#external-devices-conf">3.1.2.5. External devices service</a></li>
<li><a href="#cards-external-diffusion-conf">3.1.2.6. Cards external diffusion service</a></li>
<li><a href="#cards-reminder-conf">3.1.2.7. Cards reminder service</a></li>
<li><a href="#supervisor-conf">3.1.2.8. Supervisor service</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_web_ui_configuration">3.2. Web UI Configuration</a>
<ul class="sectlevel3">
<li><a href="#_nginx_configuration">3.2.1. NGINX configuration</a></li>
<li><a href="#ui_properties">3.2.2. UI properties</a></li>
</ul>
</li>
<li><a href="#opfab_spec_conf">3.3. Security Configuration</a>
<ul class="sectlevel3">
<li><a href="#_authentication_configuration">3.3.1. Authentication configuration</a>
<ul class="sectlevel4">
<li><a href="#_nginx_configuration_2">3.3.1.1. Nginx Configuration</a></li>
<li><a href="#_configuration_file_common_yml">3.3.1.2. Configuration file common.yml</a></li>
<li><a href="#_configuration_file_web_ui_json">3.3.1.3. Configuration file web-ui.json</a></li>
<li><a href="#_oauth2_password_or_code_flows">3.3.1.4. OAuth2 PASSWORD or CODE Flows</a></li>
<li><a href="#_oauth2_implicit_flow">3.3.1.5. OAuth2 IMPLICIT Flow</a></li>
<li><a href="#_none_flow">3.3.1.6. NONE Flow</a></li>
</ul>
</li>
<li><a href="#_user_creation">3.3.2. User creation</a></li>
<li><a href="#jwt_mode">3.3.3. Alternative way to manage groups (and/or entities)</a></li>
<li><a href="#custom_certificates">3.3.4. Adding certification authorities or certificates to the Java keystore</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_operatorfabric_cli_command_line_interface">4. OperatorFabric CLI (Command Line Interface)</a></li>
<li><a href="#_monitoring">5. Monitoring</a></li>
<li><a href="#_logging_administration">6. Logging Administration</a>
<ul class="sectlevel2">
<li><a href="#_logging_configuration">6.1. Logging configuration</a></li>
<li><a href="#_runtime_configuration">6.2. Runtime configuration</a>
<ul class="sectlevel3">
<li><a href="#_java_services">6.2.1. Java services</a></li>
<li><a href="#_node_services">6.2.2. Node Services</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_users_groups_and_entities_administration">7. Users, Groups and Entities Administration</a>
<ul class="sectlevel2">
<li><a href="#_users">7.1. Users</a>
<ul class="sectlevel3">
<li><a href="#_list_all_users">7.1.1. List all users</a></li>
<li><a href="#_create_a_new_user">7.1.2. Create a new User</a></li>
<li><a href="#_fetch_user_details">7.1.3. Fetch user details</a></li>
<li><a href="#_update_user_details">7.1.4. Update user details</a></li>
<li><a href="#_notification_configuration">7.1.5. Notification configuration</a></li>
</ul>
</li>
<li><a href="#_groupsentities">7.2. Groups/Entities</a>
<ul class="sectlevel3">
<li><a href="#_list_groups_or_entities">7.2.1. List groups (or entities)</a></li>
<li><a href="#_create_a_new_group_or_entity">7.2.2. Create a new group (or entity)</a></li>
<li><a href="#_fetch_details_of_a_given_group_or_entity">7.2.3. Fetch details of a given group (or entity)</a></li>
<li><a href="#_update_details_of_a_group_or_entity">7.2.4. Update details of a group (or entity)</a></li>
<li><a href="#_add_a_user_to_a_group_or_entity">7.2.5. Add a user to a group (or entity)</a></li>
<li><a href="#_remove_a_user_from_a_group_or_entity">7.2.6. Remove a user from a group (or entity)</a></li>
<li><a href="#_entity_parents">7.2.7. Entity parents</a>
<ul class="sectlevel4">
<li><a href="#_add_a_new_entity_without_a_cycle_in_the_parent_declaration">7.2.7.1. Add a new Entity without a cycle in the parent declaration</a></li>
<li><a href="#_add_a_new_entity_with_a_cycle">7.2.7.2. Add a new Entity with a cycle</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a href="#_service_port_table">8. Service port table</a></li>
<li><a href="#_rate_limiter_for_card_sending">9. Rate limiter for card sending</a></li>
<li><a href="#_restricted_operations_administration">10. Restricted operations (administration)</a></li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>The aim of this document is to explain how to configure and deploy OperatorFabric.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_deployment"><a class="anchor" href="#_deployment"></a>1. Deployment</h2>
<div class="sectionbody">
<div class="paragraph">
<p>For now OperatorFabric consist of Docker images available either by compiling
the project or by using images releases from <a href="https://hub.docker.com/">Dockerhub</a></p>
</div>
<div class="paragraph">
<p>For simple one instance per service deployment, you can find in our "Getting Started" a
<a href="https://github.com/opfab/operatorfabric-getting-started/blob/master/server/docker-compose.yml">sample deployment as a docker compose file</a></p>
</div>
<div class="paragraph">
<p>To run OperatorFabric in development mode, see
<a href="/documentation/current/dev_env/index.html#dev_env">the development environment documentation</a>
.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_user_computer"><a class="anchor" href="#_user_computer"></a>2. User computer</h2>
<div class="sectionbody">
<div class="paragraph">
<p>From the user perspective, OperatorFabric is compatible with recent versions of chrome, edge and firefox and has no specific hardware performance constraints.</p>
</div>
<div class="paragraph">
<p>Be aware that if you use OperatorFabric in realtime you should prevent user&#8217;s computers to go in "sleep mode".</p>
</div>
<div class="paragraph">
<p>In particular, <strong>if you are using edge have a look to <a href="https://github.com/opfab/operatorfabric-core/issues/2754" class="bare">github.com/opfab/operatorfabric-core/issues/2754</a></strong></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_configuration"><a class="anchor" href="#_configuration"></a>3. Configuration</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The configuration is divided into two parts, the configuration of the business services and the configuration of the UI.</p>
</div>
<div class="paragraph">
<p>Opfab comes with a default embedded configuration, but certain parameters need to be provided and configured.</p>
</div>
<div class="paragraph">
<p>The configuration is centralized in the <strong>config</strong> directory of the GitHub repository. The dev subdirectory contains
configurations specific to development environments, while the <strong>docker</strong> subdirectory contains a specific configuration
meant for use in a full docker environment.</p>
</div>
<div class="sect2">
<h3 id="_business_service_configuration"><a class="anchor" href="#_business_service_configuration"></a>3.1. Business service configuration</h3>
<div class="sect3">
<h4 id="_shared_service_configuration"><a class="anchor" href="#_shared_service_configuration"></a>3.1.1. Shared service configuration</h4>
<div class="paragraph">
<p>The configuration shared by all services is in a yaml file, you can find an example with the file
/config/docker/common.yml.</p>
</div>
<div class="sect4">
<h5 id="_mongo_configuration"><a class="anchor" href="#_mongo_configuration"></a>3.1.1.1. Mongo configuration</h5>
<div class="paragraph">
<p>We only use URI configuration for mongo through the usage of the <code><code>operatorfabric.mongodb.uri</code></code>,
it allows us to share the same configuration behavior for simple or cluster
configuration and with both spring classic and reactive mongo configuration.
See <a href="https://docs.mongodb.com/manual/reference/connection-string/">mongo connection string</a> for the complete URI syntax.</p>
</div>
<div class="paragraph">
<p>This configuration is mandatory (no default configuration is provided).</p>
</div>
<div class="paragraph">
<p>Operator Fabric is supporting mongo version 5.0.0 and above.</p>
</div>
</div>
<div class="sect4">
<h5 id="_rabbitmq"><a class="anchor" href="#_rabbitmq"></a>3.1.1.2. RabbitMQ</h5>
<div class="paragraph">
<p>A rabbitMQ component (docker image) is provided in opfab, it has a default configuration.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>SECURITY WARNING : The default user/password should be changed if a rabbit port is exposed outside of docker network. To do that, set the environment variables "RABBITMQ_DEFAULT_USER" and "RABBITMQ_DEFAULT_PASS" when starting the image and adjust the following parameters in the common yml config file.</pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Default</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Mandatory</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Description</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.rabbitmq.host</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">rabbitmq</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">RabbitMQ host address</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.rabbitmq.port</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5672</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">RabbitMQ listen port</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.rabbitmq.username</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">guest</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">RabbitMQ username</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.rabbitmq.password</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">guest</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">RabbitMQ password</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_internal_account"><a class="anchor" href="#_internal_account"></a>3.1.1.3. Internal account</h5>
<div class="paragraph">
<p>The back service cards-reminder ,cards-diffusion and supervision need an internal account to communicate between opfab back services. Therefore, if you intend to utilize any of these services, it is necessary to create an Opfab technical account with ADMIN permissions and configure it</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Default</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Mandatory</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Description</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.internalAccount.login</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">opfab</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">user account used to call Opfab services.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.internalAccount.password</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">user password to call Opfab services</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The services require knowledge of the URL to retrieve the account&#8217;s token, and this URL should be configured within operatorfabric.servicesUrls.authToken. A default value, based on OperatorFabric default installation, is set to: "http://web-ui/auth/token".</p>
</div>
</div>
<div class="sect4">
<h5 id="_optional_configuration_values"><a class="anchor" href="#_optional_configuration_values"></a>3.1.1.4. Optional configuration values</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Default</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.servicesUrls.users</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://users:2103" class="bare">users:2103</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates where the Users service can be reached from the other services.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.servicesUrls.businessconfig</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://businessconfig:2100" class="bare">businessconfig:2100</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates where the Business service can be reached from the other services.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.servicesUrls.cardsPublication</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://cards-publication:2102" class="bare">cards-publication:2102</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Cards publication service URL</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.servicesUrls.cardsConsultation</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://cards-consultation:2104" class="bare">cards-consultation:2104</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Cards consultation service URL</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.servicesUrls.authToken</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://web-ui/auth/token" class="bare">web-ui/auth/token</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Authentication service URL</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.userActionLogActivated</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates whether the user action log feature is enabled or not.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_service_specific_configurations"><a class="anchor" href="#_service_specific_configurations"></a>3.1.2. Service specific configurations</h4>
<div class="paragraph">
<p>Each service can have a specific yaml configuration file that can override the default configuration</p>
</div>
<div class="paragraph">
<p>Examples of configuration of each service can be found under config/docker or config/dev .</p>
</div>
<div class="sect4">
<h5 id="_businessconfig_service"><a class="anchor" href="#_businessconfig_service"></a>3.1.2.1. Businessconfig service</h5>
<div class="paragraph">
<p>The businessconfig service has this specific property :</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Default</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.businessconfig.storage.path</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">/businessconfig-storage</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">File path to data storage folder</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_users_service"><a class="anchor" href="#_users_service"></a>3.1.2.2. Users service</h5>
<div class="paragraph">
<p>The user service has these specific properties :</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Default</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.users.default.users</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">null</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Array of user objects to create upon startup if they don&#8217;t exist</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.users.default.user-settings</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">null</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Array of user settings objects to create upon startup if they don&#8217;t exist</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.users.default.groups</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">null</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Array of group objects to create upon startup if they don&#8217;t exist</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.users.default.entities</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">null</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Array of entity objects to create upon startup if they don&#8217;t exist</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.users.daysBeforeLogExpiration</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">61</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Duration beyond which user action logs get automatically deleted</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="cards-pub-conf"><a class="anchor" href="#cards-pub-conf"></a>3.1.2.3. Cards-publication service</h5>
<div class="paragraph">
<p>The cards publication service has these specific properties :</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Default</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.cards-publication.checkAuthenticationForCardSending</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If false, OperatorFabric will not require user authentication to send or delete a card via endpoint /cards (it does not concern user cards which always need authentication). Be careful when setting the value to false, nginx conf must be adapted for security reasons (see security warning in <a href="https://github.com/opfab/operatorfabric-core/blob/master/config/docker/nginx.conf">the reference nginx.conf</a>)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.cards-publication.authorizeToSendCardWithInvalidProcessState</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If true, OperatorFabric will allow to publish a card referring a not existent process or state</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.cards-publication.checkPerimeterForCardSending</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If true, OperatorFabric will check user perimeter for card sending via endpoint /cards (it does not concern user cards which are always controlled).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">spring.kafka.consumer.group-id</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">null</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If set, support for receiving cards via Kafka is enabled</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">spring.deserializer.value.delegate.class</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">io.confluent.kafka.serializers.
KafkaAvroDeserializer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Deserializer used to convert the received bytes into objects</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">spring.serializer.value.delegate.class</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">io.confluent.kafka.serializers.
KafkaAvroSerializer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Serializer used to convert cards to bytes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">spring.kafka.producer.bootstrap-servers</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://localhost:9092" class="bare">localhost:9092</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">comma separated list of URL(s) of the broker(s) / bootstrap server(s)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.cards-publication.kafka.topics.card.topicname</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">opfab</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name of the topic to read the messages from</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.cards-publication.kafka.topics.response-card.topicname</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">opfab</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name of the topic to place the response cards to</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.cards-publication.kafka.schema.registry.url</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://localhost:8081" class="bare">localhost:8081</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">URL of the schema registry. Can be set to the empty string "" is no registry is used</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.cards-publication.delayForDeleteExpiredCardsScheduling</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">60000</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The delay in millisecond after the last execution finished and the next execution starts.
<a id="cardSendingLimitCardCount"></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.cards-publication.cardSendingLimitCardCount</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1000</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">For the Rate limiter, this defines how many cards can be sent during <code>cardSendingLimitPeriod</code>.
<a id="cardSendingLimitPeriod"></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.cards-publication.cardSendingLimitPeriod</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3600</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">For the Rate limiter, this defines the time period (in seconds) during which <code>cardSendingLimitCardCount</code> is applied.
<a id="activateCardSendingLimiter"></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.cards-publication.activateCardSendingLimiter</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If false, the Rate limiter will be ignored when sending cards.</p></td>
</tr>
</tbody>
</table>
<div class="sect5">
<h6 id="_operatorfabric_kafka_configuration"><a class="anchor" href="#_operatorfabric_kafka_configuration"></a>OperatorFabric Kafka configuration</h6>
<div class="paragraph">
<p>Next to publishing cards to OperatorFabric using the REST API, OperatorFabric also supports publishing cards via a Kafka Topic. In the default configuration Kafka is disabled.
To enable Kafka you need to set the consumer group to the consumer group you assign to the OpFab Kafka consumer. This can be any group-id, as long as it isn&#8217;t used by other consumers
(unless you explicitly want multiple consumers for the same group).</p>
</div>
<div class="paragraph">
<p>You can set the group_id by uncommenting the <code>kafka.consumer.group_id</code> in the <code>cards-publication.yml</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml">  <span class="key">kafka</span>:
    <span class="key">consumer</span>:
      <span class="key">group-id</span>: <span class="string"><span class="content">opfab-command</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>By default, the consumer will consume messages from the <code>opfab</code> topic.
See <a href="https://docs.spring.io/spring-kafka/reference/html/">Spring for Apache Kafka</a> for more information on the Spring Kafka implementation.</p>
</div>
<div class="paragraph">
<p>With the default settings, the Kafka consumer expects a broker running on http//127.0.0.1:9092 and a schema registry on <a href="http://127.0.0.1:8081" class="bare">127.0.0.1:8081</a>.</p>
</div>
<div class="paragraph">
<p>Operator Fabric is also able to publish response cards to a Kafka topic. The default topic name  <code>opfab-response</code>. You can specify which response cards
are to be returned via Kafka by setting the <code>external-recipients</code> in the <code>cards-publication</code> yaml file. Instead of setting <code>http://</code> URL you should set it to <code>kafka:</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span class="key">operatorfabric</span>:
  <span class="key">cards-publication</span>:
    <span class="key">external-recipients</span>:
      <span class="key">recipients</span>:
        - <span class="string"><span class="content">id: &quot;processAction&quot;</span></span>
          <span class="key">url</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">http://localhost:8090/test</span><span class="delimiter">&quot;</span></span>
          <span class="key">propagateUserToken</span>: <span class="string"><span class="content">true</span></span>
        - <span class="string"><span class="content">id: &quot;mykafka&quot;</span></span>
          <span class="key">url</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">kafka:topicname</span><span class="delimiter">&quot;</span></span>
          <span class="key">propagateUserToken</span>: <span class="string"><span class="content">false</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that <code>topicname</code> is a placeholder for now. All response cards are returned via the same Kafka response topic, as specified in the <code>opfab.kafka.topics.response-card</code> field.</p>
</div>
<div class="paragraph">
<p>Also note enabling Kafka does not disable the REST interface.</p>
</div>
<div class="paragraph">
<p>Example Kafka configuration plain:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span class="key">spring</span>:
  <span class="key">application</span>:
    <span class="key">name</span>: <span class="string"><span class="content">cards-publication</span></span>
  <span class="key">deserializer</span>:
    <span class="key">value</span>:
      <span class="key">delegate</span>:
        <span class="key">class</span>: <span class="string"><span class="content">org.opfab.cards.publication.kafka.consumer.KafkaAvroWithoutRegistryDeserializer</span></span>
  <span class="key">serializer</span>:
    <span class="key">value</span>:
      <span class="key">delegate</span>:
        <span class="key">class</span>: <span class="string"><span class="content">org.opfab.cards.publication.kafka.producer.KafkaAvroWithoutRegistrySerializer</span></span>
  <span class="key">kafka</span>:
    <span class="key">consumer</span>:
      <span class="key">group-id</span>: <span class="string"><span class="content">OPFAB</span></span>
      <span class="key">properties</span>:
        <span class="key">specific</span>:
          <span class="key">avro</span>:
            <span class="key">reader</span>: <span class="string"><span class="content">true</span></span>
    <span class="key">producer</span>:
      <span class="key">client-id</span>: <span class="string"><span class="content">operatorfabric-producer</span></span>
    <span class="key">bootstrap-servers</span>: <span class="string"><span class="content">kafka-server:9092</span></span>
<span class="key">operatorfabric</span>:
  <span class="key">cards-publication</span>:
    <span class="key">kafka</span>:
      <span class="key">topics</span>:
        <span class="key">card</span>:
          <span class="key">topicname</span>: <span class="string"><span class="content">m_opfab-card-commands_dev</span></span>
        <span class="key">response-card</span>:
          <span class="key">topicname</span>: <span class="string"><span class="content">m_opfab-card-response_dev</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Example Kafka configuration SASL:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span class="key">spring</span>:
  <span class="key">application</span>:
    <span class="key">name</span>: <span class="string"><span class="content">cards-publication</span></span>
  <span class="key">deserializer</span>:
    <span class="key">value</span>:
      <span class="key">delegate</span>:
        <span class="key">class</span>: <span class="string"><span class="content">org.opfab.cards.publication.kafka.consumer.KafkaAvroWithoutRegistryDeserializer</span></span>
  <span class="key">serializer</span>:
    <span class="key">value</span>:
      <span class="key">delegate</span>:
        <span class="key">class</span>: <span class="string"><span class="content">org.opfab.cards.publication.kafka.producer.KafkaAvroWithoutRegistrySerializer</span></span>
  <span class="key">kafka</span>:
    <span class="key">consumer</span>:
      <span class="key">group-id</span>: <span class="string"><span class="content">OPFAB</span></span>
      <span class="key">security</span>:
        <span class="key">protocol</span>: <span class="string"><span class="content">SASL_SSL</span></span>
      <span class="key">properties</span>:
        <span class="key">specific</span>:
          <span class="key">avro</span>:
            <span class="key">reader</span>: <span class="string"><span class="content">true</span></span>
        <span class="key">sasl</span>:
          <span class="key">mechanism</span>: <span class="string"><span class="content">SCRAM-SHA-256</span></span>
          <span class="key">jaas</span>:
            <span class="key">config</span>: <span class="string"><span class="content">org.apache.kafka.common.security.scram.ScramLoginModule required username=&quot;kafkaUsername&quot; password=&quot;kafkaPassword&quot;;</span></span>
    <span class="key">producer</span>:
      <span class="key">client-id</span>: <span class="string"><span class="content">operatorfabric-producer</span></span>
      <span class="key">security</span>:
        <span class="key">protocol</span>: <span class="string"><span class="content">SASL_SSL</span></span>
      <span class="key">properties</span>:
        <span class="key">sasl</span>:
          <span class="key">mechanism</span>: <span class="string"><span class="content">SCRAM-SHA-256</span></span>
          <span class="key">jaas</span>:
            <span class="key">config</span>: <span class="string"><span class="content">org.apache.kafka.common.security.scram.ScramLoginModule required username=&quot;kafkaUsername&quot; password=&quot;kafkaPassword&quot;;</span></span>
    <span class="key">bootstrap-servers</span>: <span class="string"><span class="content">kafka-server:9094</span></span>
    <span class="key">ssl</span>:
      <span class="key">trust-store-type</span>: <span class="string"><span class="content">PKCS12</span></span>
      <span class="key">trust-store-password</span>: <span class="string"><span class="content">truststorePassword</span></span>
      <span class="key">trust-store-location</span>: <span class="string"><span class="content">file:///etc/truststore.pkcs</span></span>
    <span class="key">properties</span>:
      <span class="key">ssl</span>:
        <span class="key">endpoint</span>:
          <span class="key">identification</span>:
            <span class="key">algorithm</span>: <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>
<span class="key">operatorfabric</span>:
  <span class="key">cards-publication</span>:
    <span class="key">kafka</span>:
      <span class="key">topics</span>:
        <span class="key">card</span>:
          <span class="key">topicname</span>: <span class="string"><span class="content">opfab-card-commands</span></span>
        <span class="key">response-card</span>:
          <span class="key">topicname</span>: <span class="string"><span class="content">opfab-card-response</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Example Kafka configuration Kerberos:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span class="key">spring</span>:
  <span class="key">application</span>:
    <span class="key">name</span>: <span class="string"><span class="content">cards-publication</span></span>
  <span class="key">deserializer</span>:
    <span class="key">key</span>:
      <span class="key">delegate</span>:
        <span class="key">class</span>: <span class="string"><span class="content">org.apache.kafka.common.serialization.StringDeserializer</span></span>
    <span class="key">value</span>:
      <span class="key">delegate</span>:
        <span class="key">class</span>: <span class="string"><span class="content">org.opfab.cards.publication.kafka.consumer.KafkaAvroWithoutRegistryDeserializer</span></span>
  <span class="key">serializer</span>:
    <span class="key">value</span>:
      <span class="key">delegate</span>:
        <span class="key">class</span>: <span class="string"><span class="content">org.opfab.cards.publication.kafka.producer.KafkaAvroWithoutRegistrySerializer</span></span>
  <span class="key">kafka</span>:
    <span class="key">security</span>:
      <span class="key">protocol</span>: <span class="string"><span class="content">SASL_SSL</span></span>
    <span class="key">properties</span>:
      <span class="key">sasl.mechanism</span>: <span class="string"><span class="content">GSSAPI</span></span>
      <span class="key">sasl</span>:
        <span class="key">jaas</span>:
          <span class="key">config</span>: <span class="string"><span class="content">com.sun.security.auth.module.Krb5LoginModule required useKeyTab=true keyTab=&quot;/etc/kafkaUsername.keytab&quot; storeKey=true useTicketCache=false serviceName=&quot;kafka&quot; principal=&quot;kafkaUsername@DOMAIN&quot;;</span></span>
    <span class="key">bootstrap-servers</span>: <span class="string"><span class="content">kafka-server:9094</span></span>
    <span class="key">ssl</span>:
      <span class="key">trust-store-type</span>: <span class="string"><span class="content">pkcs12</span></span>
      <span class="key">trust-store-password</span>: <span class="string"><span class="content">truststorePassword</span></span>
      <span class="key">trust-store-location</span>: <span class="string"><span class="content">file:///etc/truststore.pkcs12</span></span>
    <span class="key">consumer</span>:
      <span class="key">group-id</span>: <span class="string"><span class="content">OPFAB</span></span>
      <span class="key">key-deserializer</span>: <span class="string"><span class="content">org.springframework.kafka.support.serializer.ErrorHandlingDeserializer</span></span>
      <span class="key">value-deserializer</span>: <span class="string"><span class="content">org.springframework.kafka.support.serializer.ErrorHandlingDeserializer</span></span>
      <span class="key">properties</span>:
        <span class="key">spring</span>:
          <span class="key">deserializer</span>:
            <span class="key">key</span>:
              <span class="key">delegate</span>:
                <span class="key">class</span>: <span class="string"><span class="content">org.apache.kafka.common.serialization.StringDeserializer</span></span>
            <span class="key">value</span>:
              <span class="key">delegate</span>:
                <span class="key">class</span>: <span class="string"><span class="content">org.opfab.cards.publication.kafka.consumer.KafkaAvroWithoutRegistryDeserializer</span></span>
    <span class="key">producer</span>:
      <span class="key">client-id</span>: <span class="string"><span class="content">OPFAB</span></span>
      <span class="key">value-serializer</span>: <span class="string"><span class="content">org.opfab.cards.publication.kafka.producer.KafkaAvroWithoutRegistrySerializer</span></span>
<span class="key">operatorfabric</span>:
  <span class="key">cards-publication</span>:
    <span class="key">kafka</span>:
      <span class="key">topics</span>:
        <span class="key">card</span>:
          <span class="key">topicname</span>: <span class="string"><span class="content">opfab-card-commands</span></span>
        <span class="key">response-card</span>:
          <span class="key">topicname</span>: <span class="string"><span class="content">opfab-card-response</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Example Kafka configuration OAUTHBEARER / AADToken:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span class="key">spring</span>:
  <span class="key">kafka</span>:
    <span class="key">consumer</span>:
      <span class="key">properties</span>:
        <span class="key"><span class="delimiter">&quot;</span><span class="content">[security.protocol]</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="content">SASL_SSL</span></span>
        <span class="key"><span class="delimiter">&quot;</span><span class="content">[sasl.jaas.config]</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="content">org.apache.kafka.common.security.oauthbearer.OAuthBearerLoginModule required ;</span></span>
        <span class="key"><span class="delimiter">&quot;</span><span class="content">[sasl.mechanism]</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="content">OAUTHBEARER</span></span>
        <span class="key"><span class="delimiter">&quot;</span><span class="content">[sasl.login.callback.handler.class]</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="content">org.opfab.cards.publication.kafka.auth.AADWorkloadIdentityLoginCallbackHandler</span></span>
    <span class="key">producer</span>:
      <span class="error">...the same...</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_cards_consultation_service"><a class="anchor" href="#_cards_consultation_service"></a>3.1.2.4. Cards-consultation service</h5>
<div class="paragraph">
<p>The cards-consultation service has these specific properties :</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Default</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.checkIfUserIsAlreadyConnected</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If false, OperatorFabric will allow a user to have several sessions opened at the same time. However, it may cause synchronization problems between the sessions using the same login, so it is recommended to let it true, its default value.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.heartbeat.checkIntervalInSeconds</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">10</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Frequency at which the heartbeat from the ui to the server is checked.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.heartbeat.delayInSecondsToConsiderUserDisconnected</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">100</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">After how many seconds without heartbeat, the user is considered disconnected</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="external-devices-conf"><a class="anchor" href="#external-devices-conf"></a>3.1.2.5. External devices service</h5>
<div class="paragraph">
<p>The external devices service can be configured with the following properties:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Default</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.externaldevices.watchdog.enabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If true, watchdog signals will be sent to external devices to show that the OperatorFabric is running and connected.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.externaldevices.watchdog.cron</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>*/5 * * * * *</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CRON expression determining when watchdog signals should be sent to external devices.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.externaldevices.watchdog.signalId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Id of the signal the external devices are expecting as watchdog</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="cards-external-diffusion-conf"><a class="anchor" href="#cards-external-diffusion-conf"></a>3.1.2.6. Cards external diffusion service</h5>
<div class="paragraph">
<p>The card external diffusion service can be configured with the following properties:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Default</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Mandatory</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Description</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.logConfig.logFolder</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">logs</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Log file folder (inside docker container)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.logConfig.logFile</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">"opfab.%DATE%.log"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Log file name</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.logConfig.logLevel</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">info</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Default log level</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.mail.host</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Mail server host</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.mail.port</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Mail server port</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.mail.auth.user</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Mail server authentication user</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.mail.auth.pass</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Mail server authentication password</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.cardsExternalDiffusion.adminPort</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2106</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Listen port</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.cardsExternalDiffusion.activeOnStartup</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Flag to start the notification service on startup</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.cardsExternalDiffusion.defaultConfig.mailFrom</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Mail from address</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.cardsExternalDiffusion.defaultConfig.dailyEmailTitle</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">'Cards received during the day'</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Daily mail subject title</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.cardsExternalDiffusion.defaultConfig.weeklyEmailTitle</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">'Cards received during the week'</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Weekly mail subject title</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.cardsExternalDiffusion.defaultConfig.dailyEmailBodyPrefix</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">'You received the following cards during the past 24 hours : '</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Daily email body prefix</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.cardsExternalDiffusion.defaultConfig.weeklyEmailBodyPrefix</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">'You received the following cards during the past 7 days : '</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Weekly email body prefix</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.cardsExternalDiffusion.defaultConfig.dayOfWeekToSendWeeklyRecapEmail</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Day of the week to send the weekly recap emails (0 is Sunday, 6 is Saturday)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.cardsExternalDiffusion.defaultConfig.hourToSendRecapEmail</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">7</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Hour at which to send the recap emails</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.cardsExternalDiffusion.defaultConfig.minuteToSendRecapEmail</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">30</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Minute at which to send the recap emails</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.cardsExternalDiffusion.defaultConfig.subjectPrefix</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">'Opfab card received'</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Mail subject prefix</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.cardsExternalDiffusion.defaultConfig.bodyPrefix</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">'You received a card in opfab : '</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Mail body prefix</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.cardsExternalDiffusion.defaultConfig.bodyPostfix</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">'This email has been sent by Opfab, there is no need to reply.'</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Mail body postfix</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.cardsExternalDiffusion.defaultConfig.publisherEntityPrefix</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">'The card has been sent by '</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Publisher entity text prefix</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.cardsExternalDiffusion.defaultConfig.opfabUrlInMailContent</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Url to write in mail to access the opfab server (example : <a href="https://opfab_url/" class="bare">opfab_url/</a>)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.cardsExternalDiffusion.defaultConfig.windowInSecondsForCardSearch</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">360</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Max time interval used to query new cards (in seconds)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.cardsExternalDiffusion.defaultConfig.checkPeriodInSeconds</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">10</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Time interval between consecutive checks</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.cardsExternalDiffusion.defaultConfig.activateCardsDiffusionRateLimiter</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Flag to activate mail sending rate limiting</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.cardsExternalDiffusion.defaultConfig.sendRateLimit</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">100</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Max number of mail sent allowed for a single destination in the configured period</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.cardsExternalDiffusion.defaultConfig.sendRateLimitPeriodInSec</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3600</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Time period for rate limiting control</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.cardsExternalDiffusion.defaultConfig.defaultTimeZone</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Europe/Paris</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Default timezone used to display dates and times for email notifications if user has not set the timezone for mail in his settings</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The parameters in "operatorfabric.cardsExternalDiffusion.defaultConfig" section can be modified at runtime by sending an http POST request to the <code>/config</code> API of cards external diffusion service with a JSON payload containing the config parameters to be changed.</p>
</div>
</div>
<div class="sect4">
<h5 id="cards-reminder-conf"><a class="anchor" href="#cards-reminder-conf"></a>3.1.2.7. Cards reminder service</h5>
<div class="paragraph">
<p>The card reminder service can be configured with the following properties:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Default</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Mandatory</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Description</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.logConfig.logFolder</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">logs</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Log file folder (inside docker container)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.logConfig.logFile</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">"opfab.%DATE%.log"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Log file name</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.logConfig.logLevel</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">info</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Default log level</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.cardsReminder.adminPort</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2107</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Cards reminder service Listen port</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.cardsReminder.activeOnStartup</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Flag to start the cards reminder service on startup</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.cardsReminder.checkPeriodInSeconds</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Cards reminder time interval between consecutive checks</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="supervisor-conf"><a class="anchor" href="#supervisor-conf"></a>3.1.2.8. Supervisor service</h5>
<div class="paragraph">
<p>The supervisor service can be configured with the following properties:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Default</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Mandatory</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Description</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.logConfig.logFolder</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">logs</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Log file folder (inside docker container)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.logConfig.logFile</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">"opfab.%DATE%.log"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Log file name</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.logConfig.logLevel</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">info</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Default log level</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.supervisor.adminPort</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2106</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Cards reminder service Listen port</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.supervisor.activeOnStartup</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Flag to start the cards reminder service on startup</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.supervisor.defaultConfig.considerConnectedIfUserInGroups</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If set the user must be in one of the mention groups to consider his entities as connected, example :  ["Dispatcher","Planner"]</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.supervisor.defaultConfig.entitiesToSupervise</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">List of entity id and related supervisor list ({ "id": "ENTITY1", "supervisors": ["ENTITY2"] })</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.supervisor.defaultConfig.disconnectedCardTemplate.publisher</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">opfab</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Publisher for card template used to send connections alerts</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.supervisor.defaultConfig.disconnectedCardTemplate.process</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">supervisor</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Process for card template used to send connections alerts</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.supervisor.defaultConfig.disconnectedCardTemplate.processVersion</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Process version for card template used to send connections alerts</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.supervisor.defaultConfig.disconnectedCardTemplate.state</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">disconnectedEntity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">State for card template used to send connections alerts</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.supervisor.defaultConfig.disconnectedCardTemplate.severity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ALARM</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Severity for card template used to send connections alerts</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.supervisor.defaultConfig.secondsBetweenConnectionChecks</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">10</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Connection check period</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.supervisor.defaultConfig.nbOfConsecutiveNotConnectedToSendFirstCard</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Number of consecutive failed checks before sending first alert card</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.supervisor.defaultConfig.nbOfConsecutiveNotConnectedToSendSecondCard</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">12</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Number of consecutive failed checks before sending second alert card</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.supervisor.defaultConfig.processesToSupervise</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">List of processes and related states to monitor for missing acknowledgment ({ "process": "defaultProcess", "states": ["processState"] })</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.supervisor.defaultConfig.unackCardTemplate.publisher</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">opfab</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Publisher for card template used to send acknowledgment alerts</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.supervisor.defaultConfig.unackCardTemplate.process</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">supervisor</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Process for card template used to send acknowledgment alerts</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.supervisor.defaultConfig.unackCardTemplate.processVersion</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Process version for card template used to send acknowledgment alerts</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.supervisor.defaultConfig.unackCardTemplate.state</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">unacknowledgedCards</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">State for card template used to send acknowledgment alerts</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.supervisor.defaultConfig.unackCardTemplate.severity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ALARM</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Severity for card template used to send acknowledgment alerts</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.supervisor.defaultConfig.windowInSecondsForCardSearch</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1200</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Time period used to search for not acknowledged cards</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.supervisor.defaultConfig.secondsBetweenAcknowledgmentChecks</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">10</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Card acknowledgment check period</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.supervisor.defaultConfig.secondsAfterPublicationToConsiderCardAsNotAcknowledged</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">600</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Time period to wait after card publishing to consider a card as not acknowledged and send the alert</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The parameters in "operatorfabric.supervisor.defaultConfig" section can be modified at runtime by sending an http POST request to the <code>/config</code> API of supervisor service with a JSON payload containing the config parameters to be changed.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_web_ui_configuration"><a class="anchor" href="#_web_ui_configuration"></a>3.2. Web UI Configuration</h3>
<div class="paragraph">
<p>OperatorFabric Web UI service is built on top of a <a href="https://www.nginx.com/">NGINX</a> server.
It  serves the Angular SPA to browsers and act as a reverse proxy for other services.</p>
</div>
<div class="sect3">
<h4 id="_nginx_configuration"><a class="anchor" href="#_nginx_configuration"></a>3.2.1. NGINX configuration</h4>
<div class="paragraph">
<p>An external <code>nginx.conf</code> file configures the OperatorFabric Nginx instance named <code>web-ui</code> service.
Those files are mounted as docker volumes. There are two of them in OperatorFabric, one in <code>config/dev</code> and one in <code>config/docker</code>.</p>
</div>
<div class="paragraph">
<p>The one in <code>config/dev</code> is set with
 permissive <code>CORS</code> rules to enable web development using <code>ng serve</code> within the <code>ui/main</code> project.It&#8217;s possible to use <code>ng serve</code> with the one in <code>config/docker</code> version also. To do so use the conf file named
<code>nginx-cors-permissive.conf</code> by configuring the <code>/docker-compose.yml</code> with the following line:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>- "./nginx-cors-permissive.conf:/etc/nginx/conf.d/default.conf"</pre>
</div>
</div>
<div class="paragraph">
<p>instead of:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>- "./nginx.conf:/etc/nginx/conf.d/default.conf"</pre>
</div>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The line customized in the nginx configuration file must end with à semicolon (';') otherwise the Nginx server will stop immediately</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="ui_properties"><a class="anchor" href="#ui_properties"></a>3.2.2. UI properties</h4>
<div class="paragraph">
<p>The properties lie in the <code>web-ui.json</code>. The following table describes their meaning and how to use them. An example file can be found in the config/docker directory.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">name</th>
<th class="tableblock halign-left valign-top">default</th>
<th class="tableblock halign-left valign-top">mandatory?</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">about</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>none</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>no</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Declares application names and their version into web-ui about section.<br>
Each entry is
a free key value followed by its name (a string of characters), its version (a string of characters) and its facultative rank of declaration (a number).<br>
It is not necessary to declare <code>OperatorFabric</code> as application because it is added automatically with current release version and rank <code>0</code>.<br>
For example adding <code>Keycloak</code> application, with <code>'Keycloak'</code> as <code>name</code>, <code>1</code> as <code>rank</code> and  <code>'6.0.1'</code> as <code>version</code> should look like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="json"><span class="key"><span class="delimiter">&quot;</span><span class="content">about</span><span class="delimiter">&quot;</span></span>: {
    <span class="key"><span class="delimiter">&quot;</span><span class="content">keycloak</span><span class="delimiter">&quot;</span></span>: {
      <span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">Keycloak</span><span class="delimiter">&quot;</span></span>,
      <span class="key"><span class="delimiter">&quot;</span><span class="content">rank</span><span class="delimiter">&quot;</span></span>: <span class="integer">1</span>,
      <span class="key"><span class="delimiter">&quot;</span><span class="content">version</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">6.0.1</span><span class="delimiter">&quot;</span></span>
    }
  }</code></pre>
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">alerts.doNotAlertForHiddenCardReceived</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">if set to true, alert messages are not shown when receiving cards not visible in the feed</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">alerts.alarmLevelAutoClose</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">if set to true, the ALARM (red) alert message will automatically close after a few seconds</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">alerts.messageOnBottomOfTheScreen</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">if set to true, the alert message is shown on the bottom of the page</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">archive.filters.publishDate.days</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">10</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The default search period (days) for publish date filter in archives page</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">archive.filters.tags.list</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">List of tags to choose from in the corresponding filter in archives page</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">archive.history.size</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">100</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The maximum size of card history visible</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">checkIfUrlIsLocked</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">if set to false, an OperatorFabric url can be used by several tabs in the same browser. Note that there can only be one token per browser for a given OperatorFabric url, so the first session will be replaced by the second one</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">customCssToLoad</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">List of URLs of css files to be loaded at startup</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">customJsToLoad</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">List of URLs of javascript files to be loaded at startup</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">dashboard.processStateRedirects</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Declares if a state when clicked in the dashboard should redirect to a custom menu or custom screen. If nothing is specified the redirection is pointing to the card feed. Here is a declaration with one redirection to a custom menu and one to a custom screen. The ids declared should match the ones in the ui-menu config.
[source, json]
----
"dashboard": {
    "processStateRedirects": [
      {
        "processId": "defaultProcess",
        "stateId": "chartLineState",
        "menuId": "uid_test_0",
        "urlExtension": "?search=chart&amp;fulltext=1"
      },
      {
        "processId": "defaultProcess",
        "stateId": "questionState",
        "screenId": "testId"
      }
    ]
  }
----</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">dashboard.processCustomLinks</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Declares a list of link to show under the states of processes.Here is a declaration with two links  to custom screens.
[source, json]
----
  "dashboard": {
        "processCustomLinks": [
            {
            "processId": "defaultProcess",
            "customLinks": [
                    {
                        "label": "Custom screen",
                        "customScreenId": "testId"
                    },
                    {
                        "label": "Custom screen 2",
                        "customScreenId": "testId2"
                    }
                ]
            }
        ]
  }
----</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">defaultEntryPage</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">feed</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">This configuration determines the default page that will be displayed after a user logs in. The possible values include all core menus, with the exception of 'usercard' and 'about'. Additionally, you can set a custom application as the entry page by using 'businessconfigparty/menuId' as the value.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">environmentColor</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">blue</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Color of the background of the environment name. The format of color is css, for example : <code>red</code> , <code>#4052FF</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">environmentName</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name of the environment to display in the top-right corner (examples: PROD , TEST .. ), if the value not set the environment name is not shown .</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">externalDevicesEnabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If true, users have the opportunity to play sounds on external devices rather than in the browser. See <code>settings.playSoundOnExternalDevice</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">feed.card.hideAckAllCardsFeature</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Control if you want to show or hide the option for acknowledging all the visible cards of the feed</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">feed.card.hideApplyFiltersToTimeLineChoice</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Control if you want to show or hide the option of applying filters or not to timeline in the feed page</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">feed.card.hideResponseFilter</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Control if you want to show or hide the response filter in the feed page</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">feed.card.hideProcessFilter</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Control if you want to show or hide the process filter in the feed page</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">feed.card.hideStateFilter</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Control if you want to show or hide the state filter in the feed page</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">feed.card.maxNbOfCardsToDisplay</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">100</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Max number of card visible in feed (This limit is used for performance reasons, setting the value too high can have consequences on browser response times)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">feed.card.secondsBeforeLttdForClockDisplay</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">180</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Number of seconds before lttd when a clock is activated in cards on the feed</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">feed.card.time.display</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">BUSINESS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>card time display mode in the feed. Values :</p>
</div>
<div class="ulist">
<ul>
<li>
<p>BUSINESS: displays card with entire business period. It is the fallback if the set value is none of the values listed here;</p>
</li>
<li>
<p>BUSINESS_START: displays card with business start date;</p>
</li>
<li>
<p>PUBLICATION: displays card with publication date;</p>
</li>
<li>
<p>LTTD: displays card with lttd date;</p>
</li>
<li>
<p>NONE: nothing displayed.</p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">feed.card.titleUpperCase</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If set to true, the card titles are in UPPERCASE. (Option applies to the 'Card Feed', 'Archives' and 'Monitoring')</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">feed.defaultAcknowledgmentFilter</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">"notack"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Default card acknowledgment filtering option in feed page, possible values are : "notack", "ack", "all".</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">feed.defaultSorting</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">"unread"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Default card sorting option in feed page, possible values are : "unread", "date", "severity", "startDate", "endDate".</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">feed.enableGroupedCards</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>(Experimental feature)</em>: If true cards with the same tags are grouped together. Clicking on the grouped card will show the other cards with the same tags in the feed.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">feed.geomap.bglayer.xyz.crossOrigin</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">null</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Custom xyz/tiled background layer crossOrigin setting.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">feed.geomap.bglayer.xyz.tileSize</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">null</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Custom xyz/tiled background layer tile size (Int value, example: 256. Required when using custom background layer).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">feed.geomap.bglayer.xyz.url</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">null</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Custom xyz/tiled background layer service URL, Replaces OSM background layer (Add endpoint with {x}{y}{z} variables. Example: "https://service.pdok.nl/brt/achtergrondkaart/wmts/v2_0/grijs/EPSG:3857/{z}/{x}/{y}.png".</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">feed.geomap.defaultDataProjection</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">EPSG:4326</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The default data projection of <code>card.wktGeometry</code> to use when no wktProjection is embedded in the card.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">feed.geomap.enable</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>(Experimental feature)</em>: If true a geographical map will be shown and cards that have geographical coordinates will be drawn on the map.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">feed.geomap.enableGraph</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Show a graph on the map with number of cards per severity.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">feed.geomap.highlightPolygonStrokeWidth</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Define the stroke width when highlighting polygon in the geomap view of a card.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">feed.geomap.initialLatitude</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The initial latitude of the map when no cards with geographical coordinates are present.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">feed.geomap.initialLongitude</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The initial longitude of the map when no cards with geographical coordinates are present.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">feed.geomap.initialZoom</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Initial zoom level of the map.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">feed.geomap.layer.geojson</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">null</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">List of GeoJSON layers to add to the map with optional style attribute. The style object can have styling properties for stroke, fill, image, and text styles as defined in OpenLayer flat style (<a href="https://openlayers.org/en/latest/apidoc/module-ol_style_flat.html" class="bare">openlayers.org/en/latest/apidoc/module-ol_style_flat.html</a>). Example: [{"url":"assets/layers/service-area.geojson"},{"url":"https://localhost:8000/network-lines.geojson", "style": {"stroke-color": "blue"}}]</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">feed.geomap.maxZoom</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">11</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Max zoom level, to prevent zooming in too much when only one card is shown (or multiple cards in close proximity).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">feed.geomap.popupContent</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">publishDateAndTitle</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Define the content of the geomap popup. Possible values are : <code>publishDateAndTitle</code> (default value) or <code>summary</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">feed.geomap.zoomDuration</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">500</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Time in milliseconds it takes to zoom the map to the specific location. Set to 0 to disable the zoom animation.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">feed.geomap.zoomToLocation</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">14</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Zoom level when zooming to a location of a selected card.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">feed.showSearchFilter</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If set to false, the search filter is hidden.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">feed.timeline.domains</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">["RT", "J", "7D", "W", "M", "Y"]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">List of domains to show on the timeline, possible domains are : "RT", "J", "7D", "W", "M", "Y".</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">heartbeatSendingInterval</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">30</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Frequency in seconds at which the ui sends heartbeat to the server</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">i18n.supported.locales</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">List of supported locales (Only fr and en so far)
Values should be taken from the <a href="https://en.wikipedia.org/wiki/List_of_tz_database_time_zones">TZ database</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">logging.filters.publishDate.days</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">10</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The default search period (days) for publish date filter in logging page</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">logging.filters.tags.list</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">List of tags to choose from in the corresponding filter in logging page</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">logo.base64</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">medium OperatorFabric icon</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The encoding result of converting the svg logo to Base64, use this <a href="https://base64.guru/converter/encode/image/svg">online tool</a> to encode your svg. If it is not set, a medium (32px) OperatorFabric icon is displayed.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">logo.height</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">40</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The height of the logo (in px) (only taken into account if logo.base64 is set). The value cannot be more than 48px (if it is set to more than 48px, it will be ignored and set to 48px).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">logo.width</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">40</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The width of the logo (in px) (only taken into account if logo.base64 is set).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">secondsToCloseSession</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">60</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Number of seconds between logout and token expiration. If you use IMPLICIT authentication mode, exercise caution when modifying the value to prevent logouts before token silent refresh.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">security.changePasswordUrl</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">URL to change the user password (if the top-right menu item "Change password" is visible)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">security.logout-url</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The keycloak logout URL. Is a composition of:
- Your keycloak instance and the <em>auth</em> keyword (ex: <a href="https://www.keycloakurl.com/auth" class="bare">www.keycloakurl.com/auth</a>), but we also support domains without <em>auth</em> (ex: <a href="https://www.keycloakurl.com/customPath" class="bare">www.keycloakurl.com/customPath</a>)
- The realm name (Ex: dev)
- The redirect URL (<em>redirect_uri</em>): The redirect URL after success authentication</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">security.oauth2.flow.delegate-url</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">null</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Url to redirect the browser to for authentication. Mandatory with:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>CODE flow: must be the url with protocol choice and version as query parameters;</p>
</li>
<li>
<p>IMPLICIT flow: must be the url part before <code>.well-known/openid-configuration</code> (for example in dev configuration it&#8217;s
<code><a href="http://localhost:89/auth/realms/dev" class="bare">localhost:89/auth/realms/dev</a></code>).</p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">security.oauth2.flow.mode</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PASSWORD</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>authentication mode, available options:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>CODE: Authorization Code Flow;</p>
</li>
<li>
<p>PASSWORD: Direct Password Flow (fallback);</p>
</li>
<li>
<p>IMPLICIT: Implicit Flow.</p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">security.implicit-mode-post-logout-url</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">null</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The redirect URL after logout when using IMPLICIT flow</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">selectActivityAreaOnLogin</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">if set to true the users belonging to multiple Entities will be required to configure activity area on login</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">settings.dateFormat</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Value from the browser configuration</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Format for date rendering (example : dd/MM/yyyy )</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">settings.dateTimeFormat</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Value from the browser configuration</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Format for date and time rendering (example : HH:mm dd/MM/yyyy )</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">settings.locale</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">en</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Default user locale (use en if not set)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">settings.playSoundForAction</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If set to true, a sound is played when Action cards are added or updated in the feed</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">settings.playSoundForAlarm</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If set to true, a sound is played when Alarm cards are added or updated in the feed</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">settings.playSoundForCompliant</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If set to true, a sound is played when Compliant cards are added or updated in the feed</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">settings.playSoundForInformation</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If set to true, a sound is played when Information cards are added or updated in the feed</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">settings.playSoundOnExternalDevice</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If set to true (and <code>externalDevicesEnabled</code> is set to true as well) and the user has an external device configured, sounds will be played on this device rather than in the browser</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">settings.remoteLoggingEnabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If set to true, some logs from the UI are sent to the back and write in the log file of the cards-consultation service</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">settings.hallwayMode</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If set to true, hallway mode for feed screen will be enabled</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">settings.replayEnabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If set to true, sounds are replayed every <code>settings.replayInterval</code> seconds until the user interacts with the application</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">settings.replayInterval</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Interval between sound replays (see <code>settings.replayEnabled</code>)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">settings.systemNotificationAction</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If set to true, a system notification is sent when Action cards are added or updated in the feed</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">settings.systemNotificationAlarm</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If set to true, a system notification is sent when Alarm cards are added or updated in the feed</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">settings.systemNotificationCompliant</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If set to true, a system notification is sent when Compliant cards are added or updated in the feed</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">settings.systemNotificationInformation</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If set to true, a system notification is sent when Information cards are added or updated in the feed</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">settings.styleWhenNightDayModeDesactivated</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Style to apply if not using day night mode, possible value are DAY or NIGHT</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">settings.timeFormat</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Value from the browser configuration</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Format for time rendering (example : HH:mm )</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">settings.hallwayMode</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If set to true, hallway mode for feed screen will be enabled</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">settings.openNextCardOnAcknowledgment</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If set to true, automatically opens the next card in the feed after acknowledging the current card</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">settings.showAcknowledgmentFooter</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If set to true, always shows the acknowledgments footer in cards</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">settingsScreen.hiddenSettings</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Array of string indicating which field(s) we want to hide in the settings screen. Possible values :<br>
"language" : if present, language field will not be displayed<br>
"remoteLoggingEnabled" : if present, the checkbox to activate remote logging will not be displayed<br>
"sounds" : if present, the checkboxes for sound notifications will not be displayed<br>
"systemNotifications" : if present, the checkboxes for systemNotifications will not be displayed<br>
"sendCardsByEmail" : if present, the email options will not be displayed<br>
"emailToPlainText" : if present, the email option to have the emails sent as plain text will not be displayed<br>
"sendDailyEmail" : if present, the email option to have the daily email recap will not be displayed<br>
"sendWeeklyEmail" : if present, the email option to have the weekly email recap will not be displayed<br>
"disableCardContentInEmails" : if present, the email option to activate or not the templating of emails will not be displayed<br>
"timezoneForEmails" : if present, the field to choose the timezone for emails will not be displayed<br>
"hallwayMode": if present, the checkbox to activate hallway mode won&#8217;t be displayed<br>
"openNextCardOnAcknowledgment": if present, the checkbox to automaticaly open next card after acknowledgment won&#8217;t be displayed<br>
"showAcknowledgmentFooter" : if present, the checkbox to always show acknowledgments footer won&#8217;t be displayed</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">showUserEntitiesOnTopRightOfTheScreen</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If set to true, the user&#8217;s entities with the "ACTIVITY_AREA" role will be displayed under the login on the top right of the screen</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">title</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OperatorFabric</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Title of the application, displayed on the browser</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">usercard.useDescriptionFieldForEntityList</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If true, show entity <code>description</code> field instead of <code>name</code> in user card page</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>IMPORTANT:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="paragraph">
<p>To declare settings parameters, you now need to group all fields under <code>settings: { }</code>
For example:</p>
</div>
<div class="paragraph">
<p>Replace the following invalid settings config</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>  &quot;settings.replayInterval&quot;: 10,
  &quot;settings.replayEnabled&quot;: true,
  &quot;settings&quot;: {
    &quot;about&quot;: {
      &quot;keycloak&quot;: {
        &quot;name&quot;: &quot;Keycloak&quot;,
        &quot;rank&quot;: 2,
        &quot;version&quot;: &quot;6.0.1&quot;
      },
    }
    &quot;locale&quot;: &quot;en&quot;,
    &quot;dateTimeFormat&quot;: &quot;HH:mm dd/MM/yyyy&quot;,
    &quot;dateFormat&quot;: &quot;dd/MM/yyyy&quot;,
    &quot;styleWhenNightDayModeDesactivated&quot;: &quot;NIGHT&quot;
  },</code></pre>
</div>
</div>
<div class="paragraph">
<p>By this valid one :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>  &quot;settings&quot;: {
    &quot;replayInterval&quot;: 10,
    &quot;replayEnabled&quot;: true,
    &quot;about&quot;: {
      &quot;keycloak&quot;: {
        &quot;name&quot;: &quot;Keycloak&quot;,
        &quot;rank&quot;: 2,
        &quot;version&quot;: &quot;6.0.1&quot;
      },
    }
    &quot;locale&quot;: &quot;en&quot;,
    &quot;dateTimeFormat&quot;: &quot;HH:mm dd/MM/yyyy&quot;,
    &quot;dateFormat&quot;: &quot;dd/MM/yyyy&quot;,
    &quot;styleWhenNightDayModeDesactivated&quot;: &quot;NIGHT&quot;
  },</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="opfab_spec_conf"><a class="anchor" href="#opfab_spec_conf"></a>3.3. Security Configuration</h3>
<div class="paragraph">
<p>Configure the security concern throughout several files:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>nginx.conf</code> of the nginx server</p>
</li>
<li>
<p><code>config/docker/common.yml</code> the common configuration file for back services</p>
</li>
<li>
<p><code>web-ui.json</code> served by the <code>web-ui</code> service;</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="_authentication_configuration"><a class="anchor" href="#_authentication_configuration"></a>3.3.1. Authentication configuration</h4>
<div class="paragraph">
<p>There are 3 OAuth2 Authentication flows available into OperatorFabric UI:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>password grant: referred as <code>PASSWORD</code> mode flow;</p>
</li>
<li>
<p>code flow : referred as <code>CODE</code> mode flow;</p>
</li>
<li>
<p>implicit flow: referred as <code>IMPLICIT</code> mode flow.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Alternatively there is also another flow available:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>none flow: referred as <code>NONE</code> mode flow.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The <code>NONE</code> flow assumes that the application is behind a secured proxy which handles login and token generation.
Calls to backend services will get a valid token added to the headers and the token will not be visible for the (web)client.</p>
</div>
<div class="sect4">
<h5 id="_nginx_configuration_2"><a class="anchor" href="#_nginx_configuration_2"></a>3.3.1.1. Nginx Configuration</h5>
<div class="paragraph">
<p>The UI calls need some mapping to reach the Authentication Provider. In the default OperatorFabric configuration it&#8217;s a
<code>docker keycloak instance</code>, called <code>keycloak</code> in the project <code>docker-compose.yml</code> files.</p>
</div>
<div class="paragraph">
<p>There are 3 properties to configure within <code>nginx.conf</code> file:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>$KeycloakBaseUrl</code>: the base url of keycloak;</p>
</li>
<li>
<p><code>$OperatorFabricRealm</code>: the realm configure within keycloak instance to provide authentication to OperatorFabric;</p>
</li>
<li>
<p><code>$ClientPairOFAuthentication</code>: base64 encoded string of the pair of client authentication used by OperatorFabric
to log to the Authentication Provider (keycloak). The client-id and the client-secret are separated by a colon(':').</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p><strong>Example of the <code>docker</code> configuration</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre># Url of the Authentication provider
    set $KeycloakBaseUrl "http://keycloak:89";
# Realm associated to OperatorFabric within the Authentication provider
    set $OperatorFabricRealm "dev";

# base64 encoded pair of authentication in the form of 'client-id:secret-id'
    set $ClientPairOFAuthentication "b3BmYWItY2xpZW50Om9wZmFiLWtleWNsb2FrLXNlY3JldA==" ;</pre>
</div>
</div>
<div class="paragraph">
<p>where <code>b3BmYWItY2xpZW50Om9wZmFiLWtleWNsb2FrLXNlY3JldA==</code> is the base64 encoded string of
<code>opfab-client:opfab-keycloak-secret</code> with <code>opfab-client</code> as client-id and <code>opfab-keycloak-secret</code> its client secret.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="_configuration_file_common_yml"><a class="anchor" href="#_configuration_file_common_yml"></a>3.3.1.2. Configuration file common.yml</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">default</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">mandatory?</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Description</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.security.oauth2.resourceserver.jwt.jwk-set-uri</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">null</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The url providing the certificate used to verify the jwt signature</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.security.jwt.loginClaim</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">sub</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Jwt claim used for user login</p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p><strong>example of <code>common.yml</code></strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yml"><span class="key">spring</span>:
  <span class="key">security</span>:
    <span class="key">oauth2</span>:
      <span class="key">resourceserver</span>:
        <span class="key">jwt</span>:
          <span class="key">jwk-set-uri</span>:  <span class="string"><span class="content">http://localhost:89/auth/realms/dev/protocol/openid-connect/certs</span></span></code></pre>
</div>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="_configuration_file_web_ui_json"><a class="anchor" href="#_configuration_file_web_ui_json"></a>3.3.1.3. Configuration file web-ui.json</h5>
<div class="paragraph">
<p>Nginx web server serves this file. OperatorFabric creates and uses a custom Docker image containing an Nginx server with a docker volume containing this file. The  docker-compose.yml contains an example of it. The path in the image to it is <code>/usr/share/nginx/html/opfab/web-ui.json</code>.</p>
</div>
<div class="paragraph">
<p>For OAuth2 security concerns into this file, there are two ways to configure it, based on the Oauth2 chosen flow.
There are several common properties:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>security.logout-url</code>: url used when a user is logged out of the UI;</p>
</li>
<li>
<p><code>security.oauth2.flow.delegate-url</code>: url used to connect to the Authentication provider;</p>
</li>
<li>
<p><code>security.oauth2.flow.mode</code>: technical way to be authenticated by the Authentication provider.</p>
</li>
<li>
<p><code>security.oauth2.client-id</code> : the OAuth2 client ID</p>
</li>
<li>
<p><code>security.jwt.login-claim</code> : the field in the token that will be used to identify your account (default value : sub)</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_oauth2_password_or_code_flows"><a class="anchor" href="#_oauth2_password_or_code_flows"></a>3.3.1.4. OAuth2 PASSWORD or CODE Flows</h5>
<div class="paragraph">
<p>These two modes share the same way of declaring the delegate URL. This has to be defined in web-ui.json by setting :</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>security.oauth2.flow.mode</code> to <code>PASSWORD</code> or <code>CODE</code>;</p>
</li>
<li>
<p><code>security.oauth2.flow.delegate-url</code> with the URL of the OAuth2 leading to the protocol used for authentication.</p>
</li>
</ul>
</div>
<div class="sect5">
<h6 id="_example_of_configuration_for_code_flow"><a class="anchor" href="#_example_of_configuration_for_code_flow"></a>Example of Configuration For CODE Flow</h6>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="json">{
    <span class="key"><span class="delimiter">&quot;</span><span class="content">security</span><span class="delimiter">&quot;</span></span>: {
      <span class="key"><span class="delimiter">&quot;</span><span class="content">jwt</span><span class="delimiter">&quot;</span></span>: {
        <span class="key"><span class="delimiter">&quot;</span><span class="content">login-claim</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">preferred_username</span><span class="delimiter">&quot;</span></span>
      },
      <span class="key"><span class="delimiter">&quot;</span><span class="content">oauth2</span><span class="delimiter">&quot;</span></span>: {
        <span class="key"><span class="delimiter">&quot;</span><span class="content">client-id</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">OAUTHCLIENTID</span><span class="delimiter">&quot;</span></span>,
        <span class="key"><span class="delimiter">&quot;</span><span class="content">flow</span><span class="delimiter">&quot;</span></span>: {
          <span class="key"><span class="delimiter">&quot;</span><span class="content">mode</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">CODE</span><span class="delimiter">&quot;</span></span>,
          <span class="key"><span class="delimiter">&quot;</span><span class="content">delegate-url</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">http://localhost:89/auth/realms/dev/protocol/openid-connect/auth?response_type=code&amp;client_id=opfab-client</span><span class="delimiter">&quot;</span></span>
        }
      },
      <span class="key"><span class="delimiter">&quot;</span><span class="content">logout-url</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">http://localhost:89/auth/realms/dev/protocol/openid-connect/logout?redirect_uri=http://localhost:2002/</span><span class="delimiter">&quot;</span></span>
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Within the <code>delegate-url</code> property <code>dev</code> is the keycloak client realm of OperatorFabric.
For keycloak instance used for development purposes, this <code>delegate-url</code> correspond to the realm under which the client <code>opfab-client</code> is registered.
Here, the <code>client-id</code> value is <code>opfab-client</code> which is defined as client under the <code>realm</code> named <code>dev</code> on the dev keycloak instance.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_oauth2_implicit_flow"><a class="anchor" href="#_oauth2_implicit_flow"></a>3.3.1.5. OAuth2 IMPLICIT Flow</h5>
<div class="paragraph">
<p>It had its own way of configuration.
To enable IMPLICIT Flow authentication the following properties need to be set in web-ui.json:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>security.oauth2.flow.mode</code> to <code>IMPLICIT</code>;</p>
</li>
<li>
<p><code>security.oauth2.flow.delegate-url</code> with the URL of the OAuth2 leading to the <code>.well-known/openid-configuration</code> end-point used for authentication configuration.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>It is possible to configure the URL to redirect the browser after logout by setting the <code>security.implicit-mode-post-logout-url</code> parameter in web-ui.json.
Be careful that the configured value should be one of the valid post logout redirect URIs configured on Keycloak realm.</p>
</div>
<div class="sect5">
<h6 id="_example_of_configuration_for_implicit_flow"><a class="anchor" href="#_example_of_configuration_for_implicit_flow"></a>Example of configuration for IMPLICIT Flow</h6>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="json">{
  <span class="key"><span class="delimiter">&quot;</span><span class="content">security</span><span class="delimiter">&quot;</span></span>: {
    <span class="key"><span class="delimiter">&quot;</span><span class="content">jwt</span><span class="delimiter">&quot;</span></span>: {
        <span class="key"><span class="delimiter">&quot;</span><span class="content">login-claim</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">preferred_username</span><span class="delimiter">&quot;</span></span>
      },
    <span class="key"><span class="delimiter">&quot;</span><span class="content">oauth2</span><span class="delimiter">&quot;</span></span>: {
      <span class="key"><span class="delimiter">&quot;</span><span class="content">client-id</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">OAUTHCLIENTID</span><span class="delimiter">&quot;</span></span>,
      <span class="key"><span class="delimiter">&quot;</span><span class="content">flow</span><span class="delimiter">&quot;</span></span>: {
        <span class="key"><span class="delimiter">&quot;</span><span class="content">mode</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">IMPLICIT</span><span class="delimiter">&quot;</span></span>,
        <span class="key"><span class="delimiter">&quot;</span><span class="content">delegate-url</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">http://localhost:89/auth/realms/dev</span><span class="delimiter">&quot;</span></span>
      }
    },
    <span class="key"><span class="delimiter">&quot;</span><span class="content">logout-url</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">http://localhost:89/auth/realms/dev/protocol/openid-connect/logout?redirect_uri=http://localhost:2002/</span><span class="delimiter">&quot;</span></span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">implicit-mode-post-logout-url</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">https://opfab.github.io</span><span class="delimiter">&quot;</span></span>
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Within the <code>delegate-url</code> property <code>dev</code> is the keycloak client realm of OperatorFabric.
For keycloak instance used for development purposes, this <code>delegate-url</code> correspond to the realm under which the client <code>opfab-client</code> is registered.
The url look up by the implicit ui mechanism is <code><a href="http://localhost:89/auth/realms/dev/.well-known/openid-configuration" class="bare">localhost:89/auth/realms/dev/.well-known/openid-configuration</a></code>.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_none_flow"><a class="anchor" href="#_none_flow"></a>3.3.1.6. NONE Flow</h5>
<div class="paragraph">
<p>The configuration for the NONE flow is a bit different because the token isn&#8217;t handled/visible in the front-end.</p>
</div>
<div class="sect5">
<h6 id="_nginx"><a class="anchor" href="#_nginx"></a>Nginx</h6>
<div class="paragraph">
<p>The following variables can be removed:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>$KeycloakBaseUrl</code></p>
</li>
<li>
<p><code>$OperatorFabricRealm</code></p>
</li>
<li>
<p><code>$ClientPairOFAuthentication</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The locations for handling tokens can be edited to return a 401 by default.
If one of these locations is called, the token generated by the secured proxy has expired.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="config">location /auth/check_token {
  return 401;
}
location /auth/token {
  return 401;
}
location /auth/code/ {
  return 401;
}</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_web_ui_json"><a class="anchor" href="#_web_ui_json"></a>Web-ui.json</h6>
<div class="paragraph">
<p>Set the security.oauth2.flow.mode to <code>NONE</code>;</p>
</div>
<div class="paragraph">
<p>Set the security.oauth2.client-id to <code>Your Oauth client ID</code>;</p>
</div>
<div class="paragraph">
<p>Use the security.jwt.login-claim to select value from the token will be used to identify your account. In this example <code>preferred_username</code> is used;</p>
</div>
<div class="paragraph">
<p>Settings that are not required are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>delegate-url</p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="_example_of_configuration"><a class="anchor" href="#_example_of_configuration"></a>Example of configuration</h6>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="json">{
    <span class="key"><span class="delimiter">&quot;</span><span class="content">security</span><span class="delimiter">&quot;</span></span>: {
      <span class="key"><span class="delimiter">&quot;</span><span class="content">jwt</span><span class="delimiter">&quot;</span></span>: {
        <span class="key"><span class="delimiter">&quot;</span><span class="content">login-claim</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">preferred_username</span><span class="delimiter">&quot;</span></span>
      },
      <span class="key"><span class="delimiter">&quot;</span><span class="content">oauth2</span><span class="delimiter">&quot;</span></span>: {
        <span class="key"><span class="delimiter">&quot;</span><span class="content">client-id</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">OAUTHCLIENTID</span><span class="delimiter">&quot;</span></span>,
        <span class="key"><span class="delimiter">&quot;</span><span class="content">flow</span><span class="delimiter">&quot;</span></span>: {
          <span class="key"><span class="delimiter">&quot;</span><span class="content">mode</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">NONE</span><span class="delimiter">&quot;</span></span>
        }
      },
      <span class="key"><span class="delimiter">&quot;</span><span class="content">logout-url</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">http://my-secured-proxy/OAUTHTENANTID/oauth2/logout?client_id=OAUTHCLIENTID&amp;post_logout_redirect_uri=https%3A%2F%2Flocalhost:2002%2Fui%2Fui/</span><span class="delimiter">&quot;</span></span>
    }
 }</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_user_creation"><a class="anchor" href="#_user_creation"></a>3.3.2. User creation</h4>
<div class="paragraph">
<p>If a user exists in the authentication system but not in Opfab, their profile will be automatically created upon their initial login. The user&#8217;s name and family name will be extracted from the authentication token.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">name</th>
<th class="tableblock halign-left valign-top">default</th>
<th class="tableblock halign-left valign-top">mandatory?</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.security.jwt.givenNameClaim</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">given-name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Jwt claim to use to get the user&#8217;s name</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.security.jwt.familyName-claim</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">family-name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Jwt claim to used to get the user&#8217;s family name</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="jwt_mode"><a class="anchor" href="#jwt_mode"></a>3.3.3. Alternative way to manage groups (and/or entities)</h4>
<div class="paragraph">
<p>By default, <code>OperatorFabric</code> manages groups (and/or entities) through the user's collection in the database.
Another mode can be defined, the JWT mode. The groups (and/or entities) come from the authentication token.</p>
</div>
<div class="paragraph">
<p>To activate this option , you need to set some parameter in the common.yml file :</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">name</th>
<th class="tableblock halign-left valign-top">default</th>
<th class="tableblock halign-left valign-top">mandatory?</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.security.jwt.groups.mode</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPERATOR_FABRIC</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Set the group mode, possible values JWT or OPERATOR_FABRIC</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.security.jwt.groups.rolesClaim.rolesClaimStandard.path</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">path in the JWT to retrieve the claim that defines a group</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.security.jwt.groups.rolesClaim.rolesClaimStandardArray.path</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">path in the JWT to retrieve the claim that defines an array of groups</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.security.jwt.groups.rolesClaim.rolesClaimStandardList.path</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">path in the JWT to retrieve the claim that defines a list of group</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.security.jwt.groups.rolesClaim.rolesClaimStandardList.separator</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">set the separator value of the list of group</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.security.jwt.groups.rolesClaim.rolesClaimCheckExistPath.path</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">path in the JWT to check if that path does exist, if it does, use the roleValue as a group</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.security.jwt.groups.rolesClaim.rolesClaimCheckExistPath.roleValue</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">set the value of the group if the path exists</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.security.jwt.entitiesIdClaim</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">set the name of the field in the token</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.security.jwt.gettingEntitiesFromToken</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">boolean indicating if you want the entities of the user to come from the token and not mongoDB (possible values : true/false)</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><em>application.yml</em></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>operatorfabric:
  security:
    jwt:
      entitiesIdClaim: entitiesId
      gettingEntitiesFromToken: true
      groups:
        mode: JWT # value possible JWT | OPERATOR_FABRIC
        rolesClaim:
          rolesClaimStandard:
            - path: &quot;ATTR1&quot;
            - path: &quot;ATTR2&quot;            
          rolesClaimStandardArray:  
            - path: &quot;resource_access/opfab-client/roles&quot;
          rolesClaimStandardList:  
            - path: &quot;roleFieldList&quot; 
              separator: &quot;;&quot;           
          rolesClaimCheckExistPath: 
            - path: &quot;resource_access/AAA&quot; 
              roleValue: &quot;roleAAA&quot;      
            - path: &quot;resource_access/BBB&quot;
              roleValue: &quot;roleBBB&quot;  </code></pre>
</div>
</div>
<div class="paragraph">
<p><em>JWT example</em></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>{
  &quot;jti&quot;: &quot;5ff87583-10bd-4946-8753-9d58171c8b7f&quot;,
  &quot;exp&quot;: 1572979628,
  &quot;nbf&quot;: 0,
  &quot;iat&quot;: 1572961628,
  &quot;iss&quot;: &quot;http://localhost:89/auth/realms/dev&quot;,
  &quot;aud&quot;: [
    &quot;AAA&quot;,
    &quot;BBB&quot;,
    &quot;account&quot;
  ],
  &quot;sub&quot;: &quot;example_user&quot;,
  &quot;typ&quot;: &quot;Bearer&quot;,
  &quot;azp&quot;: &quot;opfab-client&quot;,
  &quot;auth_time&quot;: 0,
  &quot;session_state&quot;: &quot;960cbec4-fcb2-47f2-a155-975832e61300&quot;,
  &quot;acr&quot;: &quot;1&quot;,
  &quot;realm_access&quot;: {
    &quot;roles&quot;: [
      &quot;offline_access&quot;,
      &quot;uma_authorization&quot;
    ]
  },
  &quot;resource_access&quot;: {
    &quot;AAA&quot;: {
      &quot;roles&quot;: [
        &quot;role_AAA&quot;
      ]
    },
    &quot;BBB&quot;: {
      &quot;roles&quot;: [
        &quot;role_BBB&quot;
      ]
    },
    &quot;opfab-client&quot;: {
      &quot;roles&quot;: [
        &quot;USER&quot;
      ]
    },
    &quot;account&quot;: {
      &quot;roles&quot;: [
        &quot;manage-account&quot;,
        &quot;manage-account-links&quot;,
        &quot;view-profile&quot;
      ]
    }
  },
  &quot;scope&quot;: &quot;openid ATTR2 email ATTR1 profile roleFieldList&quot;,
  &quot;email_verified&quot;: false,
  &quot;name&quot;: &quot;example_firtstname example_lastname&quot;,
  &quot;ATTR2&quot;: &quot;roleATTR2&quot;,
  &quot;ATTR1&quot;: &quot;roleATTR1&quot;,
  &quot;preferred_username&quot;: &quot;example_user&quot;,
  &quot;given_name&quot;: &quot;example_firtstname&quot;,
  &quot;entitiesId&quot;: &quot;ENTITY1&quot;,
  &quot;family_name&quot;: &quot;example_lastname&quot;,
  &quot;email&quot;: &quot;example_user@mail.com&quot;,
  &quot;roleFieldList&quot;: &quot;roleA;roleB;roleC&quot;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>As the result, the group will be [ATTR1, ATTR2, roleA, roleB, roleC, USER, roleBBB, roleAAA]</p>
</div>
</div>
<div class="sect3">
<h4 id="custom_certificates"><a class="anchor" href="#custom_certificates"></a>3.3.4. Adding certification authorities or certificates to the Java keystore</h4>
<div class="paragraph">
<p>If you&#8217;re using certificates (for example for Keycloak) that are not from a certification authority trusted by the JVM,
this will cause errors such as this one:</p>
</div>
<div class="listingblock">
<div class="title">Missing certificate error message</div>
<div class="content">
<pre>Caused by: sun.security.validator. ValidatorException: PKIX path building failed: sun.security.provider.certpath.SunCertPathBuilderException: unable to find valid certification path to
requested target
at sun.security.validator.PKIXValidator.doBuild(PKIXValidator.java:397)
at sun.security.validator.PKIXValidator.engineValidate(PKIXValidator.java:302)
at sun.security.validator.Validator.validate(Validator.java:262)
at sun.security.ssl.X509TrustManager Impl.validate(x509TrustManagerImpl.java:330)
at sun.security.ssl.X509TrustManagerImpl.checkTrusted(x509TrustManagerImpl.java:237)
at sun.security.ssl.X509TrustManager Impl.checkServerTrusted(x509TrustManager Impl.java:132)
at sun.security.ssl.clientHandshaker.serverCertificate(ClientHandshaker.java:1621)
94 common frames omitted
Caused by: sun.security.provider.certpath. SunCertPathBuilderException: unable to find valid certification path to requested target
at sun.security.provider.certpath. SunCertPathBuilder.build(SunCertPathBuilder.java:141)
at sun.security.provider.certpath.SunCertPathBuilder.engineBuild(SunCertPathBuilder.java:126)
at java.security.cert.CertPathBuilder.build(CertPathBuilder.java:280)
at sun.security.validator.PKIXValidator.doBuild(PKIXValidator.java:392)
... 100 common frames omitted</pre>
</div>
</div>
<div class="paragraph">
<p>If that is the case, you can pass the additional authorities or certificates that you use to the containers at runtime.</p>
</div>
<div class="paragraph">
<p>To do so, put the relevant files (*.der files for example) under <strong>src/main/docker/certificates</strong>.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>This directory should only contain the files to be added to the keystore.</p>
</li>
<li>
<p>The files can be nested inside directories.</p>
</li>
<li>
<p>Each certificate will be added with its filename as alias. For example, the certificate in file mycertificate.der
will be added under alias <strong>mycertificate</strong>. As a consequence, filenames should be unique or it will cause an error.</p>
</li>
<li>
<p>If you need to add or remove certificates while the container is already running, the container will have to be
restarted for the changes to be taken into account.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>If you would like certificates to be sourced from a different location, replace the volumes declarations in the deploy
docker-compose.yml file with the selected location:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>volumes:
 - "path/to/my/selected/location:/certificates_to_add"</pre>
</div>
</div>
<div class="paragraph">
<p>instead of</p>
</div>
<div class="literalblock">
<div class="content">
<pre>volumes:
 - "../../../../src/main/docker/certificates:/certificates_to_add"</pre>
</div>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
The steps described here assume you&#8217;re running OperatorFabric in docker mode using the deploy docker compose,
but they can be adapted for single container deployments and development mode.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If you want to check that the certificates were correctly added, you can do so with the following steps:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Open a bash shell in the container you want to check</p>
<div class="literalblock">
<div class="content">
<pre>docker exec -it deploy-businessconfig-1 bash</pre>
</div>
</div>
</li>
<li>
<p>Run the following command</p>
<div class="literalblock">
<div class="content">
<pre>$JAVA_HOME/bin/keytool -list -v -keystore /tmp/cacerts -storepass changeit</pre>
</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>You can also look at the default list of authorities and certificates trusted by the JVM with this command:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$JAVA_HOME/bin/keytool -list -v -keystore $JAVA_HOME/jre/lib/security/cacerts -storepass changeit</pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_operatorfabric_cli_command_line_interface"><a class="anchor" href="#_operatorfabric_cli_command_line_interface"></a>4. OperatorFabric CLI (Command Line Interface)</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The OperatorFabric CLI is designed to streamline administrative tasks. It provides a user-friendly alternative to direct API access and custom scripting, enhancing efficiency and ease of use.</p>
</div>
<div class="paragraph">
<p>The CLI is automatically installed when you execute the <code>bin/load_environment_light.sh</code> script.</p>
</div>
<div class="paragraph">
<p>To use the CLI, simply type <code>opfab help</code> in your terminal to view a list of available commands.</p>
</div>
<div class="paragraph">
<p>Before you can start using the CLI, you must first authenticate yourself with the desired OperatorFabric instance using the login command.</p>
</div>
<div class="paragraph">
<p>For those preferring not to install npm and nodejs locally, the CLI is accessible via a Docker container. Utilize the <code>cli/opfabDockerCli.sh</code> script to launch a shell environment pre-configured with the opfab CLI. The script mounts your current directory to <code>/host</code> within the Docker container.</p>
</div>
<div class="paragraph">
<p>Using the Docker version, you can pre-set environment configurations through a config file. This file should list each environment configuration on a separate line. For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>dev DEV LOCALHOST_URL 2002 admin test
prod PROD PROD_URL 80</pre>
</div>
</div>
<div class="paragraph">
<p>Each line consists of:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The first value is the configuration name.</p>
</li>
<li>
<p>The second value is the name to be added to the shell prompt.</p>
</li>
<li>
<p>The third value is the URL of the OperatorFabric instance.</p>
</li>
<li>
<p>The fourth value is the port number to use.</p>
</li>
<li>
<p>The fifth value is the username.</p>
</li>
<li>
<p>The sixth value is the password (if not provided, it will be requested via a prompt).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To launch the Docker CLI using the config file, execute <code>opfabDockerCli.sh</code> with the config file as an argument.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_monitoring"><a class="anchor" href="#_monitoring"></a>5. Monitoring</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Operator Fabric provides end points for monitoring via <a href="https://prometheus.io/">prometheus</a>. The monitoring is available for the five following services: user, businessconfig, cards-consultation, cards-publication and external-devices.  To enable the monitoring , you need to open the endpoint by adding in the common yml configuration file :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>management:
  endpoints:
    web:
      exposure:
        include: '*'</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can start a test prometheus instance via <code>config/monitoring/startPrometheus.sh</code> , the monitoring will be accessible on <a href="http://localhost:9090/" class="bare">localhost:9090/</a></p>
</div>
<div class="paragraph">
<p>It is also possible to monitor the health status of cards-external-diffusion, cards-reminder and supervisor services by making an HTTP GET request to the "/healthcheck" endpoint exposed by each service. The healthcheck endpoint will return a HTTP 200 status code if the service is up and running.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_logging_administration"><a class="anchor" href="#_logging_administration"></a>6. Logging Administration</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_logging_configuration"><a class="anchor" href="#_logging_configuration"></a>6.1. Logging configuration</h3>
<div class="paragraph">
<p>Log levels can be defined either globally in the YAML configuration file or individually for each service. You will find a commented configuration for each service within the directory config/docker.</p>
</div>
<div class="paragraph">
<p>Services are designed to write logs to two primary destinations: standard output and log files within the Docker containers.</p>
</div>
<div class="paragraph">
<p>If you want to save logs you can redirect the standard output to a file.</p>
</div>
<div class="paragraph">
<p>Or you can also map the Docker directory /var/log/opfab to a location on the host machine for each business services, keeping logs outside of the container.</p>
</div>
<div class="paragraph">
<p>For the web-ui service&#8217;s logs are in the /var/log/nginx directory. You can map this directory to the host to preserve those logs.</p>
</div>
</div>
<div class="sect2">
<h3 id="_runtime_configuration"><a class="anchor" href="#_runtime_configuration"></a>6.2. Runtime configuration</h3>
<div class="paragraph">
<p>Operator Fabric includes the ability to view and configure the log levels at runtime through APIs for most of the business services. It is possible to configure and view an individual logger configuration, which is made up of both the explicitly configured logging level as well as the effective logging level given to it by the logging framework.</p>
</div>
<div class="paragraph">
<p>Querying and setting logging levels is restricted to administrators.</p>
</div>
<div class="sect3">
<h4 id="_java_services"><a class="anchor" href="#_java_services"></a>6.2.1. Java services</h4>
<div class="paragraph">
<p>For java services (user, businessconfig, cards-consultation, cards-publication and external-devices) the available logging levels are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>TRACE</p>
</li>
<li>
<p>DEBUG</p>
</li>
<li>
<p>INFO</p>
</li>
<li>
<p>WARN</p>
</li>
<li>
<p>ERROR</p>
</li>
<li>
<p>FATAL</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To view the configured logging level for a given logger it is possible to send a GET request to the '/actuator/logger' URI as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>curl http://&lt;server&gt;:&lt;port&gt;/actuator/loggers/${logger} -H "Authorization: Bearer ${token}" -H "Content-type:application/json"</pre>
</div>
</div>
<div class="paragraph">
<p>where <code>${token}</code> is a valid OAuth2 JWT for a user with administration privileges
and <code>${logger}</code> is the logger (ex: org.opfab)</p>
</div>
<div class="paragraph">
<p>The response will be a json object like the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>{
  "configuredLevel" : "INFO",
  "effectiveLevel" : "INFO"
}</pre>
</div>
</div>
<div class="paragraph">
<p>To get the log level for ROOT logger of a java service it is possible to use opfab CLI "log" command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>opfab log get-level &lt;serviceName&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>To configure a given logger, POST a json entity to the '/actuator/logger' URI, as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>curl -i -X POST http://&lt;server&gt;:&lt;port&gt;/actuator/loggers/${logger} -H "Authorization: Bearer ${token}" -H 'Content-Type: application/json' -d '{"configuredLevel": "DEBUG"}'</pre>
</div>
</div>
<div class="paragraph">
<p>To “reset” the specific level of the logger (and use the default configuration instead) it is possible to pass a value of null as the configuredLevel.</p>
</div>
<div class="paragraph">
<p>To set the log level for ROOT logger of a java service it is possible to use opfab CLI "log" command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>opfab log set-level &lt;serviceName&gt; &lt;level&gt;</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_node_services"><a class="anchor" href="#_node_services"></a>6.2.2. Node Services</h4>
<div class="paragraph">
<p>For node services (supervisor, cards-external-diffusion and cards-reminder) the available logging levels are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>silly</p>
</li>
<li>
<p>debug</p>
</li>
<li>
<p>verbose</p>
</li>
<li>
<p>http</p>
</li>
<li>
<p>info</p>
</li>
<li>
<p>warn</p>
</li>
<li>
<p>error</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To view the configured logging level for a given logger it is possible to send a GET request to the '/logLevel' URI as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>curl http://&lt;server&gt;:&lt;port&gt;/logLevel -H "Authorization: Bearer ${token}"</pre>
</div>
</div>
<div class="paragraph">
<p>where <code>${token}</code> is a valid OAuth2 JWT for a user with administration privileges</p>
</div>
<div class="paragraph">
<p>The response will be a json object like the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>{
  "configuredLevel" : "INFO",
  "effectiveLevel" : "INFO"
}</pre>
</div>
</div>
<div class="paragraph">
<p>To get the log level for a node service it is possible to use opfab CLI "log" command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>opfab log get-level &lt;serviceName&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>To configure a given logger, POST a json entity to the '/logLevel' URI, as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>curl -i -X POST http://&lt;server&gt;:&lt;port&gt;/logLevel -H "Authorization: Bearer ${token}" -H 'Content-Type: application/json' -d '{"configuredLevel": "debug"}'</pre>
</div>
</div>
<div class="paragraph">
<p>To “reset” the specific level of the logger (and use the default configuration instead) it is possible to pass a value of null as the configuredLevel.</p>
</div>
<div class="paragraph">
<p>To set the log level for a node service it is possible to use opfab CLI "log" command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>opfab log set-level &lt;serviceName&gt; &lt;level&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>Using the opfab CLI command to get or set log levels for node service, the custom node log levels will be converted to standard levels as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>silly &#8594; trace</p>
</li>
<li>
<p>debug &#8594; debug</p>
</li>
<li>
<p>verbose &#8594; debug</p>
</li>
<li>
<p>http &#8594; debug</p>
</li>
<li>
<p>info &#8594; info</p>
</li>
<li>
<p>warn &#8594; warn</p>
</li>
<li>
<p>error &#8594; error</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_users_groups_and_entities_administration"><a class="anchor" href="#_users_groups_and_entities_administration"></a>7. Users, Groups and Entities Administration</h2>
<div class="sectionbody">
<div class="paragraph">
<p>A new operator call John Doe, who has OAuth granted right to connect to current <code>OperatorFabric</code> instance, need to receive cards within current <code>OperatorFabric</code> instance.
As a user of OperatorFabric, he needs to be added to the system with a <code>login</code> (john-doe-operator), his <code>firstName</code> (John) and his <code>lastName</code> (Doe).
As there is no <code>Administration GUI</code> for the moment, it must be performed through command line, as detailed in the Users API.</p>
</div>
<div class="sect2">
<h3 id="_users"><a class="anchor" href="#_users"></a>7.1. Users</h3>
<div class="sect3">
<h4 id="_list_all_users"><a class="anchor" href="#_list_all_users"></a>7.1.1. List all users</h4>
<div class="paragraph">
<p>First of all, list the users (who are the recipients in OperatorFabric) of the system with the following commands:</p>
</div>
<div class="paragraph">
<p>Httpie</p>
</div>
<div class="literalblock">
<div class="content">
<pre>http http://localhost:2103/users "Authorization:Bearer $token" "Content-Type:application/type"</pre>
</div>
</div>
<div class="paragraph">
<p>cURL</p>
</div>
<div class="literalblock">
<div class="content">
<pre>curl -v http://localhost:2103/users -H "Authorization:Bearer $token" -H "Content-Type:application/type"</pre>
</div>
</div>
<div class="paragraph">
<p>response</p>
</div>
<div class="literalblock">
<div class="content">
<pre>HTTP/1.1 200 OK

[
    {
        "firstName": null,
        "groups": [
            "ADMIN"
        ],
        "entities": [
            "ENTITY1_FR",
            "ENTITY2_FR"
        ],
        "lastName": null,
        "login": "admin"
    },
    {
        "firstName": null,
        "groups": [
            "RTE",
            "ADMIN",
            "CORESO",
            "Maintainer",
            "TEST"
        ],
        "lastName": null,
        "login": "operator3_fr"
    },
    {
        "firstName": null,
        "groups": [
            "ELIA"
        ],
        "lastName": null,
        "login": "elia-operator"
    },
    {
        "firstName": null,
        "groups": [
            "CORESO"
        ],
        "lastName": null,
        "login": "coreso-operator"
    },
    {
        "firstName": null,
        "groups": [
            "Dispatcher",
            "Maintainer",
            "TEST"
        ],
        "entities": [
            "ENTITY1_FR"
        ],
        "lastName": null,
        "login": "operator1_fr"
    },
    {
        "firstName": null,
        "groups": [
            "Planner",
            "Maintainer"
        ],
        "entities": [
            "ENTITY2_FR"
        ],
        "lastName": null,
        "login": "operator2_fr"
    },
]</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_create_a_new_user"><a class="anchor" href="#_create_a_new_user"></a>7.1.2. Create a new User</h4>
<div class="paragraph">
<p>We are sure that no John-doe-operator exists in our OperatorFabric instance.
We can add him in our OperatorFabric instance using the following command use httpie:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>echo '{"login":"john-doe-operator","firstName":"Jahne","lastName":"Doe"}' | http POST http://localhost:2103/users "Authorization:Bearer $token" "Content-Type:application/json"</pre>
</div>
</div>
<div class="paragraph">
<p>Or here cURL:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>curl -X POST http://localhost:2103/users -H "Authorization:Bearer $token" -H "Content-Type:application/json" --data '{"login":"john-doe-operator","firstName":"Jahne","lastName":"Doe"}'</pre>
</div>
</div>
<div class="paragraph">
<p>response</p>
</div>
<div class="literalblock">
<div class="content">
<pre>HTTP/1.1 200 OK

{
    "firstName": "Jahne",
    "lastName": "Doe",
    "login": "john-doe-operator"
}</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_fetch_user_details"><a class="anchor" href="#_fetch_user_details"></a>7.1.3. Fetch user details</h4>
<div class="paragraph">
<p>It&#8217;s always a good thing to verify if all the information has been correctly recorded in the system:</p>
</div>
<div class="paragraph">
<p>with httpie:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>http -b http://localhost:2103/users/john-doe-operator "Authorization:Bearer $token" "Content-Type:application/json"</pre>
</div>
</div>
<div class="paragraph">
<p>or with cURL:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>curl http://localhost:2103/users/john-doe-operator -H "Authorization:Bearer $token" -H "Content-Type:application/json"</pre>
</div>
</div>
<div class="paragraph">
<p>response</p>
</div>
<div class="literalblock">
<div class="content">
<pre>HTTP/1.1 200 OK

{
    "firstName": "Jahne",
    "groups": [],
    "entities": [],
    "lastName": "Doe",
    "login": "john-doe-operator"
}</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_update_user_details"><a class="anchor" href="#_update_user_details"></a>7.1.4. Update user details</h4>
<div class="paragraph">
<p>As shown by this result, the firstName of the new operator has been misspelled.
We need
<a href="/documentation/current/api/users/index.html#/users/updateUser">to update the existing user</a>
with <code>john-doe-operator</code> login.
To correct this mistake, the following commands can be used:</p>
</div>
<div class="paragraph">
<p>with httpie:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>echo '{"login":"john-doe-operator","lastName":"Doe","firstName":"John"}' | http PUT http://localhost:2103/users/john-doe-operator "Authorization:Bearer $token" "Content-Type:application/json"</pre>
</div>
</div>
<div class="paragraph">
<p>or with cURL:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>curl -X PUT http://localhost:2103/users/john-doe-operator -H "Authorization:Bearer $token" -H "Content-Type:application/json" --data '{"login":"john-doe-operator","firstName":"John","lastName":"Doe"}'</pre>
</div>
</div>
<div class="paragraph">
<p>response</p>
</div>
<div class="literalblock">
<div class="content">
<pre>HTTP/1.1 200 OK

{
    "firstName": "John",
    "lastName": "Doe",
    "login": "john-doe-operator"
}</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_notification_configuration"><a class="anchor" href="#_notification_configuration"></a>7.1.5. Notification configuration</h4>
<div class="paragraph">
<p>Using the
<a href="/documentation/current/dev_env/opfab-cli.html#CLI">Opfab CLI</a>
it is possible to configure process/state notification for all users at once.
Execute <code>opfab user help</code> command for usage details.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_groupsentities"><a class="anchor" href="#_groupsentities"></a>7.2. Groups/Entities</h3>
<div class="paragraph">
<p>All the commands below :</p>
</div>
<div class="ulist">
<ul>
<li>
<p>List groups</p>
</li>
<li>
<p>Create a new group</p>
</li>
<li>
<p>Fetch details of a given group</p>
</li>
<li>
<p>Update details of a group</p>
</li>
<li>
<p>Add a user to a group</p>
</li>
<li>
<p>Remove a user from a group</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>are available for both groups and entities. In order not to overload the documentation, we will only detail group endpoints.</p>
</div>
<div class="sect3">
<h4 id="_list_groups_or_entities"><a class="anchor" href="#_list_groups_or_entities"></a>7.2.1. List groups (or entities)</h4>
<div class="paragraph">
<p>This operator is the first member of a new group operator called the <code>OPERATORS</code>, which doesn&#8217;t exist for the moment in
the system. As shown when we
<a href="/documentation/current/api/users/index.html#/groups/fetchGroups">list the groups</a>
existing in the server.</p>
</div>
<div class="paragraph">
<p>Httpie</p>
</div>
<div class="literalblock">
<div class="content">
<pre>http http://localhost:2103/groups "Authorization:Bearer $token" "Content-Type:application/type"</pre>
</div>
</div>
<div class="paragraph">
<p>cURL</p>
</div>
<div class="literalblock">
<div class="content">
<pre>curl http://localhost:2103/groups -H "Authorization:Bearer $token" -H "Content-Type:application/json"</pre>
</div>
</div>
<div class="paragraph">
<p>response</p>
</div>
<div class="literalblock">
<div class="content">
<pre>HTTP/1.1 200 OK

[
    {
        "description": "The admin group",
        "name": "ADMIN group",
        "id": "ADMIN"
    },
    {
        "description": "RTE TSO Group",
        "name": "RTE group",
        "id": "RTE"
    },
    {
        "description": "ELIA TSO group",
        "name": "ELIA group",
        "id": "ELIA"
    },
    {
        "description": "CORESO Group",
        "name": "CORESO group",
        "id": "CORESO"
    },
    {
        "description": "Dispatcher Group",
        "name": "Dispatcher",
        "id": "Dispatcher"
    },
    {
        "description": "Planner Group",
        "name": "Planner",
        "id": "Planner"
    },
    {
        "description": "Maintainer Group",
        "name": "Maintainer",
        "id": "Maintainer"
    }
]</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_create_a_new_group_or_entity"><a class="anchor" href="#_create_a_new_group_or_entity"></a>7.2.2. Create a new group (or entity)</h4>
<div class="paragraph">
<p>Firstly, the group called <code>OPERATORS</code> has to be
<a href="/documentation/current/api/users/index.html#/groups/createGroup">added to the system</a>
using the following command:</p>
</div>
<div class="paragraph">
<p>using httpie:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>echo '{"id":"OPERATORS","decription":"This is the brand new group of operator"}' | http POST http://localhost:2103/groups "Authorization:Bearer $token" "Content-Type:application/json"</pre>
</div>
</div>
<div class="paragraph">
<p>using cURL:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>curl -X POST http://localhost:2103/groups -H "Authorization:Bearer $token" -H "Content-Type:application/json" --data '{"id":"OPERATORS","decription":"This is the brand new group of operator"}'</pre>
</div>
</div>
<div class="paragraph">
<p>response</p>
</div>
<div class="literalblock">
<div class="content">
<pre>HTTP/1.1 200 OK

{
    "perimeters": [],
    "description": null,
    "name": null,
    "id": "OPERATORS"
}</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_fetch_details_of_a_given_group_or_entity"><a class="anchor" href="#_fetch_details_of_a_given_group_or_entity"></a>7.2.3. Fetch details of a given group (or entity)</h4>
<div class="paragraph">
<p>The result returned seems strange, to verify if it&#8217;s the correct answer by
<a href="/documentation/current/api/users/index.html#/groups/fetchGroup">displaying the details of the group</a>
called <code>OPERATORS</code>, use the following command:</p>
</div>
<div class="paragraph">
<p>using httpie:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>http http://localhost:2103/groups/OPERATORS "Authorization:Bearer $token" "Content-Type:application/json"</pre>
</div>
</div>
<div class="paragraph">
<p>using cURL:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>curl http://localhost:2103/groups/OPERATORS -H "Authorization:Bearer $token" -H "Content-Type:application/json"</pre>
</div>
</div>
<div class="paragraph">
<p>response</p>
</div>
<div class="literalblock">
<div class="content">
<pre>HTTP/1.1 200 OK

{
    "perimeters": [],
    "description": null,
    "name": null,
    "id": "OPERATORS"
}</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_update_details_of_a_group_or_entity"><a class="anchor" href="#_update_details_of_a_group_or_entity"></a>7.2.4. Update details of a group (or entity)</h4>
<div class="paragraph">
<p>The description is really null. After verification, in our first command used to create the group,
the attribute for the description is misspelled. Using the following command
<a href="/documentation/current/api/users/index.html#/groups/updateGroup">to update the group</a>
with the correct spelling, the new group of operator gets a proper description:</p>
</div>
<div class="paragraph">
<p>with httpie:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>echo '{"id":"OPERATORS","description":"This is the brand-new group of operator"}' | http -b PUT http://localhost:2103/groups/OPERATORS "Authorization:Bearer $token" "Content-Type:application/json"</pre>
</div>
</div>
<div class="paragraph">
<p>with cURL:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>curl -X PUT http://localhost:2103/groups/OPERATORS -H "Authorization:Bearer $token" -H "Content-Type:application/json" --data '{"id":"OPERATORS","description":"This is the brand-new group of operator"}'</pre>
</div>
</div>
<div class="paragraph">
<p>response</p>
</div>
<div class="literalblock">
<div class="content">
<pre>{
    "perimeters": []
    "description": "This is the brand-new group of operator",
    "name": null,
    "id": "OPERATORS"
}</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_add_a_user_to_a_group_or_entity"><a class="anchor" href="#_add_a_user_to_a_group_or_entity"></a>7.2.5. Add a user to a group (or entity)</h4>
<div class="paragraph">
<p>As both new group and new user are correct it&#8217;s time
<a href="/documentation/current/api/users/index.html#/users/addGroupUsers">to make the user a member of the group</a>
. To achieve this, use the following command:</p>
</div>
<div class="paragraph">
<p>with httpie:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>echo '["john-doe-operator"]' | http PATCH http://localhost:2103/groups/OPERATORS/users "Authorization:Bearer $token" "Content-Type:application/json"</pre>
</div>
</div>
<div class="paragraph">
<p>with cURL:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>curl -X PATCH http://localhost:2103/groups/OPERATORS/users -H "Authorization:Bearer $token" -H "Content-Type:application/json" --data '["john-doe-operator"]'</pre>
</div>
</div>
<div class="paragraph">
<p>response</p>
</div>
<div class="literalblock">
<div class="content">
<pre>HTTP/1.1 200 OK</pre>
</div>
</div>
<div class="paragraph">
<p>Let&#8217;s verify that the changes are correctly recorded by fetching the :</p>
</div>
<div class="literalblock">
<div class="content">
<pre>http http://localhost:2103/users/john-doe-operator "Authorization:Bearer $token" "Content-Type:application/json"</pre>
</div>
</div>
<div class="paragraph">
<p>with cURL</p>
</div>
<div class="literalblock">
<div class="content">
<pre>curl http://localhost:2103/users/john-doe-operator -H "Authorization:Bearer $token" -H "Content-Type:application/json"</pre>
</div>
</div>
<div class="paragraph">
<p>response</p>
</div>
<div class="literalblock">
<div class="content">
<pre>HTTP/1.1 200 OK

{
    "firstName": "John",
    "groups": ["OPERATORS"],
    "entities": [],
    "lastName": "Doe",
    "login": "john-doe-operator"
}</pre>
</div>
</div>
<div class="paragraph">
<p>It&#8217;s now possible to send cards either specifically to <code>john-doe-operator</code> or more generally to the <code>OPERATORS</code> group.</p>
</div>
</div>
<div class="sect3">
<h4 id="_remove_a_user_from_a_group_or_entity"><a class="anchor" href="#_remove_a_user_from_a_group_or_entity"></a>7.2.6. Remove a user from a group (or entity)</h4>
<div class="paragraph">
<p>When John Doe is no longer in charge of hypervising cards for <code>OPERATORS</code> group, this group has to be removed from his login by using the following command:</p>
</div>
<div class="paragraph">
<p>with httpie:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>http DELETE http://localhost:2103/groups/OPERATORS/users/john-doe-operator "Authorization:Bearer $token"</pre>
</div>
</div>
<div class="paragraph">
<p>with cURL:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>curl -X DELETE -H "Authorization:Bearer $token" http://localhost:2103/groups/OPERATORS/users/john-doe-operator</pre>
</div>
</div>
<div class="paragraph">
<p>response</p>
</div>
<div class="literalblock">
<div class="content">
<pre>HTTP/1.1 200 OK

{
	"login":"john-doe-operator","
	firstName":"John",
	"lastName":"Doe",
	"groups":[],
    "entities":[]
}</pre>
</div>
</div>
<div class="paragraph">
<p>A last command to verify that <code>OPERATORS</code> is no longer linked to <code>john-doe-operator</code>:</p>
</div>
<div class="paragraph">
<p>with httpie:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>http http://localhost:2103/users/john-doe-operator "Authorization:Bearer $token" "Content-Type:application/json"</pre>
</div>
</div>
<div class="paragraph">
<p>with cURL:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>curl http://localhost:2103/users/john-doe-operator -H "Authorization:Bearer $token" -H "Content-Type:application/json"</pre>
</div>
</div>
<div class="paragraph">
<p>response</p>
</div>
<div class="literalblock">
<div class="content">
<pre>HTTP/1.1 200 OK

{
    "firstName": "John",
    "groups": [],
    "entities": [],
    "lastName": "Doe",
    "login": "john-doe-operator"

}</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_entity_parents"><a class="anchor" href="#_entity_parents"></a>7.2.7. Entity parents</h4>
<div class="paragraph">
<p>Entities have a 'parents' attribute instead of a 'perimeters' one.
This attribute is a string array.
Each element of the array is the id of another Entity.
When adding or patching an Entity into the system, operatorFabric performs a cycle detection.
On a positive cycle detection cancels the addition or the patch.</p>
</div>
<div class="sect4">
<h5 id="_add_a_new_entity_without_a_cycle_in_the_parent_declaration"><a class="anchor" href="#_add_a_new_entity_without_a_cycle_in_the_parent_declaration"></a>7.2.7.1. Add a new Entity without a cycle in the parent declaration</h5>
<div class="paragraph">
<p>using httpie:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>echo '{"id":"NEW_ENTITY","name":"Last New Entity","description":"This is the last new entity","parents": ["ENTITY1_FR"]}' \
| http POST http://localhost:2103/entities "Authorization:Bearer $token" "Content-Type:application/json"</pre>
</div>
</div>
<div class="paragraph">
<p>using cURL:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>curl http://localhost:2103/entities -H "Authorization:Bearer $token" -H "Content-Type:application/json" \
--data '{"id":"NEW_ENTITY","name":"Last New Entity","description":"This is the last new entity","parents": ["ENTITY1_FR"]}'</pre>
</div>
</div>
<div class="paragraph">
<p>response</p>
</div>
<div class="literalblock">
<div class="content">
<pre>HTTP/1.1 200 OK

{
    "id": "NEW_ENTITY",
    "parents": ["ENTITY1_FR"],
    "name": "Last New Entity",
    "description":"This is the last new entity",
    "labels":[]
}</pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_add_a_new_entity_with_a_cycle"><a class="anchor" href="#_add_a_new_entity_with_a_cycle"></a>7.2.7.2. Add a new Entity with a cycle</h5>
<div class="paragraph">
<p>For simplicity, in this example the new entity will declare itself as a parent.
This auto-referencing triggers a cycle detection.</p>
</div>
<div class="paragraph">
<p>using httpie:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>echo '{"id":"NEW_ENTITY","name":"Last New Entity","description":"This is the last new entity","parents": ["NEW_ENTITY"]}' | http POST http://localhost:2103/entities "Authorization:Bearer $token" "Content-Type:application/json"</pre>
</div>
</div>
<div class="paragraph">
<p>using cURL:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>curl http://localhost:2103/entities -H "Authorization:Bearer $token" -H "Content-Type:application/json" --data '{"id":"NEW_ENTITY","name":"Last New Entity","description":"This is the last new entity","parents": ["NEW_ENTITY"]}'</pre>
</div>
</div>
<div class="paragraph">
<p>response</p>
</div>
<div class="literalblock">
<div class="content">
<pre>{
    "status":"BAD_REQUEST",
    "message":"A cycle has been detected: NEW_ENTITY-&gt;NEW_ENTITY"
}</pre>
</div>
</div>
<div class="paragraph">
<p>with a <code>400</code> as http status return.</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_service_port_table"><a class="anchor" href="#_service_port_table"></a>8. Service port table</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Port</th>
<th class="tableblock halign-left valign-top">Service</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">89</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">KeyCloak</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">KeyCloak api port</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2002</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">web-ui</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Web ui and gateway  (Nginx server)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2100</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">businessconfig</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Businessconfig management service http (REST)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2102</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">cards-publication</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Cards publication service http (REST)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2103</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">users</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Users management service http (REST)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2104</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">cards-consultation</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Cards consultation service http (REST)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2105</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">external-devices</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">External devices management service http (REST)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2106</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">cards-external-diffusion</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Mail notification service http (REST)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2107</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">cards-reminder</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Cards reminder service http (REST)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2108</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">supervisor</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Supervisor service http (REST)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">27017</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">mongo</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Mongo api port</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">5672</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">rabbitmq</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Amqp api port</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">15672</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">rabbitmq</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Rabbitmq api port</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1025</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">MailHog</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">MailHog SMTP port (for testing only)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">8025</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">MailHog</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">MailHog web UI and API http (REST) (for testing only)</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect1">
<h2 id="_rate_limiter_for_card_sending"><a class="anchor" href="#_rate_limiter_for_card_sending"></a>9. Rate limiter for card sending</h2>
<div class="sectionbody">
<div class="paragraph">
<p>External publishers are monitored by this module which limits how many cards they can send
<a href="/documentation/current/deployment/.html#cardSendingLimitCardCount"><code>cardSendingLimitCardCount</code></a>
 in a period of time
<a href="/documentation/current/deployment/.html#cardSendingLimitPeriod"><code>cardSendingLimitPeriod</code></a>
.
This is to avoid potential overloading due to external apps stuck in a card sending loop.
It can be disabled / enabled with
<a href="/documentation/current/deployment/.html#activateCardSendingLimiter"><code>activateCardSendingLimiter</code></a>
.
It is also possible to reset the data of the limiter by calling the API through the "/cards/rateLimiter" endpoint (e.g.
POST "$url:2102/cards/rateLimiter" -H "Authorization:Bearer $token").</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_restricted_operations_administration"><a class="anchor" href="#_restricted_operations_administration"></a>10. Restricted operations (administration)</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Some operations are restricted to users with administrative roles, either because they are administration
operations with the potential to impact the OperatorFabric instance as a whole, or because they
give access to information that should be private to a user.</p>
</div>
<div class="paragraph">
<p>Below is a quick recap of these restricted operations.</p>
</div>
<div class="paragraph">
<div class="title">Users Service</div>
<p>Any action (read, create/update or delete) regarding a single user&#8217;s data (their personal info such as their first and
last name, as well as their settings) can be performed either by the user in question or by a user with the ADMIN role.</p>
</div>
<div class="paragraph">
<p>Any action on users, groups, entities or perimeters lists (if authorization is managed in OperatorFabric) is restricted to users with the ADMIN role.</p>
</div>
<div class="paragraph">
<p>Access to users action logs information is restricted to users with ADMIN role or VIEW_USER_ACTION_LOGS role.</p>
</div>
<div class="paragraph">
<div class="title">Businessconfig Service</div>
<p>Any write (create, update or delete) action on bundles can only be performed by a user with the ADMIN role or ADMIN_BUSINESS_PROCESS role. As such,
administrators are responsible for the quality and security of the provided bundles.
In particular, as it is possible to use scripts in templates, they should perform a security check to make sure that
there is no XSS risk.</p>
</div>
<div class="paragraph">
<div class="title">Cards consultation Service</div>
<p>Users holding the ADMIN role are authorized to read all archived cards, regardless of the card&#8217;s sender, recipients, or the user&#8217;s assigned perimeters
IMPORTANT: The ADMIN role doesn&#8217;t grant any special privileges when it comes to current cards consultation so a user with the ADMIN role will only receive cards that have been addressed to them (or to one of their
groups or entities), just like any other user.</p>
</div>
<div class="paragraph">
<div class="title">External devices service</div>
<p>Any action (read, create/update or delete) on external devices configuration is restricted to users with th ADMIN role.</p>
</div>
</div>
</div>
</div>
</body>
</html>