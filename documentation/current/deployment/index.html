<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.8">
<title>Deployment and Administration of OperatorFabric</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/* Asciidoctor default stylesheet | MIT License | http://asciidoctor.org */
/* Uncomment @import statement below to use as custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section,summary{display:block}
audio,canvas,video{display:inline-block}
audio:not([controls]){display:none;height:0}
script{display:none!important}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
a{background:transparent}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*::before,*::after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto;tab-size:4;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:none}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite::before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt,table tr:nth-of-type(even){background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
*:not(pre)>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background-color:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed;word-wrap:break-word}
*:not(pre)>code.nobreak{word-wrap:normal}
*:not(pre)>code.nowrap{white-space:nowrap}
pre,pre>code{line-height:1.45;color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;text-rendering:optimizeSpeed}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background-color:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background-color:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:100%;background-color:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock pre:not(.highlight),.listingblock pre[class="highlight"],.listingblock pre[class^="highlight "],.listingblock pre.CodeRay,.listingblock pre.prettyprint{background:#f7f7f8}
.sidebarblock .literalblock pre,.sidebarblock .listingblock pre:not(.highlight),.sidebarblock .listingblock pre[class="highlight"],.sidebarblock .listingblock pre[class^="highlight "],.sidebarblock .listingblock pre.CodeRay,.sidebarblock .listingblock pre.prettyprint{background:#f2f1f1}
.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:1em}}
.literalblock pre.nowrap,.literalblock pre.nowrap pre,.listingblock pre.nowrap,.listingblock pre.nowrap pre{white-space:pre;word-wrap:normal}
.literalblock.output pre{color:#f7f7f8;background-color:rgba(0,0,0,.9)}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:#999}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:#999}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
table.pyhltable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.pyhltable td{vertical-align:top;padding-top:0;padding-bottom:0;line-height:1.45}
table.pyhltable td.code{padding-left:.75em;padding-right:0}
pre.pygments .lineno,table.pyhltable td:not(.code){color:#999;padding-left:0;padding-right:.5em;border-right:1px solid #dddddf}
pre.pygments .lineno{display:inline-block;margin-right:.25em}
table.pyhltable .linenodiv{background:none!important;padding-right:0!important}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt,.quoteblock .quoteblock{margin:0 0 1.25em;padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;text-align:left;margin-right:0}
table.tableblock{max-width:100%;border-collapse:separate}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>thead>tr>.tableblock,table.grid-all>tbody>tr>.tableblock{border-width:0 1px 1px 0}
table.grid-all>tfoot>tr>.tableblock{border-width:1px 1px 0 0}
table.grid-cols>*>tr>.tableblock{border-width:0 1px 0 0}
table.grid-rows>thead>tr>.tableblock,table.grid-rows>tbody>tr>.tableblock{border-width:0 0 1px}
table.grid-rows>tfoot>tr>.tableblock{border-width:1px 0 0}
table.grid-all>*>tr>.tableblock:last-child,table.grid-cols>*>tr>.tableblock:last-child{border-right-width:0}
table.grid-all>tbody>tr:last-child>.tableblock,table.grid-all>thead:last-child>tr>.tableblock,table.grid-rows>tbody>tr:last-child>.tableblock,table.grid-rows>thead:last-child>tr>.tableblock{border-bottom-width:0}
table.frame-all{border-width:1px}
table.frame-sides{border-width:0 1px}
table.frame-topbot,table.frame-ends{border-width:1px 0}
table.stripes-all tr,table.stripes-odd tr:nth-of-type(odd){background:#f8f8f7}
table.stripes-none tr,table.stripes-odd tr:nth-of-type(even){background:none}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
td>div.verse{white-space:pre}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{margin-right:.25em}
ul.inline{display:-ms-flexbox;display:-webkit-box;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background-color:#00fafa}
.black{color:#000}
.black-background{background-color:#000}
.blue{color:#0000bf}
.blue-background{background-color:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background-color:#fa00fa}
.gray{color:#606060}
.gray-background{background-color:#7d7d7d}
.green{color:#006000}
.green-background{background-color:#007d00}
.lime{color:#00bf00}
.lime-background{background-color:#00fa00}
.maroon{color:#600000}
.maroon-background{background-color:#7d0000}
.navy{color:#000060}
.navy-background{background-color:#00007d}
.olive{color:#606000}
.olive-background{background-color:#7d7d00}
.purple{color:#600060}
.purple-background{background-color:#7d007d}
.red{color:#bf0000}
.red-background{background-color:#fa0000}
.silver{color:#909090}
.silver-background{background-color:#bcbcbc}
.teal{color:#006060}
.teal-background{background-color:#007d7d}
.white{color:#bfbfbf}
.white-background{background-color:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background-color:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background-color:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background-color:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media print,amzn-kf8{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
</head>
<body class="article toc2 toc-left">
<div id="header">
<h1>Deployment and Administration of OperatorFabric</h1>
<div class="details">
<span id="revnumber">version 1.2.0.RELEASE,</span>
<span id="revdate">17 April 2020</span>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_deployment">1. Deployment</a></li>
<li><a href="#custom_certificates">2. Adding certification authorities or certificates to the Java keystore</a></li>
<li><a href="#_rabbitmq">3. RabbitMQ</a>
<ul class="sectlevel2">
<li><a href="#_docker_container">3.1. Docker container</a></li>
<li><a href="#_server_installation">3.2. Server installation</a>
<ul class="sectlevel3">
<li><a href="#_download_installation">3.2.1. Download &amp; Installation</a></li>
<li><a href="#_used_ports">3.2.2. Used ports</a></li>
<li><a href="#_production_configuration">3.2.3. Production configuration</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_configuration">4. Configuration</a>
<ul class="sectlevel2">
<li><a href="#_global_configuration">4.1. Global configuration</a></li>
<li><a href="#_operatorfabric_mongo_configuration">4.2. OperatorFabric Mongo configuration</a>
<ul class="sectlevel3">
<li><a href="#_define_time_to_live_for_archived_cards">4.2.1. Define time to live for archived cards</a></li>
</ul>
</li>
<li><a href="#opfab_spec_conf">4.3. OperatorFabric Specific configuration</a>
<ul class="sectlevel3">
<li><a href="#_security_configuration">4.3.1. Security Configuration</a></li>
<li><a href="#_user_creation">4.3.2. User creation</a></li>
<li><a href="#_alternative_way_to_manage_groups">4.3.3. Alternative way to manage groups</a></li>
</ul>
</li>
<li><a href="#_service_specific_configuration">4.4. Service-specific configuration</a>
<ul class="sectlevel3">
<li><a href="#_actions_business_service">4.4.1. Actions Business service</a></li>
<li><a href="#_cards_consultation_business_service">4.4.2. Cards-Consultation Business service</a></li>
<li><a href="#_cards_publication_business_service">4.4.3. Cards-Publication Business service</a></li>
<li><a href="#cloud_gateway_service_config">4.4.4. Cloud Gateway service</a></li>
<li><a href="#cloud_config_service_config">4.4.5. Cloud Configuration service</a></li>
<li><a href="#cloud_registry_service_config">4.4.6. Cloud Registry service</a></li>
<li><a href="#_thirds_business_service">4.4.7. Thirds Business service</a></li>
<li><a href="#_users_business_service">4.4.8. Users Business service</a></li>
<li><a href="#_web_ui">4.4.9. Web UI</a></li>
</ul>
</li>
<li><a href="#_users_and_groups_administration">4.5. Users and Groups Administration</a>
<ul class="sectlevel3">
<li><a href="#_list_all_users">4.5.1. List all users</a></li>
<li><a href="#_create_a_new_user">4.5.2. Create a new User</a></li>
<li><a href="#_fetch_user_details">4.5.3. Fetch user details</a></li>
<li><a href="#_update_user_details">4.5.4. Update user details</a></li>
<li><a href="#_list_groups">4.5.5. List groups</a></li>
<li><a href="#_create_a_new_group">4.5.6. Create a new Group</a></li>
<li><a href="#_fetch_details_of_a_given_group">4.5.7. Fetch details of a given group</a></li>
<li><a href="#_update_details_of_a_group">4.5.8. Update details of a group</a></li>
<li><a href="#_add_a_user_to_a_group">4.5.9. Add a user to a group</a></li>
<li><a href="#_remove_a_user_from_a_group">4.5.10. Remove a user from a Group</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_service_port_table">5. Service port table</a></li>
<li><a href="#_restricted_operations_administration">6. Restricted operations (administration)</a></li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>The aim of this document is to explain how to configure and deploy OperatorFabric.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_deployment">1. Deployment</h2>
<div class="sectionbody">
<div class="paragraph">
<p>For now OperatorFabric consist of Docker images available either by compiling
the project or by using images releases from <a href="https://hub.docker.com/">Dockerhub</a></p>
</div>
<div class="paragraph">
<p>Service images are all based on <a href="https://hub.docker.com/_/openjdk">openjdk:8-jdk-alpine</a>.</p>
</div>
<div class="paragraph">
<p>For simple one instance per service deployment, you can find a sample
deployment as a docker-compose file
<a href="https://github.com/opfab/operatorfabric-core/tree/master/src/main/docker/deploy">here</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="custom_certificates">2. Adding certification authorities or certificates to the Java keystore</h2>
<div class="sectionbody">
<div class="paragraph">
<p>If you&#8217;re using certificates (for example for Keycloak) that are not from a certification authority trusted by the JVM,
this will cause errors such as this one:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../images/certificate_error.png" alt="Missing certificate error message">
</div>
</div>
<div class="paragraph">
<p>If that is the case, you can pass the additional authorities or certificates that you use to the containers at runtime.</p>
</div>
<div class="paragraph">
<p>To do so, put the relevant files (*.der files for example) under <strong>src/main/docker/certificates</strong>.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>This directory should only contain the files to be added to the keystore.</p>
</li>
<li>
<p>The files can be nested inside directories.</p>
</li>
<li>
<p>Each certificate will be added with its filename as alias. For example, the certificate in file mycertificate.der
will be added under alias <strong>mycertificate</strong>. As a consequence, filenames should be unique or it will cause an error.</p>
</li>
<li>
<p>If you need to add or remove certificates while the container is already running, the container will have to be
restarted for the changes to be taken into account.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>If you would like certificates to be sourced from a different location, replace the volumes declarations in the deploy
docker-compose.yml file with the selected location:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>volumes:
 - "path/to/my/selected/location:/certificates_to_add"</pre>
</div>
</div>
<div class="paragraph">
<p>instead of</p>
</div>
<div class="literalblock">
<div class="content">
<pre>volumes:
 - "../../../../src/main/docker/certificates:/certificates_to_add"</pre>
</div>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
The steps described here assume you&#8217;re running OperatorFabric in docker mode using the deploy docker-compose,
but they can be adapted for single container deployments and development mode.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If you want to check that the certificates were correctly added, you can do so with the following steps:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Open a bash shell in the container you want to check</p>
<div class="literalblock">
<div class="content">
<pre>docker exec -it deploy_thirds_1 bash</pre>
</div>
</div>
</li>
<li>
<p>Run the following command</p>
<div class="literalblock">
<div class="content">
<pre>$JAVA_HOME/bin/keytool -list -v -keystore /tmp/cacerts -storepass changeit</pre>
</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>You can also look at the default list of authorities and certificates trusted by the JVM with this command:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$JAVA_HOME/bin/keytool -list -v -keystore $JAVA_HOME/jre/lib/security/cacerts -storepass changeit</pre>
</div>
</div>
<div class="paragraph">
<p>To run OperatorFabric in development mode, see
<a href="../../../../documentation/current/dev_env/index.html#dev_env">the development environment documentation</a>
.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_rabbitmq">3. RabbitMQ</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_docker_container">3.1. Docker container</h3>
<div class="paragraph">
<p>In development mode, the simplest way to deploy a RabbitMQ server is to
create a RabbitMQ docker container. A <a href="https://github.com/opfab/operatorfabric-core/tree/master/src/main/docker/rabbitmq">docker-compose file</a> is provided to allow quick setup of a convenient RabbitMQ
 server.</p>
</div>
</div>
<div class="sect2">
<h3 id="_server_installation">3.2. Server installation</h3>
<div class="paragraph">
<p>This section is dedicated to production deployment of RabbitMQ. It is
 not complete and needs to be tailored to any specific production
 environment.</p>
</div>
<div class="sect3">
<h4 id="_download_installation">3.2.1. Download &amp; Installation</h4>
<div class="paragraph">
<p>Download and install RabbitMQ following the
<a href="https://www.rabbitmq.com/download.html">official procedure</a> for the
target environment</p>
</div>
</div>
<div class="sect3">
<h4 id="_used_ports">3.2.2. Used ports</h4>
<div class="paragraph">
<p>If RabbitMQ may not bind to the following ports, it won&#8217;t start :</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>4369</strong>: epmd, a peer discovery service used by RabbitMQ nodes and
CLI tools</p>
</li>
<li>
<p><strong>5672, 5671</strong>: used by AMQP 0-9-1 and 1.0 clients without and with
TLS</p>
</li>
<li>
<p><strong>25672</strong>: used for inter-node and CLI tools communication
(Erlang distribution server port) and is allocated from a dynamic range
(limited to a single port by default, computed as AMQP port + 20000).
Unless external connections on these ports are really necessary
(e.g. the cluster uses federation or CLI tools are used on machines
outside the subnet), these ports should not be publicly exposed. See
networking guide for details.</p>
</li>
<li>
<p><strong>35672-35682</strong>: used by CLI tools (Erlang distribution client ports)
for communication with nodes and is allocated from a dynamic range
(computed as server distribution port + 10000 through server
distribution port + 10010). See networking guide for details.</p>
</li>
<li>
<p><strong>15672</strong>: HTTP API clients, management UI and rabbitmqadmin (<strong>only if
the management plugin is enabled</strong>)</p>
</li>
<li>
<p><strong>61613, 61614</strong>: STOMP clients without and with TLS
(<strong>only if the STOMP plugin is enabled</strong>)</p>
</li>
<li>
<p><strong>1883, 8883</strong>: (MQTT clients without and with TLS,
<em>if the MQTT plugin is enabled</em>)</p>
</li>
<li>
<p><strong>15674</strong>: STOMP-over-WebSockets clients
(<strong>only if the Web STOMP plugin is enabled</strong>)</p>
</li>
<li>
<p><strong>15675</strong>: MQTT-over-WebSockets clients
(<strong>only if the Web MQTT plugin is enabled</strong>)</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_production_configuration">3.2.3. Production configuration</h4>
<div class="paragraph">
<p>See the <a href="https://www.rabbitmq.com/production-checklist.html">guide</a> for
production configuration guidelines</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_configuration">4. Configuration</h2>
<div class="sectionbody">
<div class="paragraph">
<p>OperatorFabric has multiple services to configure. These configurations are managed by a Configuration Service, of which
they can be several instances to ensure availability.</p>
</div>
<div class="paragraph">
<p><a href="#../../../../documentation/current/architecture/index.adoc">architecture documentation</a>
for more information on the different services.</p>
</div>
<div class="paragraph">
<p>All services are SpringBoot applications and use jetty as an embedded servlet container. As such, they share some common
configuration which is described in the following documentation:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://docs.spring.io/spring-boot/docs/2.1.2.RELEASE//reference/htmlsingle/">Springboot documentation</a></p>
</li>
<li>
<p><a href="https://docs.spring.io/spring-boot/docs/2.1.2.RELEASE//reference/htmlsingle/#boot-features-external-config">Springboot external configuration</a></p>
</li>
<li>
<p><a href="https://docs.spring.io/spring-boot/docs/2.1.2.RELEASE//reference/htmlsingle/#common-application-properties">Common application properties from Springboot documentation</a></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_global_configuration">4.1. Global configuration</h3>
<div class="paragraph">
<p>Aside from the one for the configuration service, all configurations are gathered as resources in the
configuration service (under /services/infra/config/src/main/docker/volume).</p>
</div>
<div class="paragraph">
<p>Note that a few things cannot be set in the configuration served by the configuration service (because its needed
right at the application startup for example) and
must be set in each services bootstrap configuration file. In this regard,
<a href="../../../../deployment/index.html#cloud_config_service_config">Cloud Configuration Service</a>
and
<a href="../../../../deployment/index.html#cloud_registry_service_config">Cloud Registry Service</a>
services have specific configuration but for other services, they all require
the same minimal information:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>mandatory</strong> service name(spring.application.name)</p>
</li>
<li>
<p><strong>mandatory</strong> configuration name (spring.cloud.config.name)</p>
</li>
<li>
<p><strong>mandatory</strong> configuration fetch from registry enabled (spring.cloud.config.discovery.enabled: true)</p>
</li>
<li>
<p><strong>mandatory</strong> configuration service name in registry (spring.cloud.config.discovery.service-id)</p>
</li>
<li>
<p><strong>mandatory</strong> eureka registration (eureka.client.register-with-eureka: true and
eureka.client.fetch-registry: true)</p>
</li>
<li>
<p><strong>mandatory</strong> eureka registry urls (eureka.client.service-url.defaultZone)</p>
</li>
<li>
<p>configuration fail fast (spring.cloud.config.fail-fast)</p>
</li>
<li>
<p>configuration fetch maximum retry (spring.cloud.config.retry.max-attempts)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In most situation, you do not need to change the default bootstrap
configuration for those services. Make a copy of the default bootstrap (inside
the jar or from the sources) and set eureka up (see above).</p>
</div>
<div class="paragraph">
<p>The different services also share common configuration you can setup in the
config service backend. those common configuration may be set up in the backend <code><code>application.yml</code></code> file.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>spring:
  rabbitmq:
    host: rabbitmq
    port: 5672
    username: guest
    password: guest
  data:
    mongodb:
      uris:
        - mongodb://root:password@mongodb:27017/operator-fabric?authSource=admin&amp;authMode=scram-sha1
  security:
    oauth2:
      resourceserver:
        jwt:
          jwk-set-uri: http://authserver/auth/realms/dev/protocol/openid-connect/certs
eureka:
  client:
    service-url:
      defaultZone: http://registry:8080/eureka
    region: default
  registryFetchIntervalSeconds: 5

operatorfabric:
  security:
    oauth2:
      client-id: opfab-client
      client-secret: opfab-oauth-secret
    jwt:
      login-claim: preferred_username
      expire-claim: exp</code></pre>
</div>
</div>
<div class="paragraph">
<p>In the above example you can see that we need to configure:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>RabbitMQ (See <a href="https://docs.spring.io/spring-amqp/docs/2.1.3.RELEASE/reference/htmlsingle//reference/htmlsingle/">spring-amqp doc</a>)</p>
</li>
<li>
<p>MongoDB</p>
</li>
<li>
<p>Eureka (See <a href="https://cloud.spring.io/spring-cloud-static/spring-cloud-netflix/2.1.0.RC3//single/spring-cloud-netflix.html#_service_discovery_eureka_clients">spring eureka</a>)</p>
</li>
<li>
<p>OperatorFabric</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_operatorfabric_mongo_configuration">4.2. OperatorFabric Mongo configuration</h3>
<div class="paragraph">
<p>We only use URI configuration for mongo through the usage of the <code><code>spring.data.mongodb.uris</code></code>,
it allows us to share the same configuration behavior for simple or cluster
configuration and with both spring classic and reactive mongo configuration.
See <a href="https://docs.mongodb.com/manual/reference//connection-string/">mongo connection string</a> for the complete URI syntax.</p>
</div>
<div class="sect3">
<h4 id="_define_time_to_live_for_archived_cards">4.2.1. Define time to live for archived cards</h4>
<div class="paragraph">
<p>By default, archived cards will remain stored in the database forever. It is possible to have them automatically
removed after a specified duration by using the <a href="https://docs.mongodb.com/manual/core/index-ttl/">TTL index feature of mongoDB</a> on their publishDate field.</p>
</div>
<div class="paragraph">
<p>For example, to have cards expire after 10 days (864000s), enter the following commands in the mongo shell:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">use operator-fabric
db.archivedCards.createIndex( { "publishDate": 1 }, { expireAfterSeconds: 864000 } )</code></pre>
</div>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
You cannot use createIndex() to change the value of expireAfterSeconds of an existing index.
Instead use the <a href="https://docs.mongodb.com/manual/reference/command/collMod/#dbcmd.collMod">collMod</a> database command in conjunction with the index collection flag. Otherwise, to
change the value of the option of an existing index, you must drop the index first and recreate.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="opfab_spec_conf">4.3. OperatorFabric Specific configuration</h3>
<div class="paragraph">
<p>Below are description of OperatorFabric specific configuration properties.</p>
</div>
<div class="paragraph">
<p>Note that other components may have specific configuration, see the relevant
sub-sections.</p>
</div>
<div class="sect3">
<h4 id="_security_configuration">4.3.1. Security Configuration</h4>
<div class="sect4">
<h5 id="_common_configuration">Common configuration</h5>
<div class="paragraph">
<p>This concern is configured within the <code>${OF_HOME}/services/infra/config</code> project
into 3 distinct files:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>application.yml</code>;</p>
</li>
<li>
<p><code>web-ui.yml</code>;</p>
</li>
<li>
<p><code>client-gateway.yml</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>They are located into the following folders within the <code>${OF_HOME}/services/infra/config/java/src/main/docker/volume</code> folder:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>dev-configurations</code>: to be use into <code>dev</code> mode;</p>
</li>
<li>
<p><code>docker-configurations</code>: used by docker at run time.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>EXAMPLE: the configuration for <code>dev</code>before compilation is done in the following files:
    - <code>${OF_HOME}/services/infra/config/java/src/main/docker/volume/dev-configurations/application.yml</code>;
    - <code>${OF_HOME}/services/infra/config/java/src/main/docker/volume/dev-configurations/client-gateway.ym</code>;
    - <code>${OF_HOME}/services/infra/config/java/src/main/docker/volume/dev-configurations/web-ui.yml</code>.</p>
</div>
<div class="paragraph">
<p>For test purposes in <code>dev</code>mode, it&#8217;s possible to edit files located into <code>`${OF_HOME}/services/infra/config/build/docker-volume/dev-configurations</code>.
Be aware that those changes will be lost after a new compilation or even a simple re-run of the project.</p>
</div>
<div class="paragraph">
<p>This configuration files follow the <code>springframework</code> configuration convention. Within a same file it&#8217;s possible to
use <code><a href="https://docs.spring.io/spring/docs/current/spring-framework-reference/core.html#expressions">SpEL ${}</a></code> convention. For example,  <code>${AnotheProperty}</code> allows to re-use the value of <code>AnotherProperty</code> already declared.
It helps to avoid typos or missing to report some changes. An example could be find below into the <code>delegate-url</code> property.</p>
</div>
<div class="sect5">
<h6 id="_application_yml">application.yml</h6>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">name</th>
<th class="tableblock halign-left valign-top">default</th>
<th class="tableblock halign-left valign-top">mandatory?</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.security.oauth2.client-id</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">null</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Oauth2 client id used by OperatorFabric may be specific for each service</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.security.oauth2.client-secret</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">null</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Oauth2 client secret used by OperatorFabric may be specific for each service</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.security.jwt.login-claim</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">sub</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Jwt claim is used as user login or id</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.security.jwt.expire-claim</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">exp</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Jwt claim is used as token expiration timestamp</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">spring.security.oauth2.resourceserver.jwt.provider-url</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">null</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The keycloak instance url</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">spring.security.oauth2.resourceserver.jwt.provider-realm</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">null</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The realm name within the keycloak instance</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>example of <code>application.yml</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>operatorfabric:
    security:
        oauth2:
            client-id: opfab-client
            client-secret: opfab-keycloak-secret
        jwt:
            login-claim: preferred_username
            expire-claim: exp</code></pre>
</div>
</div>
<div class="paragraph">
<p>where <code>operatorfabric.security.jwt.expire-claim</code> could have been omitted because having the same value as the default one.</p>
</div>
</div>
<div class="sect5">
<h6 id="_client_gateway_yml">client-gateway.yml</h6>

</div>
<div class="sect5">
<h6 id="_filters_and_cors_configuration">Filters and CORS configuration</h6>
<div class="sect6">
<h7 id="_authentication_server">Authentication Server</h7>
<div class="paragraph">
<p>In the configuration service <code>client-gateway.yml</code> file:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The application must set up a route to the oauth server</p>
<div class="ulist">
<ul>
<li>
<p><code>/auth/token(?&lt;path&gt;.*)</code>: must match the oauth2 token entry point;</p>
</li>
<li>
<p><code>/auth/code/(?&lt;params&gt;.*)</code>: must match the auth entry point with specific query
parameters like <code>response_type=code&amp;client_id=[client id]&amp;${params}</code>;</p>
</li>
<li>
<p><code>/auth/check_token</code>: must match token introspection entry point</p>
</li>
</ul>
</div>
</li>
<li>
<p>The application must add request header for each request:</p>
<div class="ulist">
<ul>
<li>
<p><code>AddRequestHeader: Authorization, Basic</code>: followed, separated with a space, by the <code>OAuth2 client-id</code> and the <code>OAuth2 client-secret</code> encoded in base64.</p>
</li>
</ul>
</div>
</li>
<li>
<p>The application may set up CORS rules if api are to be accessed from browser outside of
the deployment domain</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Configuration example of the filters, for the docker dev keycloak:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>spring.cloud.gateway.routes[0].filters:
        - RewritePath=/auth/token(?&lt;path&gt;.*), /auth/realms/dev/protocol/openid-connect/token$\{path}
        - RewritePath=/auth/code/(?&lt;params&gt;.*), /auth/realms/dev/protocol/openid-connect/auth?response_type=code&amp;client_id=opfab-client&amp;$\{params}
        - RewritePath=/auth/check_token, /auth/realms/dev/protocol/openid-connect/token/introspect
        - AddRequestHeader=Authorization, Basic b3BmYWItY2xpZW50Om9wZmFiLWtleWNsb2FrLXNlY3JldA==</code></pre>
</div>
</div>
<div class="paragraph">
<p>where:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>spring.cloud.gateway.routes.uri</code>: is your keycloak instance</p>
</li>
<li>
<p><code>spring.cloud.gateway.routes[0]</code> is the routes with <code>id</code> equals to <code>auth</code>;</p>
</li>
<li>
<p><code>/realms/dev</code>: is the keycloakrealm where <code>opfab-client</code> is defined.</p>
</li>
<li>
<p><code>b3BmYWItY2xpZW50Om9wZmFiLWtleWNsb2FrLXNlY3JldA==</code>: is the base64 encoded string of <code>opfab-client:opfab-keycloak-secret</code> with
<code>opfab-client</code> as client-id and <code>opfab-keycloak-secret</code> its client secret.</p>
</li>
</ul>
</div>
</div>
<div class="sect6">
<h7 id="_action_service">Action Service</h7>
<div class="paragraph">
<p>In the  configuration service <code>client-gateway.yml</code> file, the application must set up the <code>URI</code> of the <code>Action Service</code>.</p>
</div>
<div class="paragraph">
<p>To do so, the <code>spring.cloud.gateway.routes.id="action".uri</code> property is set with the actual value of this service.</p>
</div>
<div class="paragraph">
<p>In the case of a development set-up, this value is <code><a href="http://localhost:2105" class="bare">localhost:2105</a></code> where <code>2105</code>
is the default port as set in the <code>application.yml</code>used by the <code>Action service</code> as configuration.</p>
</div>
<div class="paragraph">
<p><code>client-gateway.yml</code> of the <code>dev-configuration</code> as example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>spring:
  cloud:
    gateway:
      routes:
      - id: actions
        uri: http://localhost:2105
        predicates:
        - Path=/actions/**
        filters:
        - RewritePath=/actions/(?&lt;path&gt;.*), /$\{path}</code></pre>
</div>
</div>
<div class="paragraph">
<p>As explained earlier, the key to configure is <code>uri</code> of the <code>spring.cloud.gateway.routes</code> with the <code>id</code>
equals to <code>actions</code>.</p>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_web_ui_yml">web-ui.yml</h6>
<div class="paragraph">
<p>For OAuth2 security concerns into this file, there are two way to configure it, based on the Oauth2 chosen flow.
There are two common properties:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>operatorfabric.security.oauth2.flow.provider</code> which corresponds to the OAuth2 provider.</p>
</li>
<li>
<p><code>operatorfabric.security.realm-url</code>: which is the OAuth2 realm provider under which the OpertaroFabric client is declared.</p>
</li>
<li>
<p><code>operatorfabric.security.provider-url</code>: which is the The keycloak server instance.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_oauth2_flows_and_specific_configuration">OAuth2 Flows and specific configuration</h5>
<div class="paragraph">
<p>There are 3 OAuth2 Authentication flows available into OperatorFabric UI:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>password grant: referred as PASSWORD mode flow;</p>
</li>
<li>
<p>code flow : referred as  CODE mode flow;</p>
</li>
<li>
<p>implicit flow: referred as IMPLICIT mode flow.</p>
</li>
</ul>
</div>
<div class="sect5">
<h6 id="_oauth2_implicit_flow">OAuth2 IMPLICIT Flow</h6>
<div class="paragraph">
<p>It had its own way of configuration.
To enable IMPLICIT Flow authentication the following properties need to be set:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>operatorfabric.security.oauth2.flow.mode</code> to <code>IMPLICIT</code>;</p>
</li>
<li>
<p><code>operatorfabric.security.oauth2.flow.delegate-url</code> with the URL of the OAuth2 leading to the <code>.well-known/openid-configuration</code> end-point used for authentication configuration.</p>
</li>
</ul>
</div>
<div class="sect6">
<h7 id="_example_of_keycloak_configuration_for_operatorfabric_oauth2">Example of Keycloak configuration for OperatorFabric OAuth2</h7>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>operatorfabric:
  keycloak:
    realm: dev
  security:
    oauth2:
      flow:
        mode: IMPLICIT
        provider: Opfab Keycloak
        delagate-url: http://localhost:89/auth/realms/${operatorfabric.keycloak.realm}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Within the <code>delegate-url</code> property the <code>${operatorfabric.keycloak.realm}</code> refers to the value of the <code>operatorfabric.keycloak.realm</code> declared earlier, <code>dev</code> here.
For keycloak instance used for dev purposes, this <code>delegate-url</code> correspond to the realm under which the client <code>opfab-client</code> is registred. The
url look up by the implicit ui mechanism is <code><a href="http://localhost:89/auth/realms/dev/.well-known/openid-configuration" class="bare">localhost:89/auth/realms/dev/.well-known/openid-configuration</a></code>.</p>
</div>
</div>
<div class="sect6">
<h7 id="_keycloak_instance_additional_configuration_for_dev_purposes">Keycloak instance additional configuration for dev purposes</h7>
<div class="paragraph">
<p>Once connected as Admin (login:_admin_,password:_admin_ ) on keycloak (<code><a href="http://localhost:89/auth/admin" class="bare">localhost:89/auth/admin</a></code>) The first thing is to enable the implicit flow for <code>opfa-client</code>. To do so
select <code>Dev</code> in the upper select of the right panel then click on Clients. In the table, click on <code>opfab-client</code> in the column <code>Client ID</code>. Then in the <code>Settings</code> tabs turn on the
<code>Implicit Flow Enabled</code>. In the same tab, modify <code><a href="http://localhost:2002/ui/" class="bare">localhost:2002/ui/</a></code> to <code><a href="http://localhost:2002/" class="bare">localhost:2002/</a><strong></code> and <code><a href="http://localhost:4200" class="bare">localhost:4200</a></code> to <code><a href="http://localhost:4200/" class="bare">localhost:4200/</a></strong></code>.</p>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_oauth2_password_or_code_flows">OAuth2 PASSWORD or CODE Flows</h6>
<div class="paragraph">
<p>These two modes share the same way of declaring the delegate URL. The default configuration for dev is set to <code>CODE</code> and work straight away.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>operatorfabric.security.oauth2.flow.mode</code> to <code>PASSWORD</code> or <code>CODE</code>;</p>
</li>
<li>
<p><code>operatorfabric.security.oauth2.flow.delegate-url</code> with the URL of the OAuth2 leading to the protocol used for authentication.</p>
</li>
</ul>
</div>
<div class="sect6">
<h7 id="_example_of_keycloak_configuration_for_operatorfabric_oauth2_2">Example of Keycloak Configuration For OperatorFabric OAuth2</h7>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>operatorfabric:
  keycloak:
    realm: dev
  security:
    oauth2:
      flow:
        mode: CODE
        provider: Opfab Keycloak
        delagate-url: http://localhost:89/auth/realms/${operatorfabric.keycloak.realm}/protocol/openid-connect/auth?response_type=code&amp;client_id=opfab-client</code></pre>
</div>
</div>
<div class="paragraph">
<p>Within the <code>delegate-url</code> property the <code>${operatorfabric.keycloak.realm}</code> refers to the value(also <code>dev</code> here) of the <code>operatorfabric.keycloak.realm</code> declared earlier.
Here, the <code>client-id</code> value is <code>opfab-client</code> which is define as client under the <code>realm</code> named dev on the dev keycloak instance.</p>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_using_token">Using token</h5>
<div class="sect5">
<h6 id="_get_a_token">Get a token</h6>
<div class="paragraph">
<p>End point: <code><a href="http://localhost:2002/auth/token" class="bare">localhost:2002/auth/token</a></code></p>
</div>
<div class="paragraph">
<p>Method: <code>POST</code></p>
</div>
<div class="paragraph">
<p>Body arguments:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>client_id: <code>string</code> constant=<code>clientIdPassword</code>;</p>
</li>
<li>
<p>grant_type: <code>string</code> constant=<code>password</code>;</p>
</li>
<li>
<p>username: <code>string</code> any value, must match an OperatorFabric registered user
name;</p>
</li>
<li>
<p>password: <code>string</code> any value;</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following examples will be for <code>admin</code> user.</p>
</div>
<div class="sect6">
<h7 id="_curl">Curl</h7>
<div class="paragraph">
<p>command:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>curl -s -X POST -d
"username=admin&amp;password=test&amp;grant_type=password&amp;client_id=clientIdPassword"
http://localhost:2002/auth/token</pre>
</div>
</div>
<div class="paragraph">
<p>example of expected result:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>{"access_token":"eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJhZG1pbiIsImV4cC
I6MTU1MjY1OTczOCwiYXV0aG9yaXRpZXMiOlsiUk9MRV9BRE1JTiIsIlJPTEVfVVNFUiJdLCJqdGkiOi
IwMmQ4MmU4NS0xM2YwLTQ2NzgtOTc0ZC0xOGViMDYyMTVhNjUiLCJjbGllbnRfaWQiOiJjbGllbnRJZF
Bhc3N3b3JkIiwic2NvcGUiOlsicmVhZCIsInVzZXJfaW5mbyJdfQ.SDg-BEzzonIVXfVBnnfq0oMbs_0
rWVtFGAZzRHj7KPgaOXT3bUhQwPOgggZDO0lv2U1klwB94c8Cb6rErzd3yjJ8wcVcnFLO4KxrjYZZxdK
VAz0CkMKqng4kQeQm_1UShsQXGLl48ezbjXyJn6mAl0oS4ExeiVsx_kYGEdqjyb5CiNaAzyx0J-J5jVD
SJew1rj5EiSybuy83PZwhluhxq0D2zPK1OSzqiezsd5kX5V8XI4MipDhaAbPYroL94banZTn9RmmAKZC
AYVM-mmHbjk8mF89fL9rKf9EUNhxOG6GE0MDqB3LLLcyQ6sYUmpqdP5Z94IkAN-FpC7k93_-RDw","to
ken_type":"bearer","refresh_token":"eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWI
iOiJhZG1pbiIsInNjb3BlIjpbInJlYWQiLCJ1c2VyX2luZm8iXSwiYXRpIjoiMDJkODJlODUtMTNmMC0
0Njc4LTk3NGQtMThlYjA2MjE1YTY1IiwiZXhwIjoxNTUyNzAxMTM4LCJhdXRob3JpdGllcyI6WyJST0x
FX0FETUlOIiwiUk9MRV9VU0VSIl0sImp0aSI6IjMwOWY2ZDllLWNmOGEtNDg0YS05ZjMxLWViOTAxYzk
4YTFkYSIsImNsaWVudF9pZCI6ImNsaWVudElkUGFzc3dvcmQifQ.jnZDt6TX2BvlmdT5JV-A7eHTJz_s
lC5fHrJFVI58ly6N7AUUfxebG_52pmuVHYULSKqTJXaLR866r-EnD4BJlzhk476FtgtVx1nazTpLFRLb
8qDCxeLrzClQBkzcxOt6VPxB3CD9QImx3bcsDwjkPxofUDmdg8AxZfGTu0PNbvO8TKLXEkeCztLFvSJM
GlN9zDzWhKxr49I-zPZg0XecgE9j4WITkFoDVwI-AfDJ3sGXDi5AN55Sz1j633QoqVjhtc0lO50WPVk5
YT7gU8HLj27EfX-6vjnGfNb8oeq189-NX100QHZM9Wgm79mIm4sRgwhpv-zzdDAkeb3uwIpb8g","exp
ires_in":1799,"scope":"read
user_info","jti":"02d82e85-13f0-4678-974d-18eb06215a65"}</pre>
</div>
</div>
</div>
<div class="sect6">
<h7 id="_httpie">Httpie</h7>
<div class="literalblock">
<div class="content">
<pre>http --form POST http://localhost:2002/auth/token username=admin password=test
grant_type=password client_id=clientIdPassword</pre>
</div>
</div>
<div class="paragraph">
<p>example of expected result:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>.HTTP/1.1 200 OK
Cache-Control: no-store
Content-Type: application/json;charset=utf-8
Date: Fri, 15 Mar 2019 13:57:19 GMT
Pragma: no-cache
X-Content-Type-Options: nosniff
X-Frame-Options: DENY
X-XSS-Protection: 1; mode=block
transfer-encoding: chunked

{
    "access_token":
"eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJhZG1pbiIsImV4cCI6MTU1MjY2MDAzOS
wiYXV0aG9yaXRpZXMiOlsiUk9MRV9BRE1JTiIsIlJPTEVfVVNFUiJdLCJqdGkiOiI2MjQzMDliMS03Yz
g3LTRjZGMtODQ0My0wMTI0NTE1Zjg3ZjgiLCJjbGllbnRfaWQiOiJjbGllbnRJZFBhc3N3b3JkIiwic2
NvcGUiOlsicmVhZCIsInVzZXJfaW5mbyJdfQ.VO4OZL7ycqNez0cHzM5WPuklr0r6SAOkUdUV2qFa5Bd
3PWx3DFHAHUxkfSX0-R4OO6iG2Zu7abzToAZNVLwk107LH_lWXOMQBriGx3d2aSgCf1yx_wI3lHDd8ST
8fxV7uNeolzywYavSpMGfgz9GXLzmnyeuPH4oy7eyPk9BwWVi0d7a_0d-EfhE1T8eaiDfymzzNXJ4Bge
8scPy-93HmWpqORtJaFq1qy4QgU28N2LgHFEEEWCSzfhYXH-LngTCP3-JSNcox1hI51XBWEqoeApKdfD
J6o4szR71SIFCBERxCH9TyUxsFywWL3e-YnXMiP2J08eB8O4YwhYQEFqB8Q",
    "expires_in": 1799,
    "jti": "624309b1-7c87-4cdc-8443-0124515f87f8",
    "refresh_token":
"eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJhZG1pbiIsInNjb3BlIjpbInJlYWQiLC
J1c2VyX2luZm8iXSwiYXRpIjoiNjI0MzA5YjEtN2M4Ny00Y2RjLTg0NDMtMDEyNDUxNWY4N2Y4IiwiZX
hwIjoxNTUyNzAxNDM5LCJhdXRob3JpdGllcyI6WyJST0xFX0FETUlOIiwiUk9MRV9VU0VSIl0sImp0aS
I6ImRiYzMxNTJiLTM4YTUtNGFmZC1hY2VmLWVkZTI4MjJkOTE3YyIsImNsaWVudF9pZCI6ImNsaWVudE
lkUGFzc3dvcmQifQ.Ezd8kbfNQHOOvUCNNN4UmOOkncHiT9QVEM63FiW1rq0uXDa3xfBGil8geM5MsP0
7Q2He-mynkFb8sGNDrAXTdO-8r5o4a60zWrktrMg2QH4icC1lyeZpiwZxe6675QpLpSeMlXt9PdYj-pb
14lrRookxXP5xMQuIMteZpbtby7LuuNAbNrjveZ1bZ4WMi7zltUzcYUuqHlP1AYPteGRrJVKXiuPpoDv
gwMsEk2SkgyyACI7SdZZs8IT9IGgSsIjjgTMQKzj8P6yYxNLUynEW4o5y1s2aAOV0xKrzkln9PchH9zN
qO-fkjTVRjy_LBXGq9zkn0ZeQ3BUe1GuthvGjaA",
    "scope": "read user_info",
    "token_type": "bearer"
}</pre>
</div>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_extract_token">Extract token</h6>
<div class="paragraph">
<p>From the previous results, the data need to be considered to be authenticated
by OperatorFabric services is the content of the <code>"access_token"</code> attribute of
the body response.</p>
</div>
<div class="paragraph">
<p>Once this value extracted, it need to be passed at the end of the value of the
http HEADER of type <code>Authorization:Bearer</code>.
example from previous results:</p>
</div>
<div class="sect6">
<h7 id="_curl_2">Curl</h7>
<div class="literalblock">
<div class="content">
<pre>Authorization:Bearer
eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJhZG1pbiIsImV4cCI6MTU1MjY1OTczOCw
iYXV0aG9yaXRpZXMiOlsiUk9MRV9BRE1JTiIsIlJPTEVfVVNFUiJdLCJqdGkiOiIwMmQ4MmU4NS0xM2Y
wLTQ2NzgtOTc0ZC0xOGViMDYyMTVhNjUiLCJjbGllbnRfaWQiOiJjbGllbnRJZFBhc3N3b3JkIiwic2N
vcGUiOlsicmVhZCIsInVzZXJfaW5mbyJdfQ.SDg-BEzzonIVXfVBnnfq0oMbs_0rWVtFGAZzRHj7KPga
OXT3bUhQwPOgggZDO0lv2U1klwB94c8Cb6rErzd3yjJ8wcVcnFLO4KxrjYZZxdKVAz0CkMKqng4kQeQm
_1UShsQXGLl48ezbjXyJn6mAl0oS4ExeiVsx_kYGEdqjyb5CiNaAzyx0J-J5jVDSJew1rj5EiSybuy83
PZwhluhxq0D2zPK1OSzqiezsd5kX5V8XI4MipDhaAbPYroL94banZTn9RmmAKZCAYVM-mmHbjk8mF89f
L9rKf9EUNhxOG6GE0MDqB3LLLcyQ6sYUmpqdP5Z94IkAN-FpC7k93_-RDw</pre>
</div>
</div>
</div>
<div class="sect6">
<h7 id="_httpie_2">Httpie</h7>
<div class="literalblock">
<div class="content">
<pre>Authorization:Bearer
eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJhZG1pbiIsImV4cCI6MTU1MjY2MDAzOSw
iYXV0aG9yaXRpZXMiOlsiUk9MRV9BRE1JTiIsIlJPTEVfVVNFUiJdLCJqdGkiOiI2MjQzMDliMS03Yzg
3LTRjZGMtODQ0My0wMTI0NTE1Zjg3ZjgiLCJjbGllbnRfaWQiOiJjbGllbnRJZFBhc3N3b3JkIiwic2N
vcGUiOlsicmVhZCIsInVzZXJfaW5mbyJdfQ.VO4OZL7ycqNez0cHzM5WPuklr0r6SAOkUdUV2qFa5Bd3
PWx3DFHAHUxkfSX0-R4OO6iG2Zu7abzToAZNVLwk107LH_lWXOMQBriGx3d2aSgCf1yx_wI3lHDd8ST8
fxV7uNeolzywYavSpMGfgz9GXLzmnyeuPH4oy7eyPk9BwWVi0d7a_0d-EfhE1T8eaiDfymzzNXJ4Bge8
scPy-93HmWpqORtJaFq1qy4QgU28N2LgHFEEEWCSzfhYXH-LngTCP3-JSNcox1hI51XBWEqoeApKdfDJ
6o4szR71SIFCBERxCH9TyUxsFywWL3e-YnXMiP2J08eB8O4YwhYQEFqB8Q</pre>
</div>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_check_a_token">Check a token</h6>
<div class="sect6">
<h7 id="_curl_3">Curl</h7>
<div class="paragraph">
<p>from previous example</p>
</div>
<div class="literalblock">
<div class="content">
<pre>curl -s -X POST -d
"token=eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJhZG1pbiIsImV4cCI6MTU1MjY1
OTczOCwiYXV0aG9yaXRpZXMiOlsiUk9MRV9BRE1JTiIsIlJPTEVfVVNFUiJdLCJqdGkiOiIwMmQ4MmU4
NS0xM2YwLTQ2NzgtOTc0ZC0xOGViMDYyMTVhNjUiLCJjbGllbnRfaWQiOiJjbGllbnRJZFBhc3N3b3Jk
Iiwic2NvcGUiOlsicmVhZCIsInVzZXJfaW5mbyJdfQ.SDg-BEzzonIVXfVBnnfq0oMbs_0rWVtFGAZzR
Hj7KPgaOXT3bUhQwPOgggZDO0lv2U1klwB94c8Cb6rErzd3yjJ8wcVcnFLO4KxrjYZZxdKVAz0CkMKqn
g4kQeQm_1UShsQXGLl48ezbjXyJn6mAl0oS4ExeiVsx_kYGEdqjyb5CiNaAzyx0J-J5jVDSJew1rj5Ei
Sybuy83PZwhluhxq0D2zPK1OSzqiezsd5kX5V8XI4MipDhaAbPYroL94banZTn9RmmAKZCAYVM-mmHbj
k8mF89fL9rKf9EUNhxOG6GE0MDqB3LLLcyQ6sYUmpqdP5Z94IkAN-FpC7k93_-RDw"
http://localhost:2002/auth/check_token</pre>
</div>
</div>
<div class="paragraph">
<p>which gives the following example of result:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>{
    "sub":"admin",
    "scope":["read","user_info"],
    "active":true,"exp":1552659738,
    "authorities":["ROLE_ADMIN","ROLE_USER"],
    "jti":"02d82e85-13f0-4678-974d-18eb06215a65",
    "client_id":"clientIdPassword"
}</pre>
</div>
</div>
</div>
<div class="sect6">
<h7 id="_httpie_3">Httpie</h7>
<div class="paragraph">
<p>from previous example:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>http --form POST http://localhost:2002/auth/check_token
token=eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJhZG1pbiIsImV4cCI6MTU1MjY2M
DAzOSwiYXV0aG9yaXRpZXMiOlsiUk9MRV9BRE1JTiIsIlJPTEVfVVNFUiJdLCJqdGkiOiI2MjQzMDliM
S03Yzg3LTRjZGMtODQ0My0wMTI0NTE1Zjg3ZjgiLCJjbGllbnRfaWQiOiJjbGllbnRJZFBhc3N3b3JkI
iwic2NvcGUiOlsicmVhZCIsInVzZXJfaW5mbyJdfQ.VO4OZL7ycqNez0cHzM5WPuklr0r6SAOkUdUV2q
Fa5Bd3PWx3DFHAHUxkfSX0-R4OO6iG2Zu7abzToAZNVLwk107LH_lWXOMQBriGx3d2aSgCf1yx_wI3lH
Dd8ST8fxV7uNeolzywYavSpMGfgz9GXLzmnyeuPH4oy7eyPk9BwWVi0d7a_0d-EfhE1T8eaiDfymzzNX
J4Bge8scPy-93HmWpqORtJaFq1qy4QgU28N2LgHFEEEWCSzfhYXH-LngTCP3-JSNcox1hI51XBWEqoeA
pKdfDJ6o4szR71SIFCBERxCH9TyUxsFywWL3e-YnXMiP2J08eB8O4YwhYQEFqB8Q</pre>
</div>
</div>
<div class="paragraph">
<p>which gives the following example of result:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>HTTP/1.1 200 OK
Cache-Control: no-cache, no-store, max-age=0, must-revalidate
Content-Type: application/json;charset=utf-8
Date: Fri, 15 Mar 2019 14:19:31 GMT
Expires: 0
Pragma: no-cache
X-Content-Type-Options: nosniff
X-Frame-Options: DENY
X-XSS-Protection: 1; mode=block
transfer-encoding: chunked

{
    "active": true,
    "authorities": [
        "ROLE_ADMIN",
        "ROLE_USER"
    ],
    "client_id": "clientIdPassword",
    "exp": 1552660039,
    "jti": "624309b1-7c87-4cdc-8443-0124515f87f8",
    "scope": [
        "read",
        "user_info"
    ],
    "sub": "admin"
}</pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_user_creation">4.3.2. User creation</h4>
<div class="paragraph">
<p>Setting automated user creation==. Creation user requires an user id. Given name and family name are optional.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">name</th>
<th class="tableblock halign-left valign-top">default</th>
<th class="tableblock halign-left valign-top">mandatory?</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.security.jwt.login-claim</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">sub</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Jwt claim is used as an user login or id</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.security.jwt.given-name-claim</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">given-name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Jwt claim is used to set the user&#8217;s given name</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.security.jwt.family-name-claim</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">family-name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Jwt claim is used to set the user&#8217;s family name</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_alternative_way_to_manage_groups">4.3.3. Alternative way to manage groups</h4>
<div class="paragraph">
<p>By default, <code>Operator-Fabric</code> manage groups through the user&#8217;s group. Another mode can be defined, the JWT mode. The groups come from the authentication token. The administrator of the authentication service has to set what claims define a group. In the <code>Operator-Fabric</code> configuration, the opfab administrator has to set properties to retrieve thoses groups.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">name</th>
<th class="tableblock halign-left valign-top">default</th>
<th class="tableblock halign-left valign-top">mandatory?</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.security.jwt.groups.mode</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPERATOR_FABRIC</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Set the group mode, possible values JWT or OPERATOR_FABRIC</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.security.jwt.groups.rolesClaim.rolesClaimStandard-claim.path</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">path in the JWT to retrieve the claim that defines a group</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.security.jwt.groups.rolesClaim.rolesClaimStandardArray.path</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">path in the JWT to retrieve the claim that defines an array of groups</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.security.jwt.groups.rolesClaim.rolesClaimStandardList.path</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">path in the JWT to retrieve the claim that defines a list of group</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.security.jwt.groups.rolesClaim.rolesClaimStandardList.separator</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">set the separator value of the list of group</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.security.jwt.groups.rolesClaim.rolesClaimCheckExistPath.path</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">path in the JWT to check if that path does exist, if it does, use the roleValue as a group</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.security.jwt.groups.rolesClaim.rolesClaimCheckExistPath.roleValue</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">set the value of the group if the path exists</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><em>application.yml</em></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>operatorfabric:
  security:
    jwt:
      groups:
        mode: JWT # value possible JWT | OPERATOR_FABRIC
        rolesClaim:
          rolesClaimStandard:
            - path: "ATTR1"
            - path: "ATTR2"
          rolesClaimStandardArray:
            - path: "resource_access/opfab-client/roles"
          rolesClaimStandardList:
            - path: "roleFieldList"
              separator: ";"
          rolesClaimCheckExistPath:
            - path: "resource_access/AAA"
              roleValue: "roleAAA"
            - path: "resource_access/BBB"
              roleValue: "roleBBB"</code></pre>
</div>
</div>
<div class="paragraph">
<p><em>JWT example</em></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>{
  "jti": "5ff87583-10bd-4946-8753-9d58171c8b7f",
  "exp": 1572979628,
  "nbf": 0,
  "iat": 1572961628,
  "iss": "http://localhost:89/auth/realms/dev",
  "aud": [
    "AAA",
    "BBB",
    "account"
  ],
  "sub": "example_user",
  "typ": "Bearer",
  "azp": "opfab-client",
  "auth_time": 0,
  "session_state": "960cbec4-fcb2-47f2-a155-975832e61300",
  "acr": "1",
  "realm_access": {
    "roles": [
      "offline_access",
      "uma_authorization"
    ]
  },
  "resource_access": {
    "AAA": {
      "roles": [
        "role_AAA"
      ]
    },
    "BBB": {
      "roles": [
        "role_BBB"
      ]
    },
    "opfab-client": {
      "roles": [
        "USER"
      ]
    },
    "account": {
      "roles": [
        "manage-account",
        "manage-account-links",
        "view-profile"
      ]
    }
  },
  "scope": "openid ATTR2 email ATTR1 profile roleFieldList",
  "email_verified": false,
  "name": "example_firtstname example_lastname",
  "ATTR2": "roleATTR2",
  "ATTR1": "roleATTR1",
  "preferred_username": "example_user",
  "given_name": "example_firtstname",
  "family_name": "example_lastname",
  "email": "example_user@mail.com",
  "roleFieldList": "roleA;roleB;roleC"
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>As the result, the group will be [ATTR1, ATTR2, roleA, roleB, roleC, USER, roleBBB, roleAAA]</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_service_specific_configuration">4.4. Service-specific configuration</h3>
<div class="sect3">
<h4 id="_actions_business_service">4.4.1. Actions Business service</h4>
<div class="paragraph">
<p>OperatorFabric Actions Business service is a Spring Webflux application
bootstrapped using SpringBoot.</p>
</div>
<div class="sect4">
<h5 id="_mandatory_configuration_profiles_and_default_properties">Mandatory configuration, Profiles and default properties</h5>
<div class="paragraph">
<p>The service has the following mandatory configuration.</p>
</div>
<div class="sect5">
<h6 id="_mandatory_properties">Mandatory properties</h6>
<div class="paragraph">
<p>The following table recaps all the needed properties for the <code>action service</code>
to run properly. They&#8217;re defined in the <code>application.yml</code> configuration file.
The configuration use during the development should be included into the
<code>application-dev.yml</code> configuration file.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">key</th>
<th class="tableblock halign-left valign-top">Usage</th>
<th class="tableblock halign-left valign-top">Example</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">server.port</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Defines the port of the service</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2105</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">spring.security.oauth2.resourceserver.jwt.jwk-set-uri</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">URI serving the public
key use to control OAuth2 jwt signature.
See <a href="https://tools.ietf.org/html/rfc7517">RFC 7517 - JSON Web Key (JWK)</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://localhost:89/auth/realms/dev/protocol/openid-connect/certs" class="bare">localhost:89/auth/realms/dev/protocol/openid-connect/certs</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.services.base-url.cards</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">URL of the <code>action service</code> of the
current <code>OperatorFabric</code> instance</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://localhost:2104" class="bare">localhost:2104</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.services.base-url.thirds</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">URL of the <code>third service</code> of the
current <code>OperatorFabric</code> instance</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://localhost:2100" class="bare">localhost:2100</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.services.base-url.users</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">URL of the <code>user service</code> of the
current <code>OperatorFabric</code> instance</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://localhost:2103" class="bare">localhost:2103</a></p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect4">
<h5 id="_specifying_external_configuration_properties_when_launching_a_jar_file">Specifying external configuration properties when launching a jar file</h5>
<div class="paragraph">
<p>See <a href="https://docs.spring.io/spring-boot/docs/2.1.2.RELEASE//reference/htmlsingle/#boot-features-external-config-application-property-files">Application Property Files</a>
on how to setup an external spring properties or yml file.</p>
</div>
<div class="paragraph">
<p>See <a href="https://docs.spring.io/spring-boot/docs/2.1.2.RELEASE//reference/htmlsingle/#howto-set-active-spring-profiles">Set the Active Spring Profiles</a> for specifying alternate profile.</p>
</div>
</div>
<div class="sect4">
<h5 id="_specifying_configuration_properties_when_launching_a_docker_image">Specifying configuration properties when launching a docker image</h5>
<div class="paragraph">
<p>At time of writing, you cannot specify an alternate profile at runtime.
The profiles available to be activated at runtime are <code>docker</code> and <code>native</code>.</p>
</div>
<div class="sect5">
<h6 id="_available_environment_variables_for_docker_image">Available environment variables for docker image</h6>
<div class="ulist">
<ul>
<li>
<p>JAVA_OPTIONS: Additional java options</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_specifying_configuration_properties_when_launching_on_kubernetes">Specifying configuration properties when launching on Kubernetes</h5>
<div class="paragraph">
<p>In progress</p>
</div>
<div class="sect5">
<h6 id="_available_environment_variables_when_launching_on_kubernetes">Available environment variables when launching on Kubernetes</h6>
<div class="ulist">
<ul>
<li>
<p>JAVA_OPTIONS: Additional java options</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_cards_consultation_business_service">4.4.2. Cards-Consultation Business service</h4>
<div class="paragraph">
<p>OperatorFabric Cards-Consultation Business service is a Spring Webflux application
bootstrapped using SpringBoot.</p>
</div>
<div class="paragraph">
<p>In our spring micro service architecture this service depends on Eureka
Registry.</p>
</div>
<div class="sect4">
<h5 id="_mandatory_configuration_profiles_and_default_properties_2">Mandatory configuration, Profiles and default properties</h5>
<div class="paragraph">
<p>The service has no mandatory configuration beside global configuration and
usual bootstrap configuration.</p>
</div>
<div class="paragraph">
<p>For other configuration see:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://docs.spring.io/spring-boot/docs/2.1.2.RELEASE//reference/htmlsingle/">Spring Boot documentation</a>.</p>
</li>
<li>
<p><a href="https://docs.spring.io/spring/docs/5.1.4.RELEASE/spring-framework-reference/web-reactive.html#webflux">Spring MVC documentation</a>.</p>
</li>
</ul>
</div>
<div class="sect5">
<h6 id="_service_specific_properties">Service specific properties</h6>

</div>
<div class="sect5">
<h6 id="_default_properties">default properties</h6>
<div class="paragraph">
<p>Note that you must provide a bootstrap file with a convenient registry configuration</p>
</div>
<div class="paragraph">
<p><em>bootstrap.yml</em></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>spring:
  application:
    name: cards-consultation
  cloud:
    config:
      name: cards-consultation
      fail-fast: true
      retry:
        max-attempts: 20
      discovery:
        service-id: config
        enabled: true</code></pre>
</div>
</div>
<div class="paragraph">
<p><em>bootstrap-docker.yml</em></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>spring:
  application:
    name: cards-consultation
  cloud:
    config:
      name: cards-consultation
      failFast: true
      retry:
        maxAttempts: 20
      discovery:
        service-id: config
        enabled: true
#  level.root: debug
eureka:
  client:
    registerWithEureka: true
    fetchRegistry: true
    registryFetchIntervalSeconds: 5
    service-url:
      defaultZone: 'http://${REGISTRY_HOST}:${REGISTRY_PORT}/eureka/'</code></pre>
</div>
</div>
<div class="paragraph">
<p><em>bootstrap-dev.yml</em></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>spring:
  application:
    name: cards-consultation
  cloud:
    config:
      name: cards-consultation
      fail-fast: true
      retry:
        max-attempts: 20
      discovery:
        service-id: config
        enabled: true
#  level.root: debug
eureka:
  client:
    service-url:
      defaultZone: 'http://localhost:2001/eureka'</code></pre>
</div>
</div>
<div class="paragraph">
<p>The bootstrap-docker.yml file is a replacement bootstrap file we use for our
docker images configuration.</p>
</div>
<div class="paragraph">
<p>The bootstrap-dev.yml file is a replacement bootstrap file we use for our
development environment</p>
</div>
<div class="paragraph">
<p>The above embedded configurations are the basic settings of the application:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>it sets its service name</p>
</li>
<li>
<p>it sets the configuration name to use (which configuration file to retrieve)</p>
</li>
<li>
<p>it must set the registry service (example in bootstrap-docker.yml)</p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="_sample_development_configuration">Sample development configuration</h6>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>server:
  port: 2104
logging.level.root: DEBUG</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_sample_docker_image_configuration">Sample docker image configuration</h6>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code></code></pre>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_specifying_external_configuration_properties_when_launching_a_jar_file_2">Specifying external configuration properties when launching a jar file</h5>
<div class="paragraph">
<p>See <a href="https://docs.spring.io/spring-boot/docs/2.1.2.RELEASE//reference/htmlsingle/#boot-features-external-config-application-property-files">Application Property Files</a>
on how to setup an external spring properties or yml file.</p>
</div>
<div class="paragraph">
<p>See <a href="https://docs.spring.io/spring-boot/docs/2.1.2.RELEASE//reference/htmlsingle/#howto-set-active-spring-profiles">Set the Active Spring Profiles</a> for specifying alternate profile.</p>
</div>
</div>
<div class="sect4">
<h5 id="_specifying_configuration_properties_when_launching_a_docker_image_2">Specifying configuration properties when launching a docker image</h5>
<div class="paragraph">
<p>Our docker image expects optional property file to be stored in the container
/service-config folder. You can bind so docker volume to this path to make
properties or yml available.</p>
</div>
<div class="paragraph">
<p>At time of writing, you cannot specify an alternate profile at runCards-Consultation.
The default profiles activated are docker and native.</p>
</div>
<div class="sect5">
<h6 id="_available_environment_variables_for_docker_image_2">Available environment variables for docker image</h6>
<div class="ulist">
<ul>
<li>
<p>REGISTRY_HOST: Registry service host</p>
</li>
<li>
<p>REGISTRY_PORT: Registry service port</p>
</li>
<li>
<p>JAVA_OPTIONS: Additional java options</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_specifying_configuration_properties_when_launching_on_kubernetes_2">Specifying configuration properties when launching on Kubernetes</h5>
<div class="paragraph">
<p>In progress</p>
</div>
<div class="sect5">
<h6 id="_available_environment_variables_when_launching_on_kubernetes_2">Available environment variables when launching on Kubernetes</h6>
<div class="ulist">
<ul>
<li>
<p>REGISTRY_HOST: Registry service host</p>
</li>
<li>
<p>REGISTRY_PORT: Registry service port</p>
</li>
<li>
<p>JAVA_OPTIONS: Additional java options</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_cards_publication_business_service">4.4.3. Cards-Publication Business service</h4>
<div class="paragraph">
<p>OperatorFabric Cards-Publication Business service is a Spring Webflux application
bootstrapped using SpringBoot.</p>
</div>
<div class="paragraph">
<p>In our spring micro service architecture this service depends on Eureka
Registry.</p>
</div>
<div class="sect4">
<h5 id="_mandatory_configuration_profiles_and_default_properties_3">Mandatory configuration, Profiles and default properties</h5>
<div class="paragraph">
<p>The service has no mandatory configuration beside global configuration and
usual bootstrap configuration.</p>
</div>
<div class="paragraph">
<p>For other configuration see:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://docs.spring.io/spring-boot/docs/2.1.2.RELEASE//reference/htmlsingle/">Spring Boot documentation</a>.</p>
</li>
<li>
<p><a href="https://docs.spring.io/spring/docs/5.1.4.RELEASE/spring-framework-reference/web-reactive.html#webflux">Spring MVC documentation</a>.</p>
</li>
</ul>
</div>
<div class="sect5">
<h6 id="_service_specific_properties_2">Service specific properties</h6>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">name</th>
<th class="tableblock halign-left valign-top">default</th>
<th class="tableblock halign-left valign-top">mandatory?</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.card-write.window.size</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1000</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">card input window size to fill before flush</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.card-write.window.timeout</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">500</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">card input window millis wait time before flush</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.card-notification.window.size</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">100</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">card notification window size to fill before flush</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.card-notification.window.timeout</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1000</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">card notification window millis wait time before flush</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect5">
<h6 id="_default_properties_2">default properties</h6>
<div class="paragraph">
<p>Note that you must provide a bootstrap file with a convenient registry configuration</p>
</div>
<div class="paragraph">
<p><em>bootstrap.yml</em></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>spring:
  application:
    name: cards-publication
  cloud:
    config:
      name: cards-publication
      fail-fast: true
      retry:
        max-attempts: 20
      discovery:
        service-id: config
        enabled: true</code></pre>
</div>
</div>
<div class="paragraph">
<p><em>bootstrap-docker.yml</em></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>spring:
  application:
    name: cards-publication
  cloud:
    config:
      name: cards-publication
      failFast: true
      retry:
        maxAttempts: 20
      discovery:
        service-id: config
        enabled: true
#  level.root: debug
eureka:
  client:
    registerWithEureka: true
    fetchRegistry: true
    registryFetchIntervalSeconds: 5
    service-url:
      defaultZone: 'http://${REGISTRY_HOST}:${REGISTRY_PORT}/eureka/'</code></pre>
</div>
</div>
<div class="paragraph">
<p><em>bootstrap-dev.yml</em></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>spring:
  application:
    name: cards-publication
  cloud:
    config:
      name: cards-publication
      fail-fast: true
      retry:
        max-attempts: 20
      discovery:
        service-id: config
        enabled: true
eureka:
  client:
    service-url:
      defaultZone: 'http://localhost:2001/eureka'</code></pre>
</div>
</div>
<div class="paragraph">
<p>The bootstrap-docker.yml file is a replacement bootstrap file we use for our
docker images configuration.</p>
</div>
<div class="paragraph">
<p>The bootstrap-dev.yml file is a replacement bootstrap file we use for our
development environment</p>
</div>
<div class="paragraph">
<p>The above embedded configurations are the basic settings of the application:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>it sets its service name</p>
</li>
<li>
<p>it sets the configuration name to use (which configuration file to retrieve)</p>
</li>
<li>
<p>it must set the registry service (example in bootstrap-docker.yml)</p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="_sample_development_configuration_2">Sample development configuration</h6>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>server:
  port: 2102</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_sample_docker_image_configuration_2">Sample docker image configuration</h6>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code></code></pre>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_specifying_external_configuration_properties_when_launching_a_jar_file_3">Specifying external configuration properties when launching a jar file</h5>
<div class="paragraph">
<p>See <a href="https://docs.spring.io/spring-boot/docs/2.1.2.RELEASE//reference/htmlsingle/#boot-features-external-config-application-property-files">Application Property Files</a>
on how to setup an external spring properties or yml file.</p>
</div>
<div class="paragraph">
<p>See <a href="https://docs.spring.io/spring-boot/docs/2.1.2.RELEASE//reference/htmlsingle/#howto-set-active-spring-profiles">Set the Active Spring Profiles</a> for specifying alternate profile.</p>
</div>
</div>
<div class="sect4">
<h5 id="_specifying_configuration_properties_when_launching_a_docker_image_3">Specifying configuration properties when launching a docker image</h5>
<div class="paragraph">
<p>Our docker image expects optional property file to be stored in the container
/service-config folder. You can bind so docker volume to this path to make
properties or yml available.</p>
</div>
<div class="paragraph">
<p>At time of writing, you cannot specify an alternate profile at runCards-Publication.
The default profiles activated are docker and native.</p>
</div>
<div class="sect5">
<h6 id="_available_environment_variables_for_docker_image_3">Available environment variables for docker image</h6>
<div class="ulist">
<ul>
<li>
<p>REGISTRY_HOST: Registry service host</p>
</li>
<li>
<p>REGISTRY_PORT: Registry service port</p>
</li>
<li>
<p>JAVA_OPTIONS: Additional java options</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_specifying_configuration_properties_when_launching_on_kubernetes_3">Specifying configuration properties when launching on Kubernetes</h5>
<div class="paragraph">
<p>In progress</p>
</div>
<div class="sect5">
<h6 id="_available_environment_variables_when_launching_on_kubernetes_3">Available environment variables when launching on Kubernetes</h6>
<div class="ulist">
<ul>
<li>
<p>REGISTRY_HOST: Registry service host</p>
</li>
<li>
<p>REGISTRY_PORT: Registry service port</p>
</li>
<li>
<p>JAVA_OPTIONS: Additional java options</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="cloud_gateway_service_config">4.4.4. Cloud Gateway service</h4>
<div class="paragraph">
<p>OperatorFabric Client Gateway service is a Spring Cloud Gateway application
bootstrapped using SpringBoot.</p>
</div>
<div class="paragraph">
<p>In our spring micro service architecture the gateway service depends on Eureka
Registry.</p>
</div>
<div class="sect4">
<h5 id="_mandatory_configuration_profiles_and_default_properties_4">Mandatory configuration, Profiles and default properties</h5>
<div class="paragraph">
<p>To get a working gateway service, there a few mandatory configuration
properties:</p>
</div>
</div>
<div class="sect4">
<h5 id="_filters_and_cors_configuration_2">Filters and CORS configuration</h5>
<div class="sect5">
<h6 id="_authentication_server_2">Authentication Server</h6>
<div class="paragraph">
<p>In the configuration service <code>client-gateway.yml</code> file:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The application must set up a route to the oauth server</p>
<div class="ulist">
<ul>
<li>
<p><code>/auth/token(?&lt;path&gt;.*)</code>: must match the oauth2 token entry point;</p>
</li>
<li>
<p><code>/auth/code/(?&lt;params&gt;.*)</code>: must match the auth entry point with specific query
parameters like <code>response_type=code&amp;client_id=[client id]&amp;${params}</code>;</p>
</li>
<li>
<p><code>/auth/check_token</code>: must match token introspection entry point</p>
</li>
</ul>
</div>
</li>
<li>
<p>The application must add request header for each request:</p>
<div class="ulist">
<ul>
<li>
<p><code>AddRequestHeader: Authorization, Basic</code>: followed, separated with a space, by the <code>OAuth2 client-id</code> and the <code>OAuth2 client-secret</code> encoded in base64.</p>
</li>
</ul>
</div>
</li>
<li>
<p>The application may set up CORS rules if api are to be accessed from browser outside of
the deployment domain</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Configuration example of the filters, for the docker dev keycloak:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>spring.cloud.gateway.routes[0].filters:
        - RewritePath=/auth/token(?&lt;path&gt;.*), /auth/realms/dev/protocol/openid-connect/token$\{path}
        - RewritePath=/auth/code/(?&lt;params&gt;.*), /auth/realms/dev/protocol/openid-connect/auth?response_type=code&amp;client_id=opfab-client&amp;$\{params}
        - RewritePath=/auth/check_token, /auth/realms/dev/protocol/openid-connect/token/introspect
        - AddRequestHeader=Authorization, Basic b3BmYWItY2xpZW50Om9wZmFiLWtleWNsb2FrLXNlY3JldA==</code></pre>
</div>
</div>
<div class="paragraph">
<p>where:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>spring.cloud.gateway.routes.uri</code>: is your keycloak instance</p>
</li>
<li>
<p><code>spring.cloud.gateway.routes[0]</code> is the routes with <code>id</code> equals to <code>auth</code>;</p>
</li>
<li>
<p><code>/realms/dev</code>: is the keycloakrealm where <code>opfab-client</code> is defined.</p>
</li>
<li>
<p><code>b3BmYWItY2xpZW50Om9wZmFiLWtleWNsb2FrLXNlY3JldA==</code>: is the base64 encoded string of <code>opfab-client:opfab-keycloak-secret</code> with
<code>opfab-client</code> as client-id and <code>opfab-keycloak-secret</code> its client secret.</p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="_action_service_2">Action Service</h6>
<div class="paragraph">
<p>In the  configuration service <code>client-gateway.yml</code> file, the application must set up the <code>URI</code> of the <code>Action Service</code>.</p>
</div>
<div class="paragraph">
<p>To do so, the <code>spring.cloud.gateway.routes.id="action".uri</code> property is set with the actual value of this service.</p>
</div>
<div class="paragraph">
<p>In the case of a development set-up, this value is <code><a href="http://localhost:2105" class="bare">localhost:2105</a></code> where <code>2105</code>
is the default port as set in the <code>application.yml</code>used by the <code>Action service</code> as configuration.</p>
</div>
<div class="paragraph">
<p><code>client-gateway.yml</code> of the <code>dev-configuration</code> as example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>spring:
  cloud:
    gateway:
      routes:
      - id: actions
        uri: http://localhost:2105
        predicates:
        - Path=/actions/**
        filters:
        - RewritePath=/actions/(?&lt;path&gt;.*), /$\{path}</code></pre>
</div>
</div>
<div class="paragraph">
<p>As explained earlier, the key to configure is <code>uri</code> of the <code>spring.cloud.gateway.routes</code> with the <code>id</code>
equals to <code>actions</code>.</p>
</div>
<div class="paragraph">
<p>For other configuration see <a href="https://cloud.spring.io/spring-cloud-static/spring-cloud-gateway/2.1.0.RELEASE/single/spring-cloud-gateway.html">spring cloud gateway documentation</a>.</p>
</div>
</div>
<div class="sect5">
<h6 id="_service_specific_properties_3">Service specific properties</h6>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">name</th>
<th class="tableblock halign-left valign-top">default</th>
<th class="tableblock halign-left valign-top">mandatory?</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.gateway.configs</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">null</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">an array of string for each allowed config entries</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect5">
<h6 id="_default_properties_3">default properties</h6>
<div class="paragraph">
<p>Note that you must provide a bootstrap file with a convenient registry configuration</p>
</div>
<div class="paragraph">
<p><em>bootstrap.yml</em></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>spring:
  application:
    name: client-gateway
  cloud:
    config:
      name: client-gateway
      fail-fast: true
      retry:
        max-attempts: 20
      discovery:
        service-id: config
        enabled: true</code></pre>
</div>
</div>
<div class="paragraph">
<p><em>bootstrap-docker.yml</em></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>spring:
  application:
    name: client-gateway
  cloud:
    config:
      name: client-gateway
      failFast: true
      retry:
        maxAttempts: 20
      discovery:
        service-id: config
        enabled: true
eureka:
  client:
    registerWithEureka: true
    fetchRegistry: true
    registryFetchIntervalSeconds: 5
    service-url:
      defaultZone: 'http://${REGISTRY_HOST}:${REGISTRY_PORT}/eureka/'</code></pre>
</div>
</div>
<div class="paragraph">
<p><em>bootstrap-dev.yml</em></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>spring:
  application:
    name: client-gateway
  cloud:
    config:
      name: client-gateway
      failFast: true
      retry:
        max-attempts: 20
      discovery:
        service-id: config
        enabled: true
eureka:
  client:
    register-with-eureka: true
    fetch-registry: true
    service-url:
      defaultZone: 'http://localhost:2001/eureka/'</code></pre>
</div>
</div>
<div class="paragraph">
<p>The bootstrap-docker.yml file is a replacement bootstrap file we use for our
docker images configuration.</p>
</div>
<div class="paragraph">
<p>The bootstrap-dev.yml file is a replacement bootstrap file we use for our
development environment</p>
</div>
<div class="paragraph">
<p>The above embedded configurations are the basic settings of the application:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>it sets its service name</p>
</li>
<li>
<p>it sets the configuration name to use (which configuration file to retrieve)</p>
</li>
<li>
<p>it must set the registry service (example in bootstrap-docker.yml)</p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="_sample_developpement_configuration">Sample developpement configuration</h6>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>server:
  port: 2002
spring:
  cloud:
    gateway:
      routes:
      - id: auth
        uri: http://localhost:89
        predicates:
        - Path=/auth/**
        filters:
        - RewritePath=/auth/token(?&lt;path&gt;.*), /auth/realms/dev/protocol/openid-connect/token$\{path}
        - RewritePath=/auth/code/(?&lt;params&gt;.*), /auth/realms/dev/protocol/openid-connect/auth?response_type=code&amp;client_id=opfab-client&amp;$\{params}
        - RewritePath=/auth/check_token, /auth/realms/dev/protocol/openid-connect/token/introspect
        - AddRequestHeader=Authorization, Basic b3BmYWItY2xpZW50Om9wZmFiLWtleWNsb2FrLXNlY3JldA==
# WARNING : THIS CORS CONFIGURATION SHOULD NOT BE USED IN PRODUCTION
      globalcors:
        corsConfigurations:
          '[/**]':
            allowedOrigins: "*"
            allowedMethods: "*"
            allowedHeaders: "Authorization, Content-Type"
operatorfabric.gateway.configs:
  - web-ui.json
#logging.level.root: debug</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_sample_docker_image_configuration_3">Sample docker image configuration</h6>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>spring:
  cloud:
    gateway:
      routes:
      - id: auth
        uri: http://keycloak:8080
        predicates:
        - Path=/auth/**
        filters:
        - RewritePath=/auth/token(?&lt;path&gt;.*), /auth/realms/dev/protocol/openid-connect/token$\{path}
        - RewritePath=/auth/code/(?&lt;params&gt;.*), /auth/realms/dev/protocol/openid-connect/auth?response_type=code&amp;client_id=opfab-client&amp;$\{params}
        - RewritePath=/auth/check_token, /auth/realms/dev/protocol/openid-connect/token/introspect
        - AddRequestHeader=Authorization, Basic b3BmYWItY2xpZW50Om9wZmFiLWtleWNsb2FrLXNlY3JldA==
# WARNING : THIS CORS CONFIGURATION SHOULD NOT BE USED IN PRODUCTION
        globalcors:
         corsConfigurations:
          '[/**]':
            allowedOrigins: "*"
            allowedMethods: "*"
            allowedHeaders: "Authorization, Content-Type"
operatorfabric.gateway.configs:
  - web-ui.json</code></pre>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_specifying_external_configuration_properties_when_lauching_a_jar_file">Specifying external configuration properties when lauching a jar file</h5>
<div class="paragraph">
<p>See <a href="https://docs.spring.io/spring-boot/docs/2.1.2.RELEASE//reference/htmlsingle/#boot-features-external-config-application-property-files">Application Property Files</a>
on how to setup an external spring properties or yml file.</p>
</div>
<div class="paragraph">
<p>See <a href="https://docs.spring.io/spring-boot/docs/2.1.2.RELEASE//reference/htmlsingle/#howto-set-active-spring-profiles">Set the Active Spring Profiles</a> for specifying alternate profile.</p>
</div>
</div>
<div class="sect4">
<h5 id="_specifying_configuration_properties_when_lauching_a_docker_image">Specifying configuration properties when lauching a docker image</h5>
<div class="paragraph">
<p>Our docker image expects optional property file to be stored in the container
/service-config folder. You can bind so docker volume to this path to make
properties or yml available.</p>
</div>
<div class="paragraph">
<p>At time of writting, you cannot specify an alternate profile at runtime.
The default profiles activated are docker and native.</p>
</div>
<div class="sect5">
<h6 id="_available_environment_variables_for_docker_image_4">Available environment variables for docker image</h6>
<div class="ulist">
<ul>
<li>
<p>REGISTRY_HOST: Registry service host</p>
</li>
<li>
<p>REGISTRY_PORT: Registry service port</p>
</li>
<li>
<p>JAVA_OPTIONS: Additional java options</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_specifying_configuration_properties_when_lauching_on_kubernetes">Specifying configuration properties when lauching on Kubernetes</h5>
<div class="paragraph">
<p>In progress</p>
</div>
<div class="sect5">
<h6 id="_available_environment_variables_when_launching_on_kubernetes_4">Available environment variables when launching on Kubernetes</h6>
<div class="ulist">
<ul>
<li>
<p>REGISTRY_HOST: Registry service host</p>
</li>
<li>
<p>REGISTRY_PORT: Registry service port</p>
</li>
<li>
<p>JAVA_OPTIONS: Additional java options</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="cloud_config_service_config">4.4.5. Cloud Configuration service</h4>
<div class="paragraph">
<p>OperatorFabric Configuration service is a Spring Cloud Config application
bootstrapped using SpringBoot.</p>
</div>
<div class="paragraph">
<p>In our spring micro service architecture Configuration instances are the first
services to bootstrap, thus they are configured in a specific way contrary to
other services.</p>
</div>
<div class="sect4">
<h5 id="_mandatory_configuration_profiles_and_default_properties_5">Mandatory configuration, Profiles and default properties</h5>
<div class="paragraph">
<p>To get a working configuration service, there a few mandatory configuration
properties:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>in a bootstrap file:</p>
<div class="ulist">
<ul>
<li>
<p>The application must have a set name (spring.application.name)</p>
</li>
</ul>
</div>
</li>
<li>
<p>in an application property file</p>
<div class="ulist">
<ul>
<li>
<p>The application must have a configured rabbitmq service for configuration
change notification (spring.rabbitmq.*)</p>
</li>
<li>
<p>The application must have a configured eureka server (eureka.client.*)</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>For other configuration see <a href="https://cloud.spring.io/spring-cloud-static/spring-cloud-config/2.1.0.RELEASE/single/spring-cloud-config.html">spring cloud config documentation</a>.</p>
</div>
<div class="paragraph">
<p>Note that it is mandatory to define an environment repository for the service.
Dev and Docker profile uses a file system backend which is not suitable for
production and redundancy. You should prefer the usage of Git or Vault for
production.</p>
</div>
<div class="sect5">
<h6 id="_default_properties_4">default properties</h6>
<div class="paragraph">
<p>It is preferable not to change the following bootstrap.yml file.</p>
</div>
<div class="paragraph">
<p><em>bootstrap.yml</em></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>spring:
  application:
    name: config</code></pre>
</div>
</div>
<div class="paragraph">
<p><em>application.yml</em></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>management:
  endpoints:
    web:
      exposure:
        include: '*'</code></pre>
</div>
</div>
<div class="paragraph">
<p>The above embedded configurations are the basic settings of the application:
* it sets its name as a service (config)
* it exposes management endpoints</p>
</div>
</div>
<div class="sect5">
<h6 id="_dev_profile">dev profile</h6>
<div class="paragraph">
<p>dev is the profile we use internally for developpement we make it available for
external developers so that they don&#8217;t need extensive configuration to get a
jar working in the development environment</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>server:
  port: 2000
spring:
#  level.root: debug
  profiles:
    active: [native,dev]
  cloud:
    config:
      server:
        native:
          search-locations:
           - file:./build/dev-data/dev-configurations
  rabbitmq:
    host: localhost
    port: 5672
    username: guest
    password: guest
eureka:
  client:
    region: default
    service-url:
      defaultZone: http://localhost:2001/eureka
    registryFetchIntervalSeconds: 5</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>it exposes the service on port 2000 (defaults to 8080)</p>
</li>
<li>
<p>it activates the dev and native profile (native is mandatory for serving
config from file system)</p>
</li>
<li>
<p>it configures rabbitmq for dispatching config change messages to other services</p>
</li>
<li>
<p>it configures registration in eureka discovery service</p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="_docker_profile">docker profile</h6>
<div class="paragraph">
<p>docker is the profile we use in our docker images</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>spring:
  profiles:
    active: [native]
  cloud:
    config:
      server:
        native:
          search-locations:
           - file:/service-config
  rabbitmq:
    host: ${RABBITMQ_HOST}
    port: ${RABBITMQ_PORT}
    username: ${RABBITMQ_USER}
    password: ${RABBITMQ_PASSWORD}
eureka:
  client:
    region: default
    service-url:
      defaultZone: http://${REGISTRY_HOST}:${REGISTRY_PORT}/eureka
    registryFetchIntervalSeconds: 5</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>it activates the native profile (native is mandatory for serving
config from file system)</p>
</li>
<li>
<p>it configures rabbitmq for dispatching config change messages to other services</p>
</li>
<li>
<p>it configures registration in eureka discovery service</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_specifying_external_configuration_properties_when_lauching_a_jar_file_2">Specifying external configuration properties when lauching a jar file</h5>
<div class="paragraph">
<p>See <a href="https://docs.spring.io/spring-boot/docs/2.1.2.RELEASE//reference/htmlsingle/#boot-features-external-config-application-property-files">Application Property Files</a>
on how to setup an external spring properties or yml file.</p>
</div>
<div class="paragraph">
<p>Seehttps://docs.spring.io/spring-boot/docs/2.1.2.RELEASE//reference/htmlsingle/#howto-set-active-spring-profiles[Set the Active Spring Profiles] for specifying alternate profile.</p>
</div>
</div>
<div class="sect4">
<h5 id="_specifying_configuration_properties_when_lauching_a_docker_image_2">Specifying configuration properties when lauching a docker image</h5>
<div class="paragraph">
<p>Our docker image expects optional property file to be stored in the container
/service-config folder. You can bind so docker volume to this path to make
properties or yml available.</p>
</div>
<div class="paragraph">
<p>At time of writting, you cannot specify an alternate profile at runtime.
The default profiles activated are docker and native.</p>
</div>
<div class="sect5">
<h6 id="_available_environment_variables_for_docker_image_5">Available environment variables for docker image</h6>
<div class="ulist">
<ul>
<li>
<p>RABBITMQ_HOST: Rabbitmq host name</p>
</li>
<li>
<p>RABBITMQ_PORT: Rabbitmq host port</p>
</li>
<li>
<p>RABBITMQ_USER: Rabbitmq user name used for authentication service</p>
</li>
<li>
<p>RABBITMQ_PASSWORD: Rabbitmq user password used for authentication service</p>
</li>
<li>
<p>REGISTRY_HOST: Registry (eureka) host name</p>
</li>
<li>
<p>REGISTRY_PORT: Registry (eureka) host port</p>
</li>
<li>
<p>JAVA_OPTIONS: Additional java options</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_specifying_configuration_properties_when_lauching_on_kubernetes_2">Specifying configuration properties when lauching on Kubernetes</h5>
<div class="paragraph">
<p>In progress</p>
</div>
<div class="sect5">
<h6 id="_available_environment_variables_when_launching_on_kubernetes_5">Available environment variables when launching on Kubernetes</h6>
<div class="ulist">
<ul>
<li>
<p>RABBITMQ_HOST: Rabbitmq host name</p>
</li>
<li>
<p>RABBITMQ_PORT: Rabbitmq host port</p>
</li>
<li>
<p>RABBITMQ_USER: Rabbitmq user name used for authentication service</p>
</li>
<li>
<p>RABBITMQ_PASSWORD: Rabbitmq user password used for authentication service</p>
</li>
<li>
<p>REGISTRY_HOST: Registry (eureka) host name</p>
</li>
<li>
<p>REGISTRY_PORT: Registry (eureka) host port</p>
</li>
<li>
<p>JAVA_OPTIONS: Additional java options</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="cloud_registry_service_config">4.4.6. Cloud Registry service</h4>
<div class="paragraph">
<p>OperatorFabric Registry service is a Spring Eureka application
bootstrapped using SpringBoot.</p>
</div>
<div class="paragraph">
<p>In our spring micro service architecture Eureka Registry instances are the second
services to bootstrap, its configuration relies on the
<a href="../../../../deployment/index.html#cloud_config_service_config">Cloud Configuration Service</a>
.</p>
</div>
<div class="sect4">
<h5 id="_mandatory_configuration_profiles_and_default_properties_6">Mandatory configuration, Profiles and default properties</h5>
<div class="paragraph">
<p>To get a working registry service, there a few mandatory configuration
properties:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>In a bootstrap file</p>
<div class="ulist">
<ul>
<li>
<p>The application must have a set name (spring.application.name)</p>
</li>
<li>
<p>The application must have a set configuration name (spring.cloud.config.name)</p>
</li>
<li>
<p>The application must have a set configuration server (spring.cloud.config.uri)</p>
</li>
<li>
<p>The application may have a retry/failfast configuration for config access
(spring.cloud.config.failfast, spring.cloud.config.retry)</p>
</li>
</ul>
</div>
</li>
<li>
<p>In a configuration service registry.yml file</p>
<div class="ulist">
<ul>
<li>
<p>The application may deactivate eureka registration to avoid self registration
(deactivated by default in internal application.yml file)</p>
</li>
<li>
<p>The application must set the Eureka instance hostname (eureka.instance.hostname)</p>
</li>
<li>
<p>The application must set the Eureka default zone (eureka.lient.serviceUrl.defaultZone)</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>For other configuration see <a href="https://cloud.spring.io/spring-cloud-static/spring-cloud-netflix/2.1.0.RC3/single/spring-cloud-netflix.html">spring cloud netflix documentation</a>.</p>
</div>
<div class="sect5">
<h6 id="_default_properties_5">default properties</h6>
<div class="paragraph">
<p>It is preferable not to change the following bootstrap.yml file.</p>
</div>
<div class="paragraph">
<p><em>bootstrap.yml</em></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>spring:
  application:
    name: registry
  cloud.config:
    name: registry
    fail-fast: true</code></pre>
</div>
</div>
<div class="paragraph">
<p><em>bootstrap-docker.yml</em></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>spring:
  application:
    name: registry
  cloud.config:
    name: registry
    uri: http://${CONFIG_HOST}:${CONFIG_PORT}
    failFast: true
    retry:
      maxAttempts: 50</code></pre>
</div>
</div>
<div class="paragraph">
<p><em>bootstrap-dev.yml</em></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>spring:
  application:
    name: registry
  cloud.config:
    name: registry
    uri: http://localhost:2000</code></pre>
</div>
</div>
<div class="paragraph">
<p><em>application.yml</em></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>eureka:
  client:
    register-with-eureka: false
    fetch-registry: false</code></pre>
</div>
</div>
<div class="paragraph">
<p>The bootstrap-docker.yml file is a replacement bootstrap file we use for our
docker images configuration.</p>
</div>
<div class="paragraph">
<p>The bootstrap-dev.yml file is a replacement bootstrap file we use for our
developpement environment</p>
</div>
<div class="paragraph">
<p>The above embedded configurations are the basic settings of the application:
* it sets its name as a service (config)
* it sets the configuration name to use (which configuration file to retrieve)
* it must set the configuration service (example in bootstrap-docker.yml)</p>
</div>
</div>
<div class="sect5">
<h6 id="_dev_profile_2">dev profile</h6>
<div class="paragraph">
<p>dev is the profile we use internally for developpement we make it available for
external developers so that they don&#8217;t need extensive configuration to get a
jar working in the development environment</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>server:
  port: 2001
eureka:
  instance.hostname: localhost
  client.serviceUrl.defaultZone: http://localhost:2001/eureka/</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_sample_development_configuration_3">Sample development configuration</h6>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>server:
  port: 2001
eureka:
  instance.hostname: localhost
  client.serviceUrl.defaultZone: http://localhost:2001/eureka/</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_sample_docker_image_configuration_4">Sample docker image configuration</h6>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>eureka:
  instance.hostname: registry
  client:
    serviceUrl.defaultZone: http://registry:8080/eureka/
    registerWithEureka: false
    fetchRegistry: false
    server:
      waitTimeInMsWhenSyncEmpty: 0</code></pre>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_specifying_external_configuration_properties_when_lauching_a_jar_file_3">Specifying external configuration properties when lauching a jar file</h5>
<div class="paragraph">
<p>See <a href="https://docs.spring.io/spring-boot/docs/2.1.2.RELEASE//reference/htmlsingle/#boot-features-external-config-application-property-files">Application Property Files</a>
on how to setup an external spring properties or yml file.</p>
</div>
<div class="paragraph">
<p>See <a href="https://docs.spring.io/spring-boot/docs/2.1.2.RELEASE//reference/htmlsingle/#howto-set-active-spring-profiles">Set the Active Spring Profiles</a> for specifying alternate profile.</p>
</div>
</div>
<div class="sect4">
<h5 id="_specifying_configuration_properties_when_lauching_a_docker_image_3">Specifying configuration properties when lauching a docker image</h5>
<div class="paragraph">
<p>Our docker image expects optional property file to be stored in the container
/service-config folder. You can bind so docker volume to this path to make
properties or yml available.</p>
</div>
<div class="paragraph">
<p>At time of writting, you cannot specify an alternate profile at runtime.
The default profiles activated are docker and native.</p>
</div>
<div class="sect5">
<h6 id="_available_environment_variables_for_docker_image_6">Available environment variables for docker image</h6>
<div class="ulist">
<ul>
<li>
<p>CONFIG_HOST: Configuration service host</p>
</li>
<li>
<p>CONFIG_PORT: Configuration service port</p>
</li>
<li>
<p>JAVA_OPTIONS: Additional java options</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_specifying_configuration_properties_when_lauching_on_kubernetes_3">Specifying configuration properties when lauching on Kubernetes</h5>
<div class="paragraph">
<p>In progress</p>
</div>
<div class="sect5">
<h6 id="_available_environment_variables_when_launching_on_kubernetes_6">Available environment variables when launching on Kubernetes</h6>
<div class="ulist">
<ul>
<li>
<p>CONFIG_HOST: Configuration service host</p>
</li>
<li>
<p>CONFIG_PORT: Configuration service port</p>
</li>
<li>
<p>JAVA_OPTIONS: Additional java options</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_thirds_business_service">4.4.7. Thirds Business service</h4>
<div class="paragraph">
<p>OperatorFabric Thirds Business service is a Spring MVC application
bootstrapped using SpringBoot.</p>
</div>
<div class="paragraph">
<p>In our spring micro service architecture this service depends on Eureka
Registry.</p>
</div>
<div class="sect4">
<h5 id="_mandatory_configuration_profiles_and_default_properties_7">Mandatory configuration, Profiles and default properties</h5>
<div class="paragraph">
<p>The service has no mandatory configuration beside global configuration and
usual bootstrap configuration.</p>
</div>
<div class="paragraph">
<p>For other configuration see:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://docs.spring.io/spring-boot/docs/2.1.2.RELEASE//reference/htmlsingle/">Spring Boot documentation</a>.</p>
</li>
<li>
<p><a href="https://docs.spring.io/spring/docs/5.1.4.RELEASE/spring-framework-reference/web.html#mvc">Spring MVC documentation</a>.</p>
</li>
</ul>
</div>
<div class="sect5">
<h6 id="_service_specific_properties_4">Service specific properties</h6>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">name</th>
<th class="tableblock halign-left valign-top">default</th>
<th class="tableblock halign-left valign-top">mandatory?</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.thirds.storage.path</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">null</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">File path to data storage folder</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect5">
<h6 id="_default_properties_6">default properties</h6>
<div class="paragraph">
<p>Note that you must provide a bootstrap file with a convenient registry configuration</p>
</div>
<div class="paragraph">
<p><em>bootstrap.yml</em></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>spring:
  application:
    name: thirds
  cloud:
    config:
      name: thirds
      fail-fast: true
      retry:
        max-attempts: 20
      discovery:
        service-id: config
        enabled: true</code></pre>
</div>
</div>
<div class="paragraph">
<p><em>bootstrap-docker.yml</em></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>spring:
  application:
    name: thirds
  cloud:
    config:
      name: thirds
      failFast: true
      retry:
        maxAttempts: 20
      discovery:
        service-id: config
        enabled: true
#  level.root: debug
eureka:
  client:
    registerWithEureka: true
    fetchRegistry: true
    registryFetchIntervalSeconds: 5
    service-url:
      defaultZone: 'http://${REGISTRY_HOST}:${REGISTRY_PORT}/eureka/'</code></pre>
</div>
</div>
<div class="paragraph">
<p><em>bootstrap-dev.yml</em></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>spring:
  application:
    name: thirds
  cloud:
    config:
      name: thirds
      fail-fast: true
      retry:
        max-attempts: 20
      discovery:
        service-id: config
        enabled: true
eureka:
  client:
    service-url:
      defaultZone: 'http://localhost:2001/eureka'</code></pre>
</div>
</div>
<div class="paragraph">
<p>The bootstrap-docker.yml file is a replacement bootstrap file we use for our
docker images configuration.</p>
</div>
<div class="paragraph">
<p>The bootstrap-dev.yml file is a replacement bootstrap file we use for our
development environment</p>
</div>
<div class="paragraph">
<p>The above embedded configurations are the basic settings of the application:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>it sets its service name</p>
</li>
<li>
<p>it sets the configuration name to use (which configuration file to retrieve)</p>
</li>
<li>
<p>it must set the registry service (example in bootstrap-docker.yml)</p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="_sample_development_configuration_4">Sample development configuration</h6>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>server:
  port: 2100
operatorfabric.thirds:
  storage:
    path: "./services/core/thirds/build/docker-volume/thirds-storage"</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_sample_docker_image_configuration_5">Sample docker image configuration</h6>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>operatorfabric.thirds:
  storage:
    path: "/thirds-storage"</code></pre>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_specifying_external_configuration_properties_when_launching_a_jar_file_4">Specifying external configuration properties when launching a jar file</h5>
<div class="paragraph">
<p>See <a href="https://docs.spring.io/spring-boot/docs/2.1.2.RELEASE//reference/htmlsingle/#boot-features-external-config-application-property-files">Application Property Files</a>
on how to setup an external spring properties or yml file.</p>
</div>
<div class="paragraph">
<p>See <a href="https://docs.spring.io/spring-boot/docs/2.1.2.RELEASE//reference/htmlsingle/#howto-set-active-spring-profiles">Set the Active Spring Profiles</a> for specifying alternate profile.</p>
</div>
</div>
<div class="sect4">
<h5 id="_specifying_configuration_properties_when_launching_a_docker_image_4">Specifying configuration properties when launching a docker image</h5>
<div class="paragraph">
<p>Our docker image expects optional property file to be stored in the container
/service-config folder. You can bind so docker volume to this path to make
properties or yml available.</p>
</div>
<div class="paragraph">
<p>At time of writing, you cannot specify an alternate profile at runThirds.
The default profiles activated are docker and native.</p>
</div>
<div class="sect5">
<h6 id="_available_environment_variables_for_docker_image_7">Available environment variables for docker image</h6>
<div class="ulist">
<ul>
<li>
<p>REGISTRY_HOST: Registry service host</p>
</li>
<li>
<p>REGISTRY_PORT: Registry service port</p>
</li>
<li>
<p>JAVA_OPTIONS: Additional java options</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_specifying_configuration_properties_when_launching_on_kubernetes_4">Specifying configuration properties when launching on Kubernetes</h5>
<div class="paragraph">
<p>In progress</p>
</div>
<div class="sect5">
<h6 id="_available_environment_variables_when_launching_on_kubernetes_7">Available environment variables when launching on Kubernetes</h6>
<div class="ulist">
<ul>
<li>
<p>REGISTRY_HOST: Registry service host</p>
</li>
<li>
<p>REGISTRY_PORT: Registry service port</p>
</li>
<li>
<p>JAVA_OPTIONS: Additional java options</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_users_business_service">4.4.8. Users Business service</h4>
<div class="paragraph">
<p>OperatorFabric Users Business service is a Spring MVC application
bootstrapped using SpringBoot.</p>
</div>
<div class="paragraph">
<p>In our spring micro service architecture this service depends on Eureka
Registry.</p>
</div>
<div class="sect4">
<h5 id="_mandatory_configuration_profiles_and_default_properties_8">Mandatory configuration, Profiles and default properties</h5>
<div class="paragraph">
<p>The service has no mandatory configuration beside global configuration and
usual bootstrap configuration.</p>
</div>
<div class="paragraph">
<p>For other configuration see:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://docs.spring.io/spring-boot/docs/2.1.2.RELEASE//reference/htmlsingle/">Spring Boot documentation</a>.</p>
</li>
<li>
<p><a href="https://docs.spring.io/spring/docs/5.1.4.RELEASE/spring-framework-reference/web.html#mvc">Spring MVC documentation</a>.</p>
</li>
</ul>
</div>
<div class="sect5">
<h6 id="_service_specific_properties_5">Service specific properties</h6>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">name</th>
<th class="tableblock halign-left valign-top">default</th>
<th class="tableblock halign-left valign-top">mandatory?</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.users.default.users</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">null</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Array of user objects to create upon startup if they don&#8217;t exist</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.users.default.user-settings</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">null</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Array of user settings objects to create upon startup if they don&#8217;t exist</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.users.default.groups</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">null</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Array of group objects to create upon startup if they don&#8217;t exist</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect5">
<h6 id="_default_properties_7">default properties</h6>
<div class="paragraph">
<p>Note that you must provide a bootstrap file with a convenient registry configuration</p>
</div>
<div class="paragraph">
<p><em>bootstrap.yml</em></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>spring:
  application:
    name: users
  cloud:
    config:
      name: users
      fail-fast: true
      retry:
        max-attempts: 20
      discovery:
        service-id: config
        enabled: true</code></pre>
</div>
</div>
<div class="paragraph">
<p><em>bootstrap-docker.yml</em></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>spring:
  application:
    name: users
  cloud:
    config:
      name: users
      failFast: true
      retry:
        maxAttempts: 20
      discovery:
        service-id: config
        enabled: true
#  level.root: debug
eureka:
  client:
    registerWithEureka: true
    fetchRegistry: true
    registryFetchIntervalSeconds: 5
    service-url:
      defaultZone: 'http://${REGISTRY_HOST}:${REGISTRY_PORT}/eureka/'</code></pre>
</div>
</div>
<div class="paragraph">
<p><em>bootstrap-dev.yml</em></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>spring:
  application:
    name: users
  cloud:
    config:
      name: users
      fail-fast: true
      retry:
        max-attempts: 20
      discovery:
        service-id: config
        enabled: true
eureka:
  client:
    service-url:
      defaultZone: 'http://localhost:2001/eureka'</code></pre>
</div>
</div>
<div class="paragraph">
<p>The bootstrap-docker.yml file is a replacement bootstrap file we use for our
docker images configuration.</p>
</div>
<div class="paragraph">
<p>The bootstrap-dev.yml file is a replacement bootstrap file we use for our
development environment</p>
</div>
<div class="paragraph">
<p>The above embedded configurations are the basic settings of the application:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>it sets its service name</p>
</li>
<li>
<p>it sets the configuration name to use (which configuration file to retrieve)</p>
</li>
<li>
<p>it must set the registry service (example in bootstrap-docker.yml)</p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="_sample_development_configuration_5">Sample development configuration</h6>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>server:
  port: 2103
operatorfabric.users.default:
  users:
    - login: admin
      groups: ["ADMIN"]
    - login: rte-operator
      groups: ["RTE","ADMIN","TRANS"]
    - login: tso1-operator
      groups: ["TSO1","TRANS"]
    - login: tso2-operator
      groups: ["TSO2", "TRANS"]
  groups:
    - name: ADMIN
      description: The admin group
    - name: RTE
      description: RTE TSO Group
    - name: TSO1
      description: TSO 1 Group
    - name: TSO2
      description: TSO 2 Group
    - name: TRANS
      description: Transnationnal Group
  user-settings:
    - login: rte-operator
      description: Da Operator Rulez
#logging.level.root: DEBUG</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_sample_docker_image_configuration_6">Sample docker image configuration</h6>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>operatorfabric.users.default:
  users:
  - login: admin
    groups: ["ADMIN"]
  - login: rte-operator
    groups: ["RTE","ADMIN","TRANS"]
  - login: tso1-operator
    groups: ["TSO1","TRANS"]
  - login: tso2-operator
    groups: ["TSO2", "TRANS"]
  groups:
  - name: ADMIN
    description: The admin group
  - name: RTE
    description: RTE TSO Group
  - name: TSO1
    description: TSO 1 Group
  - name: TSO2
    description: TSO 2 Group
  - name: TRANS
    description: Transnationnal Group</code></pre>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_specifying_external_configuration_properties_when_launching_a_jar_file_5">Specifying external configuration properties when launching a jar file</h5>
<div class="paragraph">
<p>See <a href="https://docs.spring.io/spring-boot/docs/2.1.2.RELEASE//reference/htmlsingle/#boot-features-external-config-application-property-files">Application Property Files</a>
on how to setup an external spring properties or yml file.</p>
</div>
<div class="paragraph">
<p>See <a href="https://docs.spring.io/spring-boot/docs/2.1.2.RELEASE//reference/htmlsingle/#howto-set-active-spring-profiles">Set the Active Spring Profiles</a> for specifying alternate profile.</p>
</div>
</div>
<div class="sect4">
<h5 id="_specifying_configuration_properties_when_launching_a_docker_image_5">Specifying configuration properties when launching a docker image</h5>
<div class="paragraph">
<p>Our docker image expects optional property file to be stored in the container
/service-config folder. You can bind so docker volume to this path to make
properties or yml available.</p>
</div>
<div class="paragraph">
<p>At time of writing, you cannot specify an alternate profile at runUsers.
The default profiles activated are docker and native.</p>
</div>
<div class="sect5">
<h6 id="_available_environment_variables_for_docker_image_8">Available environment variables for docker image</h6>
<div class="ulist">
<ul>
<li>
<p>REGISTRY_HOST: Registry service host</p>
</li>
<li>
<p>REGISTRY_PORT: Registry service port</p>
</li>
<li>
<p>JAVA_OPTIONS: Additional java options</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_specifying_configuration_properties_when_launching_on_kubernetes_5">Specifying configuration properties when launching on Kubernetes</h5>
<div class="paragraph">
<p>In progress</p>
</div>
<div class="sect5">
<h6 id="_available_environment_variables_when_launching_on_kubernetes_8">Available environment variables when launching on Kubernetes</h6>
<div class="ulist">
<ul>
<li>
<p>REGISTRY_HOST: Registry service host</p>
</li>
<li>
<p>REGISTRY_PORT: Registry service port</p>
</li>
<li>
<p>JAVA_OPTIONS: Additional java options</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_web_ui">4.4.9. Web UI</h4>
<div class="paragraph">
<p>OperatorFabric Web UI service is a Spring MVC application bootstrapped using
SpringBoot. Its sole purpose is to serve the Angular SPA to browsers.</p>
</div>
<div class="paragraph">
<p>In our spring micro service architecture this service depends on Eureka
Registry.</p>
</div>
<div class="sect4">
<h5 id="_mandatory_configuration_profiles_and_default_properties_9">Mandatory configuration, Profiles and default properties</h5>
<div class="paragraph">
<p>The service has no mandatory configuration beside global configuration and
usual bootstrap configuration.</p>
</div>
<div class="paragraph">
<p>For other configuration see:
NONE
* <a href="https://docs.spring.io/spring-boot/docs/2.1.2.RELEASE//reference/htmlsingle/">Spring Boot documentation</a>.
* <a href="https://docs.spring.io/spring/docs/5.1.4.RELEASE/spring-framework-reference/web-reactive.html#webflux">Spring MVC documentation</a>.</p>
</div>
<div class="sect5">
<h6 id="_service_specific_properties_6">Service specific properties</h6>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">name</th>
<th class="tableblock halign-left valign-top">default</th>
<th class="tableblock halign-left valign-top">mandatory?</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.security.realm-url</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The realm name in keycloak server settings page. This is used for the log out process to know which realm should be affected.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.security.provider-url</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The keycloak server instance</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.security.logout-url</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The keycloak logout URL. Is a composition of:
 - Your keycloak instance and the <em>auth</em> keyword (ex: <a href="https://www.keycloakurl.com/auth" class="bare">www.keycloakurl.com/auth</a>), but we also support domains without <em>auth</em> (ex: <a href="https://www.keycloakurl.com/customPath" class="bare">www.keycloakurl.com/customPath</a>)
 - The realm name (Ex: dev)
 - The redirect URL (<em>redirect_uri</em>): The redirect URL after success authentification</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.security.oauth2.flow.mode</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PASSWORD</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>authentication mode, awailable options:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>CODE: Authorization Code Flow;</p>
</li>
<li>
<p>PASSWORD: Direct Password Flow (fallback);</p>
</li>
<li>
<p>IMPLICIT: Implicit Flow.</p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.security.oauth2.flow.provider</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">null</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">provider name to display on log in button</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.security.oauth2.flow.delegate-url</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">null</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Url to redirect the browser to for authentication. Mandatory with:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>CODE flow: must be the url with protocol choice and version as query parameters;</p>
</li>
<li>
<p>IMPLICIT flow: must be the url part before <code>.well-known/openid-configuration</code> (for example in dev configuration it&#8217;s
<code><a href="http://localhost:89/auth/realms/dev" class="bare">localhost:89/auth/realms/dev</a></code>).</p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.feed.subscription.timeout</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">60000</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Milliseconds between card subscription renewal</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.feed.card.time.display</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">BUSINESS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>card time display mode in the feed. Values:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>BUSINESS: displays card with entire business period. It the fallback if the set value is none of the values listed here;</p>
</li>
<li>
<p>BUSINESS_START: displays card with business start date;</p>
</li>
<li>
<p>PUBLICATION: displays card with publication date;</p>
</li>
<li>
<p>LTTD: displays card with lttd date;</p>
</li>
<li>
<p>NONE: nothing displayed.</p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.feed.timeline.hide</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If set to true, the time line is not loaded in the feed screen</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.feed.notify</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If set to true, new cards are notified in the OS through web-push notifications</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.playSoundForAlarm</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If set to true, a sound is played when Alarm cards are added or updated in the feed</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.playSoundForAction</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If set to true, a sound is played when Action cards are added or updated in the feed</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.playSoundForCompliant</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If set to true, a sound is played when Compliant cards are added or updated in the feed</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.playSoundForInformation</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If set to true, a sound is played when Information cards are added or updated in the feed</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.i18n.supported.locales</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">List of supported locales (Only fr and en so far)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.i10n.supported.time-zones</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">List of supported time zones, for instance 'Europe/Paris'.
Values should be taken from the <a href="https://en.wikipedia.org/wiki/List_of_tz_database_time_zones">TZ database</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.navbar.thirdmenus.type</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">BOTH</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Defines how thirdparty menu links are displayed in the navigation bar and how
they open. Possible values:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>TAB: Only a text link is displayed, and clicking it opens the link in a new tab.</p>
</li>
<li>
<p>IFRAME: Only a text link is displayed, and clicking it opens the link in an iframe in the main content zone below
the navigation bar.</p>
</li>
<li>
<p>BOTH: Both a text link and a little arrow icon are displayed. Clicking the text link opens the link in an iframe
while clicking the icon opens in a new tab.</p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.time.pulse</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5000</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Duration between two ticks of the internal state of the User Interface</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.archive.filters.page.size</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The page size of archive filters</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.archive.filters.page.first</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The first page start of archiving module</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.archive.filters.process.list</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">List of processes to choose from in the corresponding filter in archives</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.archive.filters.tags.list</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">List of tags to choose from in the corresponding filter in archives</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.settings.tags.hide</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Control if you want to show or hide the tags filter in settings and feed page</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.settings.infos.disable</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Control if we want to disable/enable editing user email, description in the settings page</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.settings.infos.email</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Control if we want to hide(true) or display(false or not specified) the user email in the settings page</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.settings.infos.description</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Control if we want to hide(true) or display(false or not specified) the user description in the settings page</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.settings.infos.language</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Control if we want to hide(true) or display(false or not specified) the language in the settings page</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.settings.infos.timezone</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Control if we want to hide(true) or display(false or not specified) the timezone in the settings page</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.settings.infos.timeformat</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Control if we want to hide(true) or display(false or not specified) the timeformat in the settings page</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.settings.infos.dateformat</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Control if we want to hide(true) or display(false or not specified) the dateformat in the settings page</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.settings.infos.datetimeformat</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Control if we want to hide(true) or display(false or not specified) the datetimeformat in the settings page</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.settings.infos.tags</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Control if we want to hide(true) or display(false or not specified) the tags in the settings page</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.settings.infos.sounds</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Control if we want to hide(true) or display(false or not specified) the checkboxes for sound notifications in the settings page</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.settings.about</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>operatorfabric:<br>
     name:  'OperatorFabric'<br>
     version:  ${currentVersion}<br>
     rank: 0</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>no</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Declares application names and their version into web-ui about section.<br>
Each entry is
a free key value followed by its name (a string of characters), its version(a string of characters) and its rank of declaration(a number) cf the default value where the declared key is <code>operatorfabric'</code>.<br>
For this default value, with <code>'OperatorFabric'</code> as <code>name</code> and <code>0</code> as <code>rank</code>, the value of <code>${currentVersion}</code> is the version of the current release. <code>0.16.1-RELEASE</code> for example.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.logo.base64</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">medium OperatorFabric icon</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The encoding result of converting the svg logo to Base64, use this <a href="https://base64.guru/converter/encode/image/svg">online tool</a> to encode your svg. If it is not set, a medium (32px) OperatorFabric icon is displayed.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.logo.height</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">32</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The height of the logo (in px) (only taken into account if operatorfabric.logo.base64 is set).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.logo.width</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">150</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The width of the logo (in px) (only taken into account if operatorfabric.logo.base64 is set).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.logo.limitSize</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If it is true, the height limit is 32(px) and the width limit is 200(px), it means that if the height is over than 32, it will be set to 32, if the width is over than 200, it is set to 200. If it is false, no limit restriction for the height and the width.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.title</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OperatorFabric</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Title of the application, displayed on the browser</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>User Settings default values</strong></p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">default</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">mandatory?</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Description</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.settings.timeZone</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Default user time zone for users (use</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.settings.timeFormat</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Default user time format (moment)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.settings.dateFormat</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Default user date format (moment)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.settings.dateTimeFormat</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LL LT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Default user date format (moment)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.settings.locale</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">en</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Default user locale (use en if not set)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operatorfabric.settings.default-tags</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Default user list of filtered in tags</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect5">
<h6 id="_default_properties_8">default properties</h6>
<div class="paragraph">
<p>Note that you must provide a bootstrap file with a convenient registry configuration</p>
</div>
<div class="paragraph">
<p><em>bootstrap.yml</em></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>spring:
  application:
    name: web-ui
  cloud:
    config:
      name: web-ui
      fail-fast: true
      retry:
        max-attempts: 20
      discovery:
        service-id: config
        enabled: true</code></pre>
</div>
</div>
<div class="paragraph">
<p><em>bootstrap-docker.yml</em></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>spring:
  application:
    name: web-ui
  cloud:
    config:
      name: web-ui
      failFast: true
      retry:
        maxAttempts: 20
      discovery:
        service-id: config
        enabled: true
#  level.root: debug
eureka:
  client:
    registerWithEureka: true
    fetchRegistry: true
    registryFetchIntervalSeconds: 5
    service-url:
      defaultZone: 'http://${REGISTRY_HOST}:${REGISTRY_PORT}/eureka/'</code></pre>
</div>
</div>
<div class="paragraph">
<p><em>bootstrap-dev.yml</em></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>spring:
  application:
    name: web-ui
  cloud:
    config:
      name: web-ui
      fail-fast: true
      retry:
        max-attempts: 20
      discovery:
        service-id: config
        enabled: true
eureka:
  client:
    service-url:
      defaultZone: 'http://localhost:2001/eureka'</code></pre>
</div>
</div>
<div class="paragraph">
<p>The bootstrap-docker.yml file is a replacement bootstrap file we use for our
docker images configuration.</p>
</div>
<div class="paragraph">
<p>The bootstrap-dev.yml file is a replacement bootstrap file we use for our
development environment</p>
</div>
<div class="paragraph">
<p>The above embedded configurations are the basic settings of the application:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>it sets its service name</p>
</li>
<li>
<p>it sets the configuration name to use (which configuration file to retrieve)</p>
</li>
<li>
<p>it must set the registry service (example in bootstrap-docker.yml)</p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="_sample_development_configuration_6">Sample development configuration</h6>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>server:
  port: 2200
operatorfabric:
  security:
    provider-url: http://localhost:89
    provider-realm: dev
    logout-url: ${operatorfabric.security.provider-url}/auth/realms/${operatorfabric.security.provider-realm}/protocol/openid-connect/logout?redirect_uri=http://localhost:2002/ui/
    oauth2:
      flow:
        mode: CODE
        provider: Opfab Keycloak
        delagate-url: ${operatorfabric.security.provider-url}/auth/realms/${operatorfabric.security.provider-realm}/protocol/openid-connect/auth?response_type=code&amp;client_id=opfab-client
  feed:
    subscription:
      timeout: 600000
    card:
      time:
        display: BUSINESS
    timeline:
      domains:
        - "TR"
        - "J"
        - "7D"
        - "W"
        - "M"
        - "Y"
    notify: false
  archive:
    filters:
      page.size:
        - "10"
      page.first:
        - "0"
      publisher.list:
        - value: "TEST"
          label: "Test Publisher"
        - value: "TEST2"
          label: "Test Publisher 2"
      process.list:
            - process
            - someOtherProcess
      tags.list:
        - value: "tag1"
          label: "Label for tag 1"
        - value: "tag2"
          label: "Label for tag 2"
  i10n.supported.time-zones:
    - value: "Europe/Paris"
      label: "Headquarters timezone"
    - value: "Australia/Melbourne"
      label: "Down Under"
    - Europe/London
    - Europe/Dublin
    - Europe/Brussel
    - Europe/Berlin
    - Europe/Rome
    - Europe/Madrid
    - Europe/Lisbon
    - Europe/Amsterdam
    - Europe/Athens
    - Pacific/Samoa
  i18n.supported.locales:
    - en
    - fr
  settings:
    locale: en
    infos:
      description: true
    about:
      firstapplication:
        name: First application
        version: v12.34.56
        rank: 1
      keycloack:
        name: Keycloak
        version: 6.0.1
        rank: 2
      lastapplication:
          name: Wonderful Solution
          version: 0.1.2-RELEASE
  time:
    pulse: 5000</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_sample_docker_image_configuration_7">Sample docker image configuration</h6>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>server:
  port: 2200
operatorfabric:
  security:
    provider-url: http://localhost:89
    provider-realm: dev
    logout-url: ${operatorfabric.security.provider-url}/auth/realms/${operatorfabric.security.provider-realm}/protocol/openid-connect/logout?redirect_uri=http://localhost:2002/ui/
    oauth2:
      flow:
        mode: CODE
        provider: Opfab Keycloak
        delagate-url: ${operatorfabric.security.provider-url}/auth/realms/${operatorfabric.security.provider-realm}/protocol/openid-connect/auth?response_type=code&amp;client_id=opfab-client
  feed:
    subscription:
      timeout: 600000
    card:
      time:
        display: BUSINESS
    timeline:
      domains:
        - "TR"
        - "J"
        - "7D"
        - "W"
        - "M"
        - "Y"
    notify: false
  archive:
    filters:
      page.size:
        - "10"
      page.first:
        - "0"
      publisher.list:
        - value: "TEST"
          label: "Test Publisher"
        - value: "TEST2"
          label: "Test Publisher 2"
      process.list:
            - process
            - someOtherProcess
      tags.list:
        - value: "tag1"
          label: "Label for tag 1"
        - value: "tag2"
          label: "Label for tag 2"
  i10n.supported.time-zones:
    - value: "Europe/Paris"
      label: "Headquarters timezone"
    - value: "Australia/Melbourne"
      label: "Down Under"
    - Europe/London
    - Europe/Dublin
    - Europe/Brussel
    - Europe/Berlin
    - Europe/Rome
    - Europe/Madrid
    - Europe/Lisbon
    - Europe/Amsterdam
    - Europe/Athens
    - Pacific/Samoa
  i18n.supported.locales:
    - en
    - fr
  settings:
    locale: en
    infos:
      description: true
    about:
      firstapplication:
        name: First application
        version: v12.34.56
        rank: 1
      keycloack:
        name: Keycloak
        version: 6.0.1
        rank: 2
      lastapplication:
          name: Wonderful Solution
          version: 0.1.2-RELEASE
  time:
    pulse: 5000</code></pre>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_specifying_external_configuration_properties_when_lauching_a_jar_file_4">Specifying external configuration properties when lauching a jar file</h5>
<div class="paragraph">
<p>See <a href="https://docs.spring.io/spring-boot/docs/2.1.2.RELEASE//reference/htmlsingle/#boot-features-external-config-application-property-files">Application Property Files</a>
on how to setup an external spring properties or yml file.</p>
</div>
<div class="paragraph">
<p>See <a href="https://docs.spring.io/spring-boot/docs/2.1.2.RELEASE//reference/htmlsingle/#howto-set-active-spring-profiles">Set the Active Spring Profiles</a> for specifying alternate profile.</p>
</div>
</div>
<div class="sect4">
<h5 id="_specifying_configuration_properties_when_lauching_a_docker_image_4">Specifying configuration properties when lauching a docker image</h5>
<div class="paragraph">
<p>Our docker image expects optional property file to be stored in the container
/service-config folder. You can bind so docker volume to this path to make
properties or yml available.</p>
</div>
<div class="paragraph">
<p>At time of writing, you cannot specify an alternate profile at runCards-Publication.
The default profiles activated are docker and native.</p>
</div>
<div class="sect5">
<h6 id="_available_environment_variables_for_docker_image_9">Available environment variables for docker image</h6>
<div class="ulist">
<ul>
<li>
<p>REGISTRY_HOST: Registry service host</p>
</li>
<li>
<p>REGISTRY_PORT: Registry service port</p>
</li>
<li>
<p>JAVA_OPTIONS: Additional java options</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_specifying_configuration_properties_when_lauching_on_kubernetes_4">Specifying configuration properties when lauching on Kubernetes</h5>
<div class="paragraph">
<p>In progress</p>
</div>
<div class="sect5">
<h6 id="_available_environment_variables_when_launching_on_kubernetes_9">Available environment variables when launching on Kubernetes</h6>
<div class="ulist">
<ul>
<li>
<p>REGISTRY_HOST: Registry service host</p>
</li>
<li>
<p>REGISTRY_PORT: Registry service port</p>
</li>
<li>
<p>JAVA_OPTIONS: Additional java options</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_users_and_groups_administration">4.5. Users and Groups Administration</h3>
<div class="paragraph">
<p>A new operator call John Doe, who has OAuth granted right to connect ot current <code>OperatorFabric</code> instance, need to receive cards within current <code>OperatorFabric</code> instance. As a user of OperatorFabric, he needs to be added to the system with a <code>login</code> (john-doe-operator), his <code>firstName</code> (John) and his <code>lastName</code> (Doe).
operator
As there is no <code>Administration GUI</code> for the moment, it must be performed through command line, as detailed in the Users API.</p>
</div>
<div class="sect3">
<h4 id="_list_all_users">4.5.1. List all users</h4>
<div class="paragraph">
<p>First of all, list the users (who are the recipients in OperatorFabric) of the system with the following commands:</p>
</div>
<div class="paragraph">
<p>Httpie</p>
</div>
<div class="literalblock">
<div class="content">
<pre>http http://localhost:2103/users "Authorization:Bearer $token" "Content-Type:application/type"</pre>
</div>
</div>
<div class="paragraph">
<p>cURL</p>
</div>
<div class="literalblock">
<div class="content">
<pre>curl -v http://localhost:2103/users -H "Authorization:Bearer $token" -H "Content-Type:application/type"</pre>
</div>
</div>
<div class="paragraph">
<p>response</p>
</div>
<div class="literalblock">
<div class="content">
<pre>HTTP/1.1 200 OK

[
    {
        "firstName": null,
        "groups": [
            "ADMIN"
        ],
        "lastName": null,
        "login": "admin"
    },
    {
        "firstName": null,
        "groups": [
            "RTE",
            "ADMIN",
            "CORESO",
            "TRANS",
            "TEST"
        ],
        "lastName": null,
        "login": "rte-operator"
    },
    {
        "firstName": null,
        "groups": [
            "ELIA"
        ],
        "lastName": null,
        "login": "elia-operator"
    },
    {
        "firstName": null,
        "groups": [
            "CORESO"
        ],
        "lastName": null,
        "login": "coreso-operator"
    },
    {
        "firstName": null,
        "groups": [
            "TSO1",
            "TRANS",
            "TEST"
        ],
        "lastName": null,
        "login": "tso1-operator"
    },
    {
        "firstName": null,
        "groups": [
            "TSO2",
            "TRANS"
        ],
        "lastName": null,
        "login": "tso2-operator"
    },
]</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_create_a_new_user">4.5.2. Create a new User</h4>
<div class="paragraph">
<p>We are sure that no John-doe-operator exists in our OperatorFabric instance. We can add him in our OperatorFabric instance using the following command use httpie:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>echo '{"login":"john-doe-operator","firstName":"Jahne","lastName":"Doe"}' | http POST http://localhost:2103/users "Authorization:Bearer $token" "Content-Type:application/json"</pre>
</div>
</div>
<div class="paragraph">
<p>Or here cURL:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>curl -X POST http://localhost:2103/users -H "Authorization:Bearer $token" -H "Content-Type:application/json" --data '{"login":"john-doe-operator","firstName":"Jahne","lastName":"Doe"}'</pre>
</div>
</div>
<div class="paragraph">
<p>response</p>
</div>
<div class="literalblock">
<div class="content">
<pre>HTTP/1.1 200 OK

{
    "firstName": "Jahne",
    "lastName": "Doe",
    "login": "john-doe-operator"
}</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_fetch_user_details">4.5.3. Fetch user details</h4>
<div class="paragraph">
<p>It&#8217;s always a good thing to verify if all the information has been correctly recorded in the system:</p>
</div>
<div class="paragraph">
<p>with httpie:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>http -b http://localhost:2103/users/john-doe-operator "Authorization:Bearer $token" "Content-Type:application/json"</pre>
</div>
</div>
<div class="paragraph">
<p>or with cURL:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>curl http://localhost:2103/users/john-doe-operator -H "Authorization:Bearer $token" -H "Content-Type:application/json"</pre>
</div>
</div>
<div class="paragraph">
<p>response</p>
</div>
<div class="literalblock">
<div class="content">
<pre>HTTP/1.1 200 OK

{
    "firstName": "Jahne",
    "groups": [],
    "lastName": "Doe",
    "login": "john-doe-operator"
}</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_update_user_details">4.5.4. Update user details</h4>
<div class="paragraph">
<p>As shown by this result, the firstName of the new operator has been misspelled.We need
<a href="../../../../documentation/current/api/users/index.html#/users/updateUser">to update the existing user</a>
with <code>john-doe-operator</code> login. To correct this mistake, the following commands can be used:</p>
</div>
<div class="paragraph">
<p>with httpie:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>echo '{"login":"john-doe-operator","lastName":"Doe","firstName":"John"}' | http PUT http://localhost:2103/users/john-doe-operator "Authorization:Bearer $token" "Content-Type:application/json"</pre>
</div>
</div>
<div class="paragraph">
<p>or with cURL:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>curl -X PUT http://localhost:2103/users/john-doe-operator -H "Authorization:Bearer $token" -H "Content-Type:application/json" --data '{"login":"john-doe-operator","firstName":"John","lastName":"Doe"}'</pre>
</div>
</div>
<div class="paragraph">
<p>response</p>
</div>
<div class="literalblock">
<div class="content">
<pre>HTTP/1.1 200 OK

{
    "firstName": "John",
    "lastName": "Doe",
    "login": "john-doe-operator"
}</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_list_groups">4.5.5. List groups</h4>
<div class="paragraph">
<p>This operator is the first member of a new group operator called the <code>OPERATORS</code>, which doesn&#8217;t exist for the moment in
the system. As shown when we
<a href="../../../../documentation/current/api/users/index.html#/groups/fetchGroups">list the groups</a>
existing in the server.</p>
</div>
<div class="paragraph">
<p>Httpie</p>
</div>
<div class="literalblock">
<div class="content">
<pre>http http://localhost:2103/groups "Authorization:Bearer $token" "Content-Type:application/type"</pre>
</div>
</div>
<div class="paragraph">
<p>cURL</p>
</div>
<div class="literalblock">
<div class="content">
<pre>curl http://localhost:2103/groups -H "Authorization:Bearer $token" -H "Content-Type:application/json"</pre>
</div>
</div>
<div class="paragraph">
<p>response</p>
</div>
<div class="literalblock">
<div class="content">
<pre>HTTP/1.1 200 OK

[
    {
        "description": "The admin group",
        "name": "ADMIN"
    },
    {
        "description": "RTE TSO Group",
        "name": "RTE"
    },
    {
        "description": "ELIA TSO group",
        "name": "ELIA"
    },
    {
        "description": "CORESO Group",
        "name": "CORESO"
    },
    {
        "description": "TSO 1 Group",
        "name": "TSO1"
    },
    {
        "description": "TSO 2 Group",
        "name": "TSO2"
    },
    {
        "description": "Transnationnal Group",
        "name": "TRANS"
    }
]</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_create_a_new_group">4.5.6. Create a new Group</h4>
<div class="paragraph">
<p>Firstly, the group called <code>OPERATORS</code> has to be
<a href="../../../../documentation/current/api/users/index.html#/groups/createGroup">added to the system</a>
using the following command:</p>
</div>
<div class="paragraph">
<p>using httpie:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>echo '{"name":"OPERATORS","decription":"This is the brand new  group of operator"}' | http POST http://localhost:2103/groups "Authorization:Bearer $token" "Content-Type:application/json"</pre>
</div>
</div>
<div class="paragraph">
<p>using cURL:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>curl -X POST http://localhost:2103/groups -H "Authorization:Bearer $token" -H "Content-Type:application/json" --data '{"name":"OPERATORS","decription":"This is the brand new  group of operator"}'</pre>
</div>
</div>
<div class="paragraph">
<p>response</p>
</div>
<div class="literalblock">
<div class="content">
<pre>HTTP/1.1 200 OK

{
    "description": null,
    "name": "OPERATORS"
}</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_fetch_details_of_a_given_group">4.5.7. Fetch details of a given group</h4>
<div class="paragraph">
<p>The result returned seems strange, to verify if it&#8217;s the correct answer by
<a href="../../../../documentation/current/api/users/index.html#/groups/fetchGroup">displaying the details of the group</a>
called <code>OPERATORS</code>, use the following command:</p>
</div>
<div class="paragraph">
<p>using httpie:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>http http://localhost:2103/groups/OPERATORS "Authorization:Bearer $token" "Content-Type:application/json"</pre>
</div>
</div>
<div class="paragraph">
<p>using cURL:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>curl http://localhost:2103/groups/OPERATORS -H "Authorization:Bearer $token" -H "Content-Type:application/json"</pre>
</div>
</div>
<div class="paragraph">
<p>response</p>
</div>
<div class="literalblock">
<div class="content">
<pre>HTTP/1.1 200 OK

{
    "description": null,
    "name": "OPERATORS"
}</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_update_details_of_a_group">4.5.8. Update details of a group</h4>
<div class="paragraph">
<p>The description is really null. After verification, in our first command used to create the group,
the attribute for the description is misspelled. Using the following command
<a href="../../../../documentation/current/api/users/index.html#/groups/updateGroup">to update the group</a>
with the correct spelling, the new group of operator gets a proper description:</p>
</div>
<div class="paragraph">
<p>with httpie:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>echo '{"name":"OPERATORS","description":"This is the brand new  group of operator"}' | http -b PUT http://localhost:2103/groups/OPERATORS "Authorization:Bearer $token" "Content-Type:application/json"</pre>
</div>
</div>
<div class="paragraph">
<p>with cURL:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>curl -X PUT http://localhost:2103/groups/OPERATORS -H "Authorization:Bearer $token" -H "Content-Type:application/json" --data '{"name":"OPERATORS","description":"This is the brand new  group of operator"}'</pre>
</div>
</div>
<div class="paragraph">
<p>response</p>
</div>
<div class="literalblock">
<div class="content">
<pre>{
    "description": "This is the brand new  group of operator",
    "name": "OPERATORS"
}</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_add_a_user_to_a_group">4.5.9. Add a user to a group</h4>
<div class="paragraph">
<p>As both new group and new user are correct it&#8217;s time
<a href="../../../../documentation/current/api/users/index.html#/users/addGroupUsers">to make the user a member of the group</a>
. To achieve this, use the following command:</p>
</div>
<div class="paragraph">
<p>with httpie:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>echo '["john-doe-operator"]' | http PATCH http://localhost:2103/groups/OPERATORS/users "Authorization:Bearer $token" "Content-Type:application/json"</pre>
</div>
</div>
<div class="paragraph">
<p>with cURL:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>curl -X PATCH http://localhost:2103/groups/OPERATORS/users -H "Authorization:Bearer $token" -H "Content-Type:application/json" --data '["john-doe-operator"]'</pre>
</div>
</div>
<div class="paragraph">
<p>response</p>
</div>
<div class="literalblock">
<div class="content">
<pre>HTTP/1.1 200 OK</pre>
</div>
</div>
<div class="paragraph">
<p>Let&#8217;s verify that the changes are correctly recorded by fetching the :</p>
</div>
<div class="literalblock">
<div class="content">
<pre>http http://localhost:2103/users/john-doe-operator "Authorization:Bearer $token" "Content-Type:application/json"</pre>
</div>
</div>
<div class="paragraph">
<p>with cURL</p>
</div>
<div class="literalblock">
<div class="content">
<pre>curl http://localhost:2103/users/john-doe-operator -H "Authorization:Bearer $token" -H "Content-Type:application/json"</pre>
</div>
</div>
<div class="paragraph">
<p>response</p>
</div>
<div class="literalblock">
<div class="content">
<pre>HTTP/1.1 200 OK

{
    "firstName": "John",
    "groups": ["OPERATORS"],
    "lastName": "Doe",
    "login": "john-doe-operator"
}</pre>
</div>
</div>
<div class="paragraph">
<p>It&#8217;s now possible to send cards either specifically to <code>john-doe-operator</code> or more generally to the <code>OPERATORS</code> group.</p>
</div>
</div>
<div class="sect3">
<h4 id="_remove_a_user_from_a_group">4.5.10. Remove a user from a Group</h4>
<div class="paragraph">
<p>When John Doe is no longer in charge of hypervising cards for <code>OPERATORS</code> group, this group has to be removed from his login by using the following command:</p>
</div>
<div class="paragraph">
<p>with httpie:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>http DELETE http://localhost:2103/groups/OPERATORS/users/john-doe-operator "Authorization:Bearer $token"</pre>
</div>
</div>
<div class="paragraph">
<p>with cURL:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>curl -X DELETE -H "Authorization:Bearer $token" http://localhost:2103/groups/OPERATORS/users/john-doe-operator</pre>
</div>
</div>
<div class="paragraph">
<p>response</p>
</div>
<div class="literalblock">
<div class="content">
<pre>HTTP/1.1 200 OK

{
	"login":"john-doe-operator","
	firstName":"John",
	"lastName":"Doe",
	"groups":[]
}</pre>
</div>
</div>
<div class="paragraph">
<p>A last command to verify that <code>OPERATORS</code> is no longer linked to <code>john-doe-operator</code>:</p>
</div>
<div class="paragraph">
<p>with httpie:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>http http://localhost:2103/users/john-doe-operator "Authorization:Bearer $token" "Content-Type:application/json"</pre>
</div>
</div>
<div class="paragraph">
<p>with cURL:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>curl http://localhost:2103/users/john-doe-operator -H "Authorization:Bearer $token" -H "Content-Type:application/json"</pre>
</div>
</div>
<div class="paragraph">
<p>response</p>
</div>
<div class="literalblock">
<div class="content">
<pre>HTTP/1.1 200 OK

{
    "firstName": "John",
    "groups": [],
    "lastName": "Doe",
    "login": "coreso-operator"

}</pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_service_port_table">5. Service port table</h2>
<div class="sectionbody">
<div class="paragraph">
<p>By default all service built artifacts are configured with server.port set
to 8080</p>
</div>
<div class="paragraph">
<p>If you run the services using <code>bootRun</code> Gradle task or the provided
docker-compose files (see [prj]/src/main/docker) the ports used are</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Service</th>
<th class="tableblock halign-right valign-top">bootRun port</th>
<th class="tableblock halign-right valign-top">docker-compose mapping</th>
<th class="tableblock halign-right valign-top">docker-compose debug mapping</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">registry</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">2001</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">2001</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">2001</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gateway</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">2002</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">2002</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">2002</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">thirds</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">2100</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">2100</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">2100</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">cards-publication</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">2102</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">2102</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">2102</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">users</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">2103</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">2103</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">2103</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">cards-consultation</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">2104</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">2104</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">2104</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">config</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">4000</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">4000</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">4000</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">registry</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">4001</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">4001</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">4001</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gateway</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">4002</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">4002</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">4002</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">thirds</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">4100</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">4100</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">4100</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">cards-publication</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">4102</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">4102</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">4102</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">users</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">4103</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">4103</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">4103</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">cards-consultation</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">4103</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">4103</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">4103</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p> <details><summary> 
<strong>Complete port table</strong>
 </summary><div> </p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Port</th>
<th class="tableblock halign-left valign-top">Forwards to</th>
<th class="tableblock halign-left valign-top"></th>
<th class="tableblock halign-left valign-top"></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">89</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">KeyCloak</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">89</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">KeyCloak api port</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2000</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">config</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">8080</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Configuration service http (REST)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2001</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">registry</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">8080</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Registry service http (REST)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2002</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">gateway</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">8080</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Gateway service http (REST+html)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2100</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">thirds</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">8080</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Third party management service http (REST)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2102</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">cards-publication</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">8080</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">card publication service http (REST)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2103</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">users</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">8080</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Users management service http (REST)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2104</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">cards-consultation</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">8080</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">card consultation service http (REST)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2105</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">actions</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">8080</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">actions (REST)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2200</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">web-ui</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">8080</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">card consultation service http (REST)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">4000</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">config</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5005</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">java debug port</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">4001</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">registry</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5005</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">java debug port</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">4002</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">gateway</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5005</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">java debug port</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">4100</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">thirds</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5005</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">java debug port</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">4102</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">cards-publication</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5005</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">java debug port</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">4103</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">users</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5005</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">java debug port</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">4104</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">cards-consultation</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5005</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">java debug port</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">4105</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">actions</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5005</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">java debug port</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">4200</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">web-ui</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5005</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">java debug port</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">27017</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">mongo</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">27017</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">mongo api port</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">5672</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">rabbitmq</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5672</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">amqp api port</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">15672</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">rabbitmq</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">15672</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">rabbitmq api port</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p> </div></details> </p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_restricted_operations_administration">6. Restricted operations (administration)</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Some operations are restricted to users with the <strong>ADMIN</strong> role, either because they are administration
operations with the potential to impact the OperatorFabric instance as a whole, or because they
give access to information that should be private to a user.</p>
</div>
<div class="paragraph">
<p>Below is a quick recap of these restricted operations.</p>
</div>
<div class="paragraph">
<div class="title">Users Service</div>
<p>Any action (read, create/update or delete) regarding a single user&#8217;s data (their personal info such as their first and
last name, as well as their settings) can be performed either by the user in question or by a user with the ADMIN role.</p>
</div>
<div class="paragraph">
<p>Any action on a list of users or on the groups (if authorization is managed in OperatorFabric) can only be performed by
a user with the ADMIN role.</p>
</div>
<div class="paragraph">
<div class="title">Thirds Service</div>
<p>Any write (create, update or delete) action on bundles can only be performed by a user with the ADMIN role. As such,
administrators are responsible for the quality and security of the provided bundles.
In particular, as it is possible to use scripts in templates, they should perform a security check to make sure that
there is no XSS risk.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
The ADMIN role doesn&#8217;t grant any special privileges when it comes to card consultation (be they current or
archived), so an user with the ADMIN role will only see cards that have been addressed to them or to one of their
groups), just like any other user.
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
</body>
</html>