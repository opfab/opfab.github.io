<!DOCTYPE html>
<html lang="">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.18">
<title>Resources</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/*! Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment the following line when using as a custom stylesheet */
/* @import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700"; */
html{font-family:sans-serif;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
b,strong{font-weight:bold}
abbr{font-size:.9em}
abbr[title]{cursor:help;border-bottom:1px dotted #dddddf;text-decoration:none}
dfn{font-style:italic}
hr{height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type=button],input[type=reset],input[type=submit]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type=checkbox],input[type=radio]{padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,::before,::after{box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;line-height:1;position:relative;cursor:auto;-moz-tab-size:4;-o-tab-size:4;tab-size:4;word-wrap:anywhere;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ul.square{list-style-type:square}
ul.circle ul:not([class]),ul.disc ul:not([class]),ul.square ul:not([class]){list-style:inherit}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:1px solid #dedede;word-wrap:normal}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre).nobreak{word-wrap:normal}
:not(pre).nowrap{white-space:nowrap}
:not(pre).pre-wrap{white-space:pre-wrap}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;border-radius:3px;box-shadow:0 1px 0 rgba(0,0,0,.2),inset 0 0 0 .1em #fff;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin:0 auto;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:flex;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border:1px solid #e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:none;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:hsla(0,0%,100%,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details{margin-left:1.25rem}
details>summary{cursor:pointer;display:block;position:relative;line-height:1.6;margin-bottom:.625rem;outline:none;-webkit-tap-highlight-color:transparent}
details>summary::-webkit-details-marker{display:none}
details>summary::before{content:"";border:solid transparent;border-left:solid;border-width:.3em 0 .3em .5em;position:absolute;top:.5em;left:-1.25rem;transform:translateX(15%)}
details[open]>summary::before{border:solid transparent;border-top:solid;border-width:.5em .3em 0;transform:translateY(15%)}
details>summary::after{content:"";width:1.25rem;height:1em;position:absolute;top:.3em;left:-1.25rem}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class=paragraph]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6);word-wrap:anywhere}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border:1px solid #e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border:1px solid #dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{border-radius:4px;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class=highlight],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos,pre.pygments .linenos{border-right:1px solid;opacity:.35;padding-right:.5em;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}
pre.pygments span.linenos{display:inline-block;margin-right:.75em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans-serif;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;font-size:.85rem;text-align:left;margin-right:0}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:1.25em;word-wrap:anywhere}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>*>tr>*{border-width:1px}
table.grid-cols>*>tr>*{border-width:0 1px}
table.grid-rows>*>tr>*{border-width:1px 0}
table.frame-all{border-width:1px}
table.frame-ends{border-width:1px 0}
table.frame-sides{border-width:0 1px}
table.frame-none>colgroup+*>:first-child>*,table.frame-sides>colgroup+*>:first-child>*{border-top-width:0}
table.frame-none>:last-child>:last-child>*,table.frame-sides>:last-child>:last-child>*{border-bottom-width:0}
table.frame-none>*>tr>:first-child,table.frame-ends>*>tr>:first-child{border-left-width:0}
table.frame-none>*>tr>:last-child,table.frame-ends>*>tr>:last-child{border-right-width:0}
table.stripes-all>*>tr,table.stripes-odd>*>tr:nth-of-type(odd),table.stripes-even>*>tr:nth-of-type(even),table.stripes-hover>*>tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
li>p:empty:only-child::before{content:"";display:inline-block}
ul.checklist>li>p:first-child{margin-left:-1em}
ul.checklist>li>p:first-child>.fa-square-o:first-child,ul.checklist>li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist>li>p:first-child>input[type=checkbox]:first-child{margin-right:.25em}
ul.inline{display:flex;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
td.hdlist2{word-wrap:anywhere}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:4px solid #fff;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);border-radius:50%;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt,summary{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt,summary{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]{border-bottom:1px dotted}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#header,#content,#footnotes,#footer{max-width:none}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media amzn-kf8,print{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<style>
/*! Stylesheet for CodeRay to loosely match GitHub themes | MIT License */
pre.CodeRay{background:#f7f7f8}
.CodeRay .line-numbers{border-right:1px solid;opacity:.35;padding:0 .5em 0 0;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}
.CodeRay span.line-numbers{display:inline-block;margin-right:.75em}
.CodeRay .line-numbers strong{color:#000}
table.CodeRay{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.CodeRay td{vertical-align:top;line-height:inherit}
table.CodeRay td.line-numbers{text-align:right}
table.CodeRay td.code{padding:0 0 0 .75em}
.CodeRay .debug{color:#fff!important;background:navy!important}
.CodeRay .annotation{color:#007}
.CodeRay .attribute-name{color:navy}
.CodeRay .attribute-value{color:#700}
.CodeRay .binary{color:#509}
.CodeRay .comment{color:#998;font-style:italic}
.CodeRay .char{color:#04d}
.CodeRay .char .content{color:#04d}
.CodeRay .char .delimiter{color:#039}
.CodeRay .class{color:#458;font-weight:bold}
.CodeRay .complex{color:#a08}
.CodeRay .constant,.CodeRay .predefined-constant{color:teal}
.CodeRay .color{color:#099}
.CodeRay .class-variable{color:#369}
.CodeRay .decorator{color:#b0b}
.CodeRay .definition{color:#099}
.CodeRay .delimiter{color:#000}
.CodeRay .doc{color:#970}
.CodeRay .doctype{color:#34b}
.CodeRay .doc-string{color:#d42}
.CodeRay .escape{color:#666}
.CodeRay .entity{color:#800}
.CodeRay .error{color:#808}
.CodeRay .exception{color:inherit}
.CodeRay .filename{color:#099}
.CodeRay .function{color:#900;font-weight:bold}
.CodeRay .global-variable{color:teal}
.CodeRay .hex{color:#058}
.CodeRay .integer,.CodeRay .float{color:#099}
.CodeRay .include{color:#555}
.CodeRay .inline{color:#000}
.CodeRay .inline .inline{background:#ccc}
.CodeRay .inline .inline .inline{background:#bbb}
.CodeRay .inline .inline-delimiter{color:#d14}
.CodeRay .inline-delimiter{color:#d14}
.CodeRay .important{color:#555;font-weight:bold}
.CodeRay .interpreted{color:#b2b}
.CodeRay .instance-variable{color:teal}
.CodeRay .label{color:#970}
.CodeRay .local-variable{color:#963}
.CodeRay .octal{color:#40e}
.CodeRay .predefined{color:#369}
.CodeRay .preprocessor{color:#579}
.CodeRay .pseudo-class{color:#555}
.CodeRay .directive{font-weight:bold}
.CodeRay .type{font-weight:bold}
.CodeRay .predefined-type{color:inherit}
.CodeRay .reserved,.CodeRay .keyword{color:#000;font-weight:bold}
.CodeRay .key{color:#808}
.CodeRay .key .delimiter{color:#606}
.CodeRay .key .char{color:#80f}
.CodeRay .value{color:#088}
.CodeRay .regexp .delimiter{color:#808}
.CodeRay .regexp .content{color:#808}
.CodeRay .regexp .modifier{color:#808}
.CodeRay .regexp .char{color:#d14}
.CodeRay .regexp .function{color:#404;font-weight:bold}
.CodeRay .string{color:#d20}
.CodeRay .string .string .string{background:#ffd0d0}
.CodeRay .string .content{color:#d14}
.CodeRay .string .char{color:#d14}
.CodeRay .string .delimiter{color:#d14}
.CodeRay .shell{color:#d14}
.CodeRay .shell .delimiter{color:#d14}
.CodeRay .symbol{color:#990073}
.CodeRay .symbol .content{color:#a60}
.CodeRay .symbol .delimiter{color:#630}
.CodeRay .tag{color:teal}
.CodeRay .tag-special{color:#d70}
.CodeRay .variable{color:#036}
.CodeRay .insert{background:#afa}
.CodeRay .delete{background:#faa}
.CodeRay .change{color:#aaf;background:#007}
.CodeRay .head{color:#f8f;background:#505}
.CodeRay .insert .insert{color:#080}
.CodeRay .delete .delete{color:#800}
.CodeRay .change .change{color:#66f}
.CodeRay .head .head{color:#f4f}
</style>
</head>
<body class="article toc2 toc-left">
<div id="header">
<h1>Resources</h1>
<div class="details">
<span id="revnumber">version 4.9.0.RELEASE,</span>
<span id="revdate">05 September 2025</span>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_appendix_b_publication_of_the_client_library_jars_to_maven_central">1. Appendix B: Publication of the client library jars to Maven Central</a>
<ul class="sectlevel2">
<li><a href="#_claiming_the_org_opfab_namespace_on_maven_central">1.1. Claiming the org.opfab namespace on Maven Central</a></li>
<li><a href="#_creating_a_gpg_key_pair">1.2. Creating a GPG key pair</a></li>
<li><a href="#_sharing_the_signing_key">1.3. Sharing the signing key</a></li>
<li><a href="#_publishing_the_public_key">1.4. Publishing the public key</a></li>
<li><a href="#_setting_up_the_signing_and_publication_in_gradle">1.5. Setting up the signing and publication in Gradle</a></li>
<li><a href="#_useful_links">1.6. Useful links</a></li>
</ul>
</li>
<li><a href="#_migration_guide_from_release_3_0_0_to_release_3_1_0">2. Migration Guide from release 3.0.0 to release 3.1.0</a>
<ul class="sectlevel2">
<li><a href="#_kafka_date_format">2.1. Kafka date format</a></li>
</ul>
</li>
<li><a href="#_migration_guide_from_release_3_1_0_to_release_3_2_0">3. Migration Guide from release 3.1.0 to release 3.2.0</a>
<ul class="sectlevel2">
<li><a href="#_cache_configuration_for_i18n_files">3.1. Cache configuration for i18n files</a></li>
<li><a href="#_tag_feed_filter_removal">3.2. Tag feed filter removal</a></li>
</ul>
</li>
<li><a href="#_migration_guide_from_release_3_4_0_to_release_3_5_0">4. Migration Guide from release 3.4.0 to release 3.5.0</a>
<ul class="sectlevel2">
<li><a href="#_timezone_management_removal">4.1. Timezone management removal</a></li>
<li><a href="#_kafka_card_format_changes">4.2. Kafka card format changes</a>
<ul class="sectlevel3">
<li><a href="#_redirect_to_business_application_from_a_card">4.2.1. Redirect to business application from a card</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_migration_guide_from_release_3_5_0_to_release_3_6_0">5. Migration Guide from release 3.5.0 to release 3.6.0</a>
<ul class="sectlevel2">
<li><a href="#_template_rendering">5.1. Template rendering</a></li>
<li><a href="#_mongo_data_migration_steps">5.2. Mongo data migration steps</a></li>
<li><a href="#_about_screen">5.3. About screen</a></li>
<li><a href="#_deprecated_feature">5.4. Deprecated feature</a>
<ul class="sectlevel3">
<li><a href="#_method_templategateway_getspecificcardinformation">5.4.1. Method templateGateway.getSpecificCardInformation()</a></li>
<li><a href="#_restrict_recipient_dropdown_list_for_user">5.4.2. Restrict recipient dropdown list for user</a></li>
<li><a href="#_set_the_list_of_recipients">5.4.3. Set the list of recipients</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_migration_guide_from_release_3_6_0_to_release_3_7_0">6. Migration Guide from release 3.6.0 to release 3.7.0</a>
<ul class="sectlevel2">
<li><a href="#_docker_images_names_changed">6.1. Docker images names changed</a></li>
<li><a href="#_third_parties_configuration">6.2. Third parties configuration</a></li>
<li><a href="#_rename_attribute_externaldeviceid">6.3. Rename attribute externalDeviceId</a>
<ul class="sectlevel3">
<li><a href="#_in_the_configuration_file">6.3.1. In the configuration file</a></li>
<li><a href="#_changes_in_the_mongo_data_base">6.3.2. Changes in the Mongo data base</a>
<ul class="sectlevel4">
<li><a href="#_before_the_migration">6.3.2.1. Before the migration</a></li>
<li><a href="#_once_the_migration_is_done">6.3.2.2. Once the migration is done</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_deprecated_feature_2">6.4. Deprecated feature</a>
<ul class="sectlevel3">
<li><a href="#_field_recurrence">6.4.1. Field recurrence</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_migration_guide_from_release_3_7_0_to_release_3_8_0">7. Migration Guide from release 3.7.0 to release 3.8.0</a>
<ul class="sectlevel2">
<li><a href="#_kafka_card_format_changes_2">7.1. Kafka card format changes</a></li>
</ul>
</li>
<li><a href="#_migration_guide_from_release_3_8_x_to_release_3_9_0">8. Migration Guide from release 3.8.x to release 3.9.0</a>
<ul class="sectlevel2">
<li><a href="#_web_ui_json_config_file">8.1. <code>web-ui.json</code> config file</a></li>
</ul>
</li>
<li><a href="#_migration_guide_from_release_3_9_x_to_release_3_10_0">9. Migration Guide from release 3.9.x to release 3.10.0</a>
<ul class="sectlevel2">
<li><a href="#_card_publication_with_not_existent_process_or_state">9.1. Card publication with not existent process or state</a></li>
<li><a href="#_web_ui_json_config_file_2">9.2. <code>web-ui.json</code> config file</a>
<ul class="sectlevel3">
<li><a href="#_settings_about_section">9.2.1. <code>settings.about</code> section</a></li>
<li><a href="#_settings_infos_hide_section">9.2.2. <code>settings.infos.hide</code> section</a></li>
<li><a href="#_feed_filtering_and_sorting">9.2.3. Feed filtering and sorting</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_migration_guide_from_release_3_10_x_to_release_3_11_0">10. Migration Guide from release 3.10.x to release 3.11.0</a>
<ul class="sectlevel2">
<li><a href="#_card_publication">10.1. Card publication</a></li>
<li><a href="#_templategateway_onstylechange_method">10.2. templateGateway <code>onStyleChange()</code> method</a></li>
<li><a href="#_nginx_configuration">10.3. Nginx configuration</a></li>
</ul>
</li>
<li><a href="#_migration_guide_from_release_3_11_x_to_release_3_12_0">11. Migration Guide from release 3.11.x to release 3.12.0</a>
<ul class="sectlevel2">
<li><a href="#_java_17">11.1. Java 17</a></li>
<li><a href="#_expiration_date">11.2. Expiration date</a></li>
<li><a href="#_remove_deprecated_method_templategateway_getspecificcardinformation">11.3. Remove deprecated method templateGateway.getSpecificCardInformation()</a></li>
<li><a href="#_nginx_configuration_2">11.4. Nginx configuration</a></li>
</ul>
</li>
<li><a href="#_migration_guide_from_release_3_12_0_to_release_3_13_0">12. Migration Guide from release 3.12.0 to release 3.13.0</a>
<ul class="sectlevel2">
<li><a href="#_trailing_slash">12.1. Trailing slash</a></li>
<li><a href="#_viewcardinagenda_parameter_renamed">12.2. viewCardInAgenda Parameter renamed</a></li>
<li><a href="#_default_value_set_to_false_for_lttdvisible_and_expirationdatevisible">12.3. Default value set to false for lttdVisible and expirationDateVisible</a></li>
</ul>
</li>
<li><a href="#_migration_guide_from_release_3_13_0_to_release_3_14_0">13. Migration Guide from release 3.13.0 to release 3.14.0</a>
<ul class="sectlevel2">
<li><a href="#_bundles_folder">13.1. Bundles folder</a></li>
</ul>
</li>
<li><a href="#_migration_guide_from_release_3_14_0_to_release_3_15_0">14. Migration Guide from release 3.14.0 to release 3.15.0</a>
<ul class="sectlevel2">
<li><a href="#_crossorigin_for_geojson">14.1. CrossOrigin for GeoJSON</a></li>
<li><a href="#_remove_deprecated_field_from_state_definition">14.2. Remove deprecated field from state definition</a></li>
<li><a href="#_remove_use_of_groups_column_in_realtime_screen">14.3. Remove use of groups column in realtime screen</a></li>
</ul>
</li>
<li><a href="#_migration_guide_from_release_3_15_0_to_release_4_0_0">15. Migration Guide from release 3.15.0 to release 4.0.0</a>
<ul class="sectlevel2">
<li><a href="#_management_of_core_menus_and_custom_menus">15.1. Management of core menus and custom menus</a></li>
<li><a href="#_ui_configuration">15.2. UI Configuration</a></li>
<li><a href="#_opfabapi">15.3. OpfabAPI</a></li>
<li><a href="#_write_right_for_user_rightsenum_write">15.4. Write right for user (RightsEnum.Write)</a></li>
<li><a href="#_cards_reminder">15.5. Cards reminder</a></li>
<li><a href="#_internal_technical_account">15.6. Internal technical account</a></li>
<li><a href="#_port_mapping">15.7. Port mapping</a></li>
<li><a href="#_rabbitmq">15.8. RabbitMQ</a></li>
<li><a href="#_configuration">15.9. Configuration</a></li>
<li><a href="#_normalization_of_some_configuration_parameters">15.10. Normalization of some configuration parameters</a></li>
<li><a href="#_mongodb_uri">15.11. Mongodb uri</a></li>
<li><a href="#_rate_limiter_for_card_sendings">15.12. Rate limiter for card sendings</a></li>
</ul>
</li>
<li><a href="#_migration_guide_from_release_4_0_0_to_release_4_1_0">16. Migration Guide from release 4.0.0 to release 4.1.0</a>
<ul class="sectlevel2">
<li><a href="#_optimizing_nginx_configuration_for_latency_reduction">16.1. Optimizing Nginx Configuration for Latency Reduction</a></li>
<li><a href="#_updating_the_file_size_limit">16.2. Updating the file size limit</a></li>
<li><a href="#_nginx_configuration_for_entity_supervision_administration">16.3. Nginx Configuration for entity supervision administration</a></li>
<li><a href="#_supervisor_configuration_change">16.4. Supervisor configuration change</a></li>
<li><a href="#_log_directories_in_docker">16.5. Log directories in docker</a></li>
<li><a href="#_opfabapi_2">16.6. OpfabAPI</a></li>
</ul>
</li>
<li><a href="#_migration_guide_from_release_4_1_0_to_release_4_2_0">17. Migration Guide from release 4.1.0 to release 4.2.0</a>
<ul class="sectlevel2">
<li><a href="#_deletion_of_parameter_displayconnectioncirclesinpreview">17.1. Deletion of parameter displayConnectionCirclesInPreview</a></li>
<li><a href="#_configuration_files_of_the_realtime_users_screen">17.2. Configuration files of the realtime users screen</a></li>
<li><a href="#_updating_the_entity_roles_in_the_database">17.3. Updating the entity roles in the database</a></li>
<li><a href="#_deletion_of_deprecated_functions_in_templategatewayusercardtemplategateway">17.4. Deletion of deprecated functions in templateGateway/usercardTemplateGateway</a></li>
<li><a href="#_card_keepchildcards">17.5. Card keepChildCards</a></li>
<li><a href="#_feed_process_and_state_filter">17.6. Feed process and state filter</a></li>
<li><a href="#_user_settings">17.7. User settings</a></li>
</ul>
</li>
<li><a href="#_migration_guide_from_release_4_2_0_to_release_4_3_0">18. Migration Guide from release 4.2.0 to release 4.3.0</a>
<ul class="sectlevel2">
<li><a href="#_admin_group">18.1. ADMIN group</a></li>
<li><a href="#_map_multiple_geojson_layers">18.2. Map multiple GeoJSON layers</a></li>
</ul>
</li>
<li><a href="#_migration_guide_from_release_4_3_x_to_release_4_4_0">19. Migration Guide from release 4.3.X to release 4.4.0</a>
<ul class="sectlevel2">
<li><a href="#_use_of_client_id_to_obtain_token">19.1. Use of client_id to obtain token</a></li>
<li><a href="#_endpoints_configuration">19.2. Endpoints configuration</a></li>
<li><a href="#_tooltips">19.3. Tooltips</a></li>
</ul>
</li>
<li><a href="#_migration_guide_from_release_4_4_x_to_release_4_5_0">20. Migration Guide from release 4.4.X to release 4.5.0</a>
<ul class="sectlevel2">
<li><a href="#_use_of_docker_compose_v2">20.1. Use of <code>docker compose v2</code></a></li>
<li><a href="#_use_of_date_fns_instead_of_moment_js_library">20.2. Use of <code>date-fns</code> instead of <code>Moment.js</code> library</a></li>
<li><a href="#_deletion_of_the_parameter_secondsafterpublicationtoconsidercardasnotread">20.3. Deletion of the parameter <code>secondsAfterPublicationToConsiderCardAsNotRead</code></a></li>
<li><a href="#_ui_configuration_2">20.4. UI Configuration</a></li>
<li><a href="#_hallway_mode_setting">20.5. Hallway mode setting</a></li>
<li><a href="#_process_monitoring_configuration">20.6. Process monitoring configuration</a></li>
<li><a href="#_deletion_of_view_all_archived_cards_and_view_all_archived_cards_for_user_perimeters_permissions">20.7. Deletion of <code>VIEW_ALL_ARCHIVED_CARDS</code> and <code>VIEW_ALL_ARCHIVED_CARDS_FOR_USER_PERIMETERS</code> permissions</a></li>
<li><a href="#_deletion_of_the_deprecated_api_method_opfab_currentcard_getentityusedforuserresponse">20.8. Deletion of the deprecated API method <code>opfab.currentCard.getEntityUsedForUserResponse()</code></a></li>
<li><a href="#_removed_deprecated_keepchildcards_field">20.9. Removed deprecated <code>keepChildCards</code> field</a></li>
<li><a href="#_opfab_cli_renaming_log_commands">20.10. Opfab CLI : renaming log commands</a></li>
<li><a href="#_rabbitmq_2">20.11. RabbitMQ</a></li>
</ul>
</li>
<li><a href="#_migration_guide_from_release_4_5_x_to_release_4_6_0">21. Migration Guide from release 4.5.X to release 4.6.0</a>
<ul class="sectlevel2">
<li><a href="#_removed_field_tonotify">21.1. Removed field <code>toNotify</code></a></li>
<li><a href="#_new_line_added_between_opfab_fields_and_template_in_usercard_form">21.2. New line added between opfab fields and template in usercard form</a></li>
<li><a href="#_timeline_domain_tr_renamed_rt">21.3. Timeline domain TR renamed RT</a></li>
<li><a href="#_ui_archives_and_logging_number_of_lines_per_page">21.4. UI archives and logging number of lines per page</a></li>
<li><a href="#_configuration_for_recap_email">21.5. Configuration for recap email</a></li>
<li><a href="#_timezone">21.6. Timezone</a></li>
<li><a href="#_email_templates">21.7. Email templates</a></li>
<li><a href="#_email_templates_custom_parameters">21.8. Email templates custom parameters</a></li>
<li><a href="#_removed_field_timespans_recurrence">21.9. Removed field <code>timespans.recurrence</code></a></li>
</ul>
</li>
<li><a href="#_migration_guide_from_release_4_6_x_to_release_4_7_0">22. Migration Guide from release 4.6.X to release 4.7.0</a>
<ul class="sectlevel2">
<li><a href="#_user_settings_2">22.1. User settings</a></li>
<li><a href="#_response_card">22.2. Response card</a></li>
</ul>
</li>
<li><a href="#_migration_guide_from_release_4_8_x_to_release_4_9_0">23. Migration Guide from release 4.8.X to release 4.9.0</a>
<ul class="sectlevel2">
<li><a href="#_geomap_configuration">23.1. Geomap configuration</a></li>
<li><a href="#_entities_in_token">23.2. Entities in Token</a></li>
<li><a href="#_deletion_of_monitoring_screen">23.3. Deletion of monitoring screen</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="_appendix_b_publication_of_the_client_library_jars_to_maven_central"><a class="anchor" href="#_appendix_b_publication_of_the_client_library_jars_to_maven_central"></a>1. Appendix B: Publication of the client library jars to Maven Central</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This is a summary of the steps that were necessary to initially set up the publication of jars to Maven Central.
The process to actually publish the jars for each release is detailed in the release process documentation.</p>
</div>
<div class="olist arabic">
<div class="title">Publication process overview</div>
<ol class="arabic">
<li>
<p>Building and signing the jars</p>
</li>
<li>
<p>Publishing them to a staging repository where there are validations
(e.g. check that the POM contains the required information, validating the signature against the public key)</p>
</li>
<li>
<p>If the validations pass, release the jar to Maven Central</p>
</li>
</ol>
</div>
<div class="sect2">
<h3 id="_claiming_the_org_opfab_namespace_on_maven_central"><a class="anchor" href="#_claiming_the_org_opfab_namespace_on_maven_central"></a>1.1. Claiming the org.opfab namespace on Maven Central</h3>
<div class="paragraph">
<p>This is done by logging an <a href="https://issues.sonatype.org/browse/OSSRH-67392">issue</a> on the
<a href="https://issues.sonatype.org/">Sonatype JIRA</a> (create an account first). The namespace needs to match a domain that you
own (and this will be verified), which is why we had to rename our packages to <code>org.opfab.XXX</code>.</p>
</div>
<div class="paragraph">
<p>You can then request other users to be granted rights on the namespace as well.</p>
</div>
</div>
<div class="sect2">
<h3 id="_creating_a_gpg_key_pair"><a class="anchor" href="#_creating_a_gpg_key_pair"></a>1.2. Creating a GPG key pair</h3>
<div class="paragraph">
<p>The key pair is generated with GPG2, keeping the default options and using the <code>opfabtech</code> technical account email as
contact. The key is further secured with a passphrase.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>gpg2 --full-generate-key

gpg (GnuPG) 2.2.19; Copyright (C) 2019 Free Software Foundation, Inc.
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.

Please select what kind of key you want:
   (1) RSA and RSA (default)
   (2) DSA and Elgamal
   (3) DSA (sign only)
   (4) RSA (sign only)
  (14) Existing key from card
Your selection? 1
RSA keys may be between 1024 and 4096 bits long.
What keysize do you want? (3072) 3072
Requested keysize is 3072 bits
Please specify how long the key should be valid.
         0 = key does not expire
      &lt;n&gt;  = key expires in n days
      &lt;n&gt;w = key expires in n weeks
      &lt;n&gt;m = key expires in n months
      &lt;n&gt;y = key expires in n years
Key is valid for? (0) 18m
Key expires at Tue 11 Oct 2022 12:38:13 CEST
Is this correct? (y/N) y

You need a user ID to identify your key; the software constructs the user ID
from the Real Name, Comment and Email Address in this form:
    "Heinrich Heine (Der Dichter) &lt;heinrichh@duesseldorf.de&gt;"

Real name: opfabtech
E-mail address: opfabtech@gmail.com
Comment: technical account for the OperatorFabric project
You selected this USER-ID:
    "opfabtech (technical account for the OperatorFabric project) &lt;opfabtech@gmail.com&gt;"

Change (N)ame, (C)omment, (E)-mail or (O)kay/(Q)uit? o
We need to generate a lot of random bytes. It is a good idea to perform
some other action (type on the keyboard, move the mouse, utilise the
disks) during the prime generation; this gives the random number
generator a better chance to gain enough entropy.
gpg: key 469E7252B8D25328 marked as ultimately trusted
gpg: directory '/home/guironnetale/.gnupg/openpgp-revocs.d' created
gpg: revocation certificate stored as '/home/guironnetale/.gnupg/openpgp-revocs.d/FE0D7AFF9C129CFBBDC18A0B469E7252B8D25328.rev'
public and secret key created and signed.

pub   rsa3072 2021-04-19 [SC] [expires: 2022-10-11]
      FE0D7AFF9C129CFBBDC18A0B469E7252B8D25328
uid                      opfabtech (technical account for the OperatorFabric project) &lt;opfabtech@gmail.com&gt;
sub   rsa3072 2021-04-19 [E] [expires: 2022-10-11]</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
A standard practice is to have the key expire in 18 months, so I set up a calendar reminder for us to renew it.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_sharing_the_signing_key"><a class="anchor" href="#_sharing_the_signing_key"></a>1.3. Sharing the signing key</h3>
<div class="paragraph">
<p>For other developers to be able to sign jars, you need to share both the key pair and the passphrase.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Export the key pair to a file</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>gpg2 --export-secret-keys OPFAB_KEY_ID &gt; key_pair.key</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Send the file to the other developers via a secure channel</p>
</li>
<li>
<p>Then, they need to import this file to their keyring (see the
<a href="/documentation/current/dev_env/index.html#client_lib_pub_conf">documentation for the publishing task</a>
for details).</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_publishing_the_public_key"><a class="anchor" href="#_publishing_the_public_key"></a>1.4. Publishing the public key</h3>
<div class="paragraph">
<p>The public key needs to be published to (preferably several) key directories so people wanting to use the signed jars
can check the signature against the public key. It is also checked as part of the validations performed on the
staging repository.</p>
</div>
<div class="paragraph">
<p>Our public key was initially published to <code>pool.sks-keyservers.net</code>, which became deprecated (causing the publication to
fail), so it was then published to the two servers that the sonatype validations seem to rely on.</p>
</div>
<div class="paragraph">
<div class="title">OpenPGP (<a href="https://keys.openpgp.org/" class="bare">keys.openpgp.org/</a>)</div>
<p>For OpenPGP you need to export the public key (and not the key pair) to a file and upload it to their web interface.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>gpg2 --export OPFAB_KEY_ID &gt; my_key.pub</pre>
</div>
</div>
<div class="paragraph">
<div class="title">Ubuntu (<a href="http://keyserver.ubuntu.com" class="bare">keyserver.ubuntu.com</a>)</div>
<p>For Ubuntu you need to export the public key as ascii-armored ascii and paste the result to their web interface</p>
</div>
<div class="listingblock">
<div class="content">
<pre>gpg2 --export --armor OPFAB_KEY_ID</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The key can be retrieved from both these servers by searching either for <code>opfabtech@gmail.com</code> or for the key ID.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_setting_up_the_signing_and_publication_in_gradle"><a class="anchor" href="#_setting_up_the_signing_and_publication_in_gradle"></a>1.5. Setting up the signing and publication in Gradle</h3>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
You can&#8217;t publish a jar with version "SNAPSHOT" to the Maven staging repositories (you would get a 403
BAD REQUEST), that&#8217;s why the Gradle publication task is configured so that if the version ends with "SNAPSHOT", the
jars should be published to a local directory (<code>repos/snapshots</code>) rather than to the Maven Central staging repository.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_useful_links"><a class="anchor" href="#_useful_links"></a>1.6. Useful links</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://central.sonatype.org/publish/publish-guide/">General Sonatype Publication Documentation</a></p>
</li>
<li>
<p><a href="https://central.sonatype.org/publish/publish-gradle/">Documentation for publishing using Gradle</a></p>
</li>
<li>
<p><a href="https://docs.gradle.org/current/userguide/signing_plugin.html">Gradle Signing Plugin</a></p>
</li>
<li>
<p><a href="https://docs.gradle.org/current/userguide/publishing_maven.html">Gradle Maven Publish Plugin</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_migration_guide_from_release_3_0_0_to_release_3_1_0"><a class="anchor" href="#_migration_guide_from_release_3_0_0_to_release_3_1_0"></a>2. Migration Guide from release 3.0.0 to release 3.1.0</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_kafka_date_format"><a class="anchor" href="#_kafka_date_format"></a>2.1. Kafka date format</h3>
<div class="paragraph">
<p>The signature for sending card dates via Kafka have been changed to better reflect the REST API. Instead
of sending the date in seconds since epoch, you can now use the Java Instant object. The following methods are affected:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>startDate</code></p>
</li>
<li>
<p><code>endDate</code></p>
</li>
<li>
<p><code>lttd</code></p>
</li>
<li>
<p><code>publishDate</code></p>
</li>
<li>
<p><code>TimeSpan.setStart</code></p>
</li>
<li>
<p><code>TimeSpan.setEnd</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For example the following code:</p>
</div>
<div class="paragraph">
<p><code>Card card = Card.newBuilder().setStartDate(12345L).build();</code></p>
</div>
<div class="paragraph">
<p>becomes:</p>
</div>
<div class="paragraph">
<p><code>Card card = Card.newBuilder().setStartDate(Instant.now()).build();</code></p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_migration_guide_from_release_3_1_0_to_release_3_2_0"><a class="anchor" href="#_migration_guide_from_release_3_1_0_to_release_3_2_0"></a>3. Migration Guide from release 3.1.0 to release 3.2.0</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_cache_configuration_for_i18n_files"><a class="anchor" href="#_cache_configuration_for_i18n_files"></a>3.1. Cache configuration for i18n files</h3>
<div class="paragraph">
<p>Add the following lines in your nginx.conf to avoid keeping in cache old translation files when migrating opfab</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>  location /ui/assets/i18n/ {
    add_header Cache-Control &quot;no-cache&quot;;
    alias /usr/share/nginx/html/assets/i18n/;
  }</code></pre>
</div>
</div>
<div class="paragraph">
<p>see the reference nginx configuration file : <a href="https://github.com/opfab/operatorfabric-core/blob//config/docker/nginx.conf" class="bare">github.com/opfab/operatorfabric-core/blob//config/docker/nginx.conf</a></p>
</div>
</div>
<div class="sect2">
<h3 id="_tag_feed_filter_removal"><a class="anchor" href="#_tag_feed_filter_removal"></a>3.2. Tag feed filter removal</h3>
<div class="paragraph">
<p>The feature to filter tags in the feed has been removed. In consequence, you can remove the following parameters in your web-ui.json configuration file:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>settings.tags.hide</p>
</li>
<li>
<p>settings.infos.hide.tags</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_migration_guide_from_release_3_4_0_to_release_3_5_0"><a class="anchor" href="#_migration_guide_from_release_3_4_0_to_release_3_5_0"></a>4. Migration Guide from release 3.4.0 to release 3.5.0</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_timezone_management_removal"><a class="anchor" href="#_timezone_management_removal"></a>4.1. Timezone management removal</h3>
<div class="paragraph">
<p>The feature to manage timeline inside opfab has been removed. In consequence, you can remove the following parameters in your web-ui.json configuration file:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>i10n.supported.time-zones</p>
</li>
<li>
<p>settings.infos.hide.timezone</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_kafka_card_format_changes"><a class="anchor" href="#_kafka_card_format_changes"></a>4.2. Kafka card format changes</h3>
<div class="paragraph">
<p>The Kafka message schema has been changed. The single card used to send messages to and receive from Operator Fabric
has been split into two cards; one for sending to OpFab and one for receiving messages from OpFab. The CardCommand structure now contains a <code>card</code>  (to OpFab) and a <code>responseCard</code> (from OpFab).
You will need to change the Kafka listener to get the response card.</p>
</div>
<div class="paragraph">
<p>For example change</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"> <span class="annotation">@KafkaListener</span>
    <span class="directive">public</span> <span class="type">void</span> receivedResponseCard(<span class="annotation">@Payload</span> ConsumerRecord&lt;<span class="predefined-type">String</span>, CardCommand&gt; consumerRecord) {
        CardCommand cardCommand = consumerRecord.value();
        Card = cardCommand.getCard();</code></pre>
</div>
</div>
<div class="paragraph">
<p>to</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"> <span class="annotation">@KafkaListener</span>
    <span class="directive">public</span> <span class="type">void</span> receivedResponseCard(<span class="annotation">@Payload</span> ConsumerRecord&lt;<span class="predefined-type">String</span>, CardCommand&gt; consumerRecord) {
        CardCommand cardCommand = consumerRecord.value();
        ResponseCard = cardCommand.getResponseCard();</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="_redirect_to_business_application_from_a_card"><a class="anchor" href="#_redirect_to_business_application_from_a_card"></a>4.2.1. Redirect to business application from a card</h4>
<div class="paragraph">
<p>The <code>templateGateway.redirectToBusinessMenu</code> function to redirect to business application from a card has changed. The third argument of the function is now a url extension that can contain sub paths and/or parameters instead of only parameters.</p>
</div>
<div class="paragraph">
<p>You will need to change the call adding a '?' character at the beginning of the third argument.</p>
</div>
<div class="paragraph">
<p>For example change:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>templateGateway.redirectToBusinessMenu('myMenu','myEntry','param1=aParam&amp;param2=anotherParam')</pre>
</div>
</div>
<div class="paragraph">
<p>to</p>
</div>
<div class="literalblock">
<div class="content">
<pre>templateGateway.redirectToBusinessMenu('myMenu','myEntry','?param1=aParam&amp;param2=anotherParam')</pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_migration_guide_from_release_3_5_0_to_release_3_6_0"><a class="anchor" href="#_migration_guide_from_release_3_5_0_to_release_3_6_0"></a>5. Migration Guide from release 3.5.0 to release 3.6.0</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_template_rendering"><a class="anchor" href="#_template_rendering"></a>5.1. Template rendering</h3>
<div class="paragraph">
<p>Bootstrap library has been migrate to v5.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
If you use bootstrap css classes in your templates, it&#8217;s strongly recommended checking your template rendering after migration.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Charts library has been upgraded from version 3.2.1 to 3.7.1</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
If you use charts in your templates, it&#8217;s strongly recommended checking your template rendering after migration.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_mongo_data_migration_steps"><a class="anchor" href="#_mongo_data_migration_steps"></a>5.2. Mongo data migration steps</h3>
<div class="paragraph">
<p>This section outlines the necessary steps to migrate existing data.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
If you use response card feature, you need to perform these steps before starting up the OperatorFabric instance to avoid displaying wrong data in archives page.
</td>
</tr>
</table>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Backup your existing Mongo data.</p>
</li>
<li>
<p>Run the following scripts in the mongo shell to update the value of the new field <code>deletionDate</code> for archived cards:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="shell">db.archivedCards.updateMany(
{&quot;deletionDate&quot;: {&quot;$exists&quot;: false}},
{&quot;$set&quot;: {&quot;deletionDate&quot;: new ISODate(&quot;1970-01-01T00:00:00Z&quot;)}}
)</code></pre>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_about_screen"><a class="anchor" href="#_about_screen"></a>5.3. About screen</h3>
<div class="paragraph">
<p>You do not need anymore to precise opfab version in web-ui.json to see it on about screen. So you need to remove the corresponding line. For example :</p>
</div>
<div class="literalblock">
<div class="content">
<pre>      "operatorfabric": {
        "name": "OperatorFabric",
        "rank": 0,
        "version": "2.5.0.RELEASE"
      }</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_deprecated_feature"><a class="anchor" href="#_deprecated_feature"></a>5.4. Deprecated feature</h3>
<div class="sect3">
<h4 id="_method_templategateway_getspecificcardinformation"><a class="anchor" href="#_method_templategateway_getspecificcardinformation"></a>5.4.1. Method templateGateway.getSpecificCardInformation()</h4>
<div class="paragraph">
<p>Implementation of method templateGateway.getSpecificCardInformation() in usercard templates is now deprecated, replace it by usercardTemplateGateway.getSpecificCardInformation(). It is just a naming change, the behavior is the same.</p>
</div>
</div>
<div class="sect3">
<h4 id="_restrict_recipient_dropdown_list_for_user"><a class="anchor" href="#_restrict_recipient_dropdown_list_for_user"></a>5.4.2. Restrict recipient dropdown list for user</h4>
<div class="paragraph">
<p>Using "recipientList" in state definition (in config.json) is now deprecated</p>
</div>
<div class="paragraph">
<p>If you use  "recipientList" to restrict the list of recipients shown to user, replace it with code in template as in the following example :</p>
</div>
<div class="literalblock">
<div class="content">
<pre>    usercardTemplateGateway.setDropdownEntityRecipientList([
            {"id": "ENTITY_FR", "levels": [0,1]},
            {"id": "IT_SUPERVISOR_ENTITY"}
        ]);</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_set_the_list_of_recipients"><a class="anchor" href="#_set_the_list_of_recipients"></a>5.4.3. Set the list of recipients</h4>
<div class="paragraph">
<p>Using "recipientList" in state definition (in config.json) is now deprecated</p>
</div>
<div class="paragraph">
<p>If you use  "recipientList" to set the list of recipients, provide now the list of recipients when returning the card object in usercardTemplateGateway.getSpecificCardInformation() in the field entityRecipients.</p>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>    usercardTemplateGateway.getSpecificCardInformation = function () {
        const message = document.getElementById('message').value;
        const card = {
          summary : {key : "message.summary"},
          title : {key : "message.title"},
          entityRecipients: ["ENTITY_FR","IT_SUPERVISOR_ENTITY"],
          data : {message: message}
        };
        if (message.length&lt;1) return { valid:false , errorMsg:'You must provide a message'}
        return {
            valid: true,
            card: card
        };</pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_migration_guide_from_release_3_6_0_to_release_3_7_0"><a class="anchor" href="#_migration_guide_from_release_3_6_0_to_release_3_7_0"></a>6. Migration Guide from release 3.6.0 to release 3.7.0</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_docker_images_names_changed"><a class="anchor" href="#_docker_images_names_changed"></a>6.1. Docker images names changed</h3>
<div class="paragraph">
<p>From version 3.7.0 the docker names of the former "business services" are changed. Here are there old names and the new ones.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Old docker name</th>
<th class="tableblock halign-left valign-top">New docker name</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">lfeoperatorfabric/of-cards-consultation-business-service:3.6.0.RELEASE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">lfeoperatorfabric/of-cards-consultation-service:3.7.0.RELEASE</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">lfeoperatorfabric/of-cards-publication-business-service:3.6.0.RELEASE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">lfeoperatorfabric/of-cards-publication-service:3.7.0.RELEASE</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">lfeoperatorfabric/of-users-business-service:3.6.0.RELEASE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">lfeoperatorfabric/of-users-service:3.7.0.RELEASE</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">lfeoperatorfabric/of-businessconfig-business-service:3.6.0.RELEASE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">lfeoperatorfabric/of-businessconfig-service:3.7.0.RELEASE</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>You must change your docker-compose files accordingly.</p>
</div>
</div>
<div class="sect2">
<h3 id="_third_parties_configuration"><a class="anchor" href="#_third_parties_configuration"></a>6.2. Third parties configuration</h3>
<div class="paragraph">
<p>The configuration of the third parties applications as external recipents has changed. It is now possible to configure wether the user token shall be propagated to the third party or not by setting the "propagateUserToken" boolean property.</p>
</div>
<div class="paragraph">
<p>If you have third parties configured in your 'cards-publication.yml' you should change the configuration as follows:</p>
</div>
<div class="paragraph">
<p>From:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>externalRecipients-url: "{\
           third-party1: \"http://thirdparty1/test1\", \
           third-party2: \"http://thirdparty2:8090/test2\", \
           }"</pre>
</div>
</div>
<div class="paragraph">
<p>To</p>
</div>
<div class="literalblock">
<div class="content">
<pre>external-recipients:
  recipients:
    - id: "third-party1"
      url: "http://thirdparty1/test1"
      propagateUserToken: true
    - id: "third-party2"
      url: "http://thirdparty2:8090/test2"
      propagateUserToken: true</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_rename_attribute_externaldeviceid"><a class="anchor" href="#_rename_attribute_externaldeviceid"></a>6.3. Rename attribute externalDeviceId</h3>
<div class="paragraph">
<p>It is now possible to have several external device systems, therefore the attribute externalDeviceId is now renamed into externalDeviceIds and is now a list.</p>
</div>
<div class="sect3">
<h4 id="_in_the_configuration_file"><a class="anchor" href="#_in_the_configuration_file"></a>6.3.1. In the configuration file</h4>
<div class="paragraph">
<p>In the configuration file, replace</p>
</div>
<div class="literalblock">
<div class="content">
<pre>userConfigurations:
        - userLogin: operator1_fr
          externalDeviceId: CDS_1
        - userLogin: operator2_fr
          externalDeviceId: CDS_2
        - userLogin: operator3_fr
          externalDeviceId: CDS_3
        - userLogin: operator4_fr
          externalDeviceId: CDS_1</pre>
</div>
</div>
<div class="paragraph">
<p>by</p>
</div>
<div class="literalblock">
<div class="content">
<pre>userConfigurations:
        - userLogin: operator1_fr
          externalDeviceIds: ["CDS_1"]
        - userLogin: operator2_fr
          externalDeviceIds: ["CDS_2"]
        - userLogin: operator3_fr
          externalDeviceIds: ["CDS_3"]
        - userLogin: operator4_fr
          externalDeviceIds: ["CDS_1"]</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_changes_in_the_mongo_data_base"><a class="anchor" href="#_changes_in_the_mongo_data_base"></a>6.3.2. Changes in the Mongo data base</h4>
<div class="sect4">
<h5 id="_before_the_migration"><a class="anchor" href="#_before_the_migration"></a>6.3.2.1. Before the migration</h5>
<div class="paragraph">
<p>Before the migration to 3.7.0, one should save its current database, then add the attribute "externalDeviceIds" based on the
value of the existing attribute "externalDeviceId". To add this attribute, simply launch the commands :</p>
</div>
<div class="literalblock">
<div class="content">
<pre>var collection = db.getCollection("userConfigurations")
collection.find().forEach(function(user) {collection.updateOne({_id: user._id}, {$set: {externalDeviceIds: [user.externalDeviceId]}})})</pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_once_the_migration_is_done"><a class="anchor" href="#_once_the_migration_is_done"></a>6.3.2.2. Once the migration is done</h5>
<div class="paragraph">
<p>Once the migration to 3.7.0 is done, the attribute "externalDeviceId" is not used anymore.
You can remove it by launching :</p>
</div>
<div class="literalblock">
<div class="content">
<pre>var collection = db.getCollection("userConfigurations")
collection.find().forEach(function(user) {collection.updateOne({_id: user._id}, {$unset: {"externalDeviceId": 1}})})</pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_deprecated_feature_2"><a class="anchor" href="#_deprecated_feature_2"></a>6.4. Deprecated feature</h3>
<div class="sect3">
<h4 id="_field_recurrence"><a class="anchor" href="#_field_recurrence"></a>6.4.1. Field recurrence</h4>
<div class="paragraph">
<p>Using "recurrence" field returned by getSpecificCardInformation() method definition is now deprecated.</p>
</div>
<div class="paragraph">
<p>If you are using the "viewCardInAgenda" and "recurrence" field, use the "timeSpans" field instead when returning the card object in usercardTemplateGateway.getSpecificCardInformation() to configure the visibility of the card in timeline and agenda.</p>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>    usercardTemplateGateway.getSpecificCardInformation = function () {
        const message = document.getElementById('message').value;
        const card = {
          summary : {key : "message.summary"},
          title : {key : "message.title"},
          entityRecipients: ["ENTITY_FR","IT_SUPERVISOR_ENTITY"],
          data : {message: message}
        };

        const recurrence = {
            daysOfWeek : [1,2,3],
            hoursAndMinutes : {hours:10,minutes:44},
            durationInMinutes: 15
        }

        const mystartDate = new Date();
        const timeSpans = [{
            startDate: mystartDate.getTime(),
            endDate: mystartDate.getTime() + 7 * 24 * 3600000,
            recurrence: recurrence
        }]

        return {
            valid: true,
            card: card,
            timeSpans: timeSpans
        };</pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_migration_guide_from_release_3_7_0_to_release_3_8_0"><a class="anchor" href="#_migration_guide_from_release_3_7_0_to_release_3_8_0"></a>7. Migration Guide from release 3.7.0 to release 3.8.0</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_kafka_card_format_changes_2"><a class="anchor" href="#_kafka_card_format_changes_2"></a>7.1. Kafka card format changes</h3>
<div class="paragraph">
<p>The Kafka message schema has been changed. Two new, optional fields are added:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>wktGeometry</code></p>
</li>
<li>
<p><code>wktProjection</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Make sure your Kafka consumers and producers are updated and use the latest card and responseCard definitions.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_migration_guide_from_release_3_8_x_to_release_3_9_0"><a class="anchor" href="#_migration_guide_from_release_3_8_x_to_release_3_9_0"></a>8. Migration Guide from release 3.8.x to release 3.9.0</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_web_ui_json_config_file"><a class="anchor" href="#_web_ui_json_config_file"></a>8.1. <code>web-ui.json</code> config file</h3>
<div class="paragraph">
<p>To declare settings parameters, you now need to group all fields under <code>settings: { }</code> and you must not use a statement like this one : <code>settings.replayInterval: 10</code></p>
</div>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="paragraph">
<p>Replace the following invalid settings config</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>  &quot;settings.replayInterval&quot;: 10,
  &quot;settings.replayEnabled&quot;: true,
  &quot;settings&quot;: {
    &quot;about&quot;: {
      &quot;keycloak&quot;: {
        &quot;name&quot;: &quot;Keycloak&quot;,
        &quot;rank&quot;: 2,
        &quot;version&quot;: &quot;6.0.1&quot;
      },
    }
    &quot;locale&quot;: &quot;en&quot;,
    &quot;dateTimeFormat&quot;: &quot;HH:mm DD/MM/YYYY&quot;,
    &quot;dateFormat&quot;: &quot;DD/MM/YYYY&quot;,
    &quot;styleWhenNightDayModeDesactivated&quot;: &quot;NIGHT&quot;
  },</code></pre>
</div>
</div>
<div class="paragraph">
<p>By this valid one :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>  &quot;settings&quot;: {
    &quot;replayInterval&quot;: 10,
    &quot;replayEnabled&quot;: true,
    &quot;about&quot;: {
      &quot;keycloak&quot;: {
        &quot;name&quot;: &quot;Keycloak&quot;,
        &quot;rank&quot;: 2,
        &quot;version&quot;: &quot;6.0.1&quot;
      },
    }
    &quot;locale&quot;: &quot;en&quot;,
    &quot;dateTimeFormat&quot;: &quot;HH:mm DD/MM/YYYY&quot;,
    &quot;dateFormat&quot;: &quot;DD/MM/YYYY&quot;,
    &quot;styleWhenNightDayModeDesactivated&quot;: &quot;NIGHT&quot;
  },</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_migration_guide_from_release_3_9_x_to_release_3_10_0"><a class="anchor" href="#_migration_guide_from_release_3_9_x_to_release_3_10_0"></a>9. Migration Guide from release 3.9.x to release 3.10.0</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_card_publication_with_not_existent_process_or_state"><a class="anchor" href="#_card_publication_with_not_existent_process_or_state"></a>9.1. Card publication with not existent process or state</h3>
<div class="paragraph">
<p>OperatorFabric will refuse the publication of cards referring a not existent process or state.
To allow the publication of cards with not existent process or state you should set the <code>authorizeToSendCardWithInvalidProcessState</code> property to <code>true</code> in <code>cards-publication.yml</code> configuration file.</p>
</div>
</div>
<div class="sect2">
<h3 id="_web_ui_json_config_file_2"><a class="anchor" href="#_web_ui_json_config_file_2"></a>9.2. <code>web-ui.json</code> config file</h3>
<div class="sect3">
<h4 id="_settings_about_section"><a class="anchor" href="#_settings_about_section"></a>9.2.1. <code>settings.about</code> section</h4>
<div class="paragraph">
<p>The section to configure <code>about</code> screen has been moved from <code>settings</code> section to the root level. You need to change the configuration file accordingly.</p>
</div>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="paragraph">
<p>Replace the following invalid config</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>  &quot;settings&quot;: {
    &quot;about&quot;: {
      &quot;keycloak&quot;: {
        &quot;name&quot;: &quot;Keycloak&quot;,
        &quot;rank&quot;: 2,
        &quot;version&quot;: &quot;6.0.1&quot;
      },
    },
    &quot;replayInterval&quot;: 10,
    &quot;replayEnabled&quot;: true,
    &quot;locale&quot;: &quot;en&quot;,
    &quot;dateTimeFormat&quot;: &quot;HH:mm DD/MM/YYYY&quot;,
    &quot;dateFormat&quot;: &quot;DD/MM/YYYY&quot;,
    &quot;styleWhenNightDayModeDesactivated&quot;: &quot;NIGHT&quot;
  },</code></pre>
</div>
</div>
<div class="paragraph">
<p>By this valid one :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>  &quot;settings&quot;: {
    &quot;replayInterval&quot;: 10,
    &quot;replayEnabled&quot;: true,
    &quot;locale&quot;: &quot;en&quot;,
    &quot;dateTimeFormat&quot;: &quot;HH:mm DD/MM/YYYY&quot;,
    &quot;dateFormat&quot;: &quot;DD/MM/YYYY&quot;,
    &quot;styleWhenNightDayModeDesactivated&quot;: &quot;NIGHT&quot;
  },
  &quot;about&quot;: {
    &quot;keycloak&quot;: {
      &quot;name&quot;: &quot;Keycloak&quot;,
      &quot;rank&quot;: 2,
      &quot;version&quot;: &quot;6.0.1&quot;
    }
  }</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_settings_infos_hide_section"><a class="anchor" href="#_settings_infos_hide_section"></a>9.2.2. <code>settings.infos.hide</code> section</h4>
<div class="paragraph">
<p>The section to configure hidden fields for the settings screen has been moved from <code>settings.infos.hide</code> section to
<code>settingsScreen.hiddenSettings</code>. This new field is an array of string and possible values are : "description",
"language", "remoteLoggingEnabled" and "sounds". So, you need to change the configuration file accordingly.</p>
</div>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="paragraph">
<p>Replace the following invalid config</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>  &quot;settings&quot;: {
    &quot;infos&quot;: {
      &quot;hide&quot;: {
        &quot;description&quot;: true
      }
    }
  }</code></pre>
</div>
</div>
<div class="paragraph">
<p>By this valid one :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>  &quot;settingsScreen&quot;: {
    &quot;hiddenSettings&quot;:  [&quot;description&quot;]
  }</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_feed_filtering_and_sorting"><a class="anchor" href="#_feed_filtering_and_sorting"></a>9.2.3. Feed filtering and sorting</h4>
<div class="paragraph">
<p>In feed configuration the following parameters to hide filtering and sorting options have been removed: <code>feed.card.hideAckFilter</code>, <code>feed.card.hideReadSort</code>, <code>feed.card.hideSeveritySort</code></p>
</div>
<div class="paragraph">
<p>Instead, it is possible to configure the default behaviour for sorting and acknowledgment filtering by setting the following parameters in <code>web-ui.json</code>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>feed.defaultSorting</code> : possible values are : "unread", "date", "severity", "startDate", "endDate"</p>
</li>
<li>
<p><code>feed.defaultAcknowledgmentFilter</code> : possible values are : "notack", "ack", "all"</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_migration_guide_from_release_3_10_x_to_release_3_11_0"><a class="anchor" href="#_migration_guide_from_release_3_10_x_to_release_3_11_0"></a>10. Migration Guide from release 3.10.x to release 3.11.0</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_card_publication"><a class="anchor" href="#_card_publication"></a>10.1. Card publication</h3>
<div class="paragraph">
<p>OperatorFabric will now check user perimeter when publishing cards via endpoint <code>/cards</code> (it does not concern user cards
which are always controlled). To disable perimeter validation it is possible to set the configuration parameter
<code>checkPerimeterForCardSending</code> to <code>false</code> in cards-publication service configuration file.</p>
</div>
</div>
<div class="sect2">
<h3 id="_templategateway_onstylechange_method"><a class="anchor" href="#_templategateway_onstylechange_method"></a>10.2. templateGateway <code>onStyleChange()</code> method</h3>
<div class="paragraph">
<p>A new <code>onStyleChange()</code> method has been added to templateGateway.
OpFab will call this method when switching day/night mode.
It may have to be implemented by a template to refresh styles and reload embedded charts when user change day/night
mode, please check your existing templates.</p>
</div>
</div>
<div class="sect2">
<h3 id="_nginx_configuration"><a class="anchor" href="#_nginx_configuration"></a>10.3. Nginx configuration</h3>
<div class="paragraph">
<p>Nginx configuration file has to be modified to allow the forwarding of query parameters to the new 'userActionLogs' API.
You have to modify <code>nginx.conf</code> file as follows:</p>
</div>
<div class="paragraph">
<p>Replace</p>
</div>
<div class="listingblock">
<div class="content">
<pre>  location ~ "^/users/(.*)" {
    proxy_set_header Host $http_host;
    proxy_pass http://users:8080/$1;
    proxy_set_header X-Forwarded-For $remote_addr;
  }</pre>
</div>
</div>
<div class="paragraph">
<p>With</p>
</div>
<div class="listingblock">
<div class="content">
<pre>  location ~ "^/users/(.*)" {
    proxy_set_header Host $http_host;
    proxy_pass http://users:8080/$1$is_args$args;
    proxy_set_header X-Forwarded-For $remote_addr;
  }</pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_migration_guide_from_release_3_11_x_to_release_3_12_0"><a class="anchor" href="#_migration_guide_from_release_3_11_x_to_release_3_12_0"></a>11. Migration Guide from release 3.11.x to release 3.12.0</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_java_17"><a class="anchor" href="#_java_17"></a>11.1. Java 17</h3>
<div class="paragraph">
<p>OperatorFabric now runs on java 17, which means that the client library is now compiled with java 17. If you are using the client library, you may need to upgrade your application to java 17 or use client 3.11.2 which is compatible with version 3.12.0 and compiled with java 11.</p>
</div>
</div>
<div class="sect2">
<h3 id="_expiration_date"><a class="anchor" href="#_expiration_date"></a>11.2. Expiration date</h3>
<div class="paragraph">
<p>A new 'expirationDate' field has been added to the card.
Cards with an expiration date will be automatically deleted from the card feed after the expiration date is passed.</p>
</div>
<div class="paragraph">
<p>The expiration date is by default visible in the usercard screen.
You can hide the expiration date in the usercard screen by adding the new 'expirationDateVisible' value to your
usercard configuration in the config.json of your bundle.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Hide expiration date &#8594; "expirationDateVisible" : false</p>
<div class="literalblock">
<div class="content">
<pre>"processState": {
  "name": "Process example ",
  "description": "Process state",
  "color": "#0070C0",
  "userCard" : {
    "template" : "usercard_process",
    "lttdVisible" : false,
    "expirationDateVisible" : false,
    "recipientList" : [{"id": "ENTITY_FR", "levels": [0,1]}, {"id": "IT_SUPERVISOR_ENTITY"}]
  },</pre>
</div>
</div>
</li>
<li>
<p>Show expiration date &#8594; "expirationDateVisible" : false</p>
<div class="literalblock">
<div class="content">
<pre>"processState": {
  "name": "Process example ",
  "description": "Process state",
  "color": "#0070C0",
  "userCard" : {
    "template" : "usercard_process",
    "lttdVisible" : false,
    "expirationDateVisible" : true,
    "recipientList" : [{"id": "ENTITY_FR", "levels": [0,1]}, {"id": "IT_SUPERVISOR_ENTITY"}]
  },</pre>
</div>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_remove_deprecated_method_templategateway_getspecificcardinformation"><a class="anchor" href="#_remove_deprecated_method_templategateway_getspecificcardinformation"></a>11.3. Remove deprecated method templateGateway.getSpecificCardInformation()</h3>
<div class="paragraph">
<p>The deprecated method 'templateGateway.getSpecificCardInformation()' in usercard templates has been removed, use 'usercardTemplateGateway.getSpecificCardInformation()' method instead.</p>
</div>
</div>
<div class="sect2">
<h3 id="_nginx_configuration_2"><a class="anchor" href="#_nginx_configuration_2"></a>11.4. Nginx configuration</h3>
<div class="paragraph">
<p>You need to modify your existing opfab nginx configuration (nginx.conf file), replace line :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>proxy_pass http://users:8080/$1;</code></pre>
</div>
</div>
<div class="paragraph">
<p>by</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>proxy_pass http://users:8080/$1$is_args$args;</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_migration_guide_from_release_3_12_0_to_release_3_13_0"><a class="anchor" href="#_migration_guide_from_release_3_12_0_to_release_3_13_0"></a>12. Migration Guide from release 3.12.0 to release 3.13.0</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_trailing_slash"><a class="anchor" href="#_trailing_slash"></a>12.1. Trailing slash</h3>
<div class="paragraph">
<p>When calling an opfab API you cannot use anymore trailing slash on url.</p>
</div>
<div class="paragraph">
<p>If, for example, one makes a request like <a href="https://opfab/businessconfig/processes/" class="bare">opfab/businessconfig/processes/</a>, it must be replace by <a href="https://opfab/businessconfig/processes" class="bare">opfab/businessconfig/processes</a></p>
</div>
</div>
<div class="sect2">
<h3 id="_viewcardinagenda_parameter_renamed"><a class="anchor" href="#_viewcardinagenda_parameter_renamed"></a>12.2. viewCardInAgenda Parameter renamed</h3>
<div class="paragraph">
<p>The viewCardInAgenda parameter (specified in the usercard template through getSpecificCardInformation) has been renamed viewCardInCalendar to be consistent with other parts of the software. So you may have to update your usercard templates.</p>
</div>
</div>
<div class="sect2">
<h3 id="_default_value_set_to_false_for_lttdvisible_and_expirationdatevisible"><a class="anchor" href="#_default_value_set_to_false_for_lttdvisible_and_expirationdatevisible"></a>12.3. Default value set to false for lttdVisible and expirationDateVisible</h3>
<div class="paragraph">
<p>In usercard state definition, the default value for fields <code>lttdVisible</code> and <code>expirationDateVisible</code> is now set to false.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_migration_guide_from_release_3_13_0_to_release_3_14_0"><a class="anchor" href="#_migration_guide_from_release_3_13_0_to_release_3_14_0"></a>13. Migration Guide from release 3.13.0 to release 3.14.0</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_bundles_folder"><a class="anchor" href="#_bundles_folder"></a>13.1. Bundles folder</h3>
<div class="paragraph">
<p>Bundles are not stored directly into the business config storage path defined in configuration anymore (operatorfabric.businessconfig.storage.path) but in a subdirectory named bundles. So in order to migrate, it is needed to move your bundles directories to a subdirectory named bundles.</p>
</div>
<div class="paragraph">
<p>To help you migrate your production environment you can use the following script : <a href="https://github.com/opfab/operatorfabric-core/blob//src/tooling/migration-opfab3.13/moveBundles.sh" class="bare">github.com/opfab/operatorfabric-core/blob//src/tooling/migration-opfab3.13/moveBundles.sh</a></p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_migration_guide_from_release_3_14_0_to_release_3_15_0"><a class="anchor" href="#_migration_guide_from_release_3_14_0_to_release_3_15_0"></a>14. Migration Guide from release 3.14.0 to release 3.15.0</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_crossorigin_for_geojson"><a class="anchor" href="#_crossorigin_for_geojson"></a>14.1. CrossOrigin for GeoJSON</h3>
<div class="paragraph">
<p>The option <code>feed.geomap.layer.geojson.crossOrigin</code>, used to set a cross-origin option when downloading GeoJSON, has
been removed.</p>
</div>
</div>
<div class="sect2">
<h3 id="_remove_deprecated_field_from_state_definition"><a class="anchor" href="#_remove_deprecated_field_from_state_definition"></a>14.2. Remove deprecated field from state definition</h3>
<div class="paragraph">
<p>The deprecated field <code>recipientList</code> has been removed from card state definition.
To restrict the recipient list options use the method <code>usercardTemplateGateway.setDropdownEntityRecipientList</code> in template.</p>
</div>
</div>
<div class="sect2">
<h3 id="_remove_use_of_groups_column_in_realtime_screen"><a class="anchor" href="#_remove_use_of_groups_column_in_realtime_screen"></a>14.3. Remove use of groups column in realtime screen</h3>
<div class="paragraph">
<p>The field <code>groups</code> has been removed from the object <code>entitiesGroups</code> of the configuration file <code>realtimescreens.json</code>.
To conform to this new structure, you have to remove this field from your configuration file.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_migration_guide_from_release_3_15_0_to_release_4_0_0"><a class="anchor" href="#_migration_guide_from_release_3_15_0_to_release_4_0_0"></a>15. Migration Guide from release 3.15.0 to release 4.0.0</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_management_of_core_menus_and_custom_menus"><a class="anchor" href="#_management_of_core_menus_and_custom_menus"></a>15.1. Management of core menus and custom menus</h3>
<div class="paragraph">
<p>The structure of the <code>ui-menu.json</code> file has changed. Fields <code>coreMenusConfiguration</code> and <code>menus</code> do not exist anymore.</p>
</div>
<div class="paragraph">
<p>Now <code>ui-menu.json</code> file contains 4 fields :</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>navigationBar</code> : contains the navigation bar mixing core menus and custom menus</p>
</li>
<li>
<p><code>topRightIconMenus</code> : contains only the two menu icons <code>agenda</code> and <code>usercard</code> on the top right of the screen</p>
</li>
<li>
<p><code>topRightMenus</code> : contains the core menus you want to see when you click the user, on the top right of the screen</p>
</li>
<li>
<p><code>locales</code> : contains the translations for the custom menus</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
With the new structure of the file, it is now possible to mix core menus and custom menus in the navigation bar.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>You can find more information and a full example in the documentation :
<a href="https://opfab.github.io/documentation/current/reference_doc/#menu_entries" class="bare">opfab.github.io/documentation/current/reference_doc/#menu_entries</a></p>
</div>
</div>
<div class="sect2">
<h3 id="_ui_configuration"><a class="anchor" href="#_ui_configuration"></a>15.2. UI Configuration</h3>
<div class="paragraph">
<p>Some fields of the <code>web-ui.json</code> file have changed and renamed:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>alertMessageBusinessAutoClose</code> has been moved to the  <code>alerts</code> section and is now called <code>messageBusinessAutoClose</code></p>
</li>
<li>
<p><code>alertMessageOnBottomOfTheScreen</code> has been moved to the  <code>alerts</code> section and is now called <code>messageOnBottomOfTheScreen</code></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_opfabapi"><a class="anchor" href="#_opfabapi"></a>15.3. OpfabAPI</h3>
<div class="paragraph">
<p>Use of methods or attributes starting with templateGateway are now deprecated , the following table give you the new methods to use</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Deprecated method or attribute</th>
<th class="tableblock halign-left valign-top">New method</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">templateGateway.getEntityName(entityId)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">opfab.users.entities.getEntityName(entityId)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">templateGateway.getEntity(entityId)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">opfab.users.entities.getEntity(entityId)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">templateGateway.getAllEntities()</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">opfab.users.entities.getAllEntities()</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">templateGateway.redirectToBusinessMenu(menuId, menuItemId, urlExtension)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">opfab.navigate.redirectToBusinessMenu(menuId, menuItemId, urlExtension)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">templateGateway.isUserAllowedToRespond()</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">opfab.currentCard.isUserAllowedToRespond()</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">templateGateway.isUserMemberOfAnEntityRequiredToRespond()</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">opfab.currentCard.isUserMemberOfAnEntityRequiredToRespond()</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">templateGateway.getEntitiesAllowedToRespond()</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">opfab.currentCard.getEntitiesAllowedToRespond()</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">templateGateway.getEntityUsedForUserResponse()</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">opfab.currentCard.getEntityUsedForUserResponse()</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">templateGateway.getDisplayContext()</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">opfab.currentCard.getDisplayContext()</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">templateGateway.displayLoadingSpinner()</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">opfab.currentCard.displayLoadingSpinner()</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">templateGateway.hideLoadingSpinner()</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">opfab.currentCard.hideLoadingSpinner()</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">templateGateway.childCards</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">opfab.currentCard.getChildCards()</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">templateGateway.isLocked</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">opfab.currentCard.isResponseLocked()</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">templateGateway.lockAnswer = function () {//do some stuff}</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">opfab.currentCard.listenToResponseLock( () &#8658; {//do some stuff} )</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">templateGateway.unlockAnswer = function () {//do some stuff}</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">opfab.currentCard.listenToResponseUnlock( ()  &#8658; {//do some stuff} )</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">templateGateway.setLttdExpired = function () {//do some stuff}</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">opfab.currentCard.listenToLttdExpired( ()  &#8658; {//do some stuff} )</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">templateGateway.onStyleChange = function () {//do some stuff}</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">opfab.currentCard.listenToStyleChange( ()  &#8658; {//do some stuff} )</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">templateGateway.setScreenSize =  function () {//do some stuff}</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">opfab.currentCard.listenToScreenSize( ()  &#8658; {//do some stuff} )</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">templateGateway.onTemplateRenderingComplete =  function () {//do some stuff}</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">opfab.currentCard.listenToTemplateRenderingComplete( ()  &#8658; {//do some stuff} )</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">templateGateway.getUserResponse =  function () {//do some stuff}</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">opfab.currentCard.registerFunctionToGetUserResponse( ()  &#8658; {//do some stuff} )</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">templateGateway.applyChildCards =  function () {//do some stuff}</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">opfab.currentCard.listenToChildCards( ()  &#8658; {//do some stuff} )</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">usercardTemplateGateway.getCurrentProcess()</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">opfab.currentUserCard.getProcessId()</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">usercardTemplateGateway.getEditionMode()</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">opfab.currentUserCard.getEditionMode()</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">usercardTemplateGateway.getEndDate()</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">opfab.currentUserCard.getEndDate()</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">usercardTemplateGateway.getExpirationDate()</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">opfab.currentUserCard.getExpirationDate()</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">usercardTemplateGateway.getLttd()</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">opfab.currentUserCard.getLttd()</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">usercardTemplateGateway.getSelectedEntityRecipients()</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">opfab.currentUserCard.getSelectedEntityRecipients()</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">usercardTemplateGateway.getSelectedEntityForInformationRecipients()</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">opfab.currentUserCard.getSelectedEntityForInformationRecipients()</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">usercardTemplateGateway.getStartDate()</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">opfab.currentUserCard.getStartDate()</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">usercardTemplateGateway.getCurrentState()</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">opfab.currentUserCard.getState()</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">usercardTemplateGateway.getUserEntityChildCardFromCurrentCard()</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">opfab.currentUserCard.getUserEntityChildCard()</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">usercardTemplateGateway.getSpecificCardInformation =  function () {//do some stuff}</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">opfab.currentUserCard.registerFunctionToGetSpecificCardInformation( ()  &#8658; {//do some stuff} )</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">usercardTemplateGateway.setDropdownEntityRecipientList(recipients)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">opfab.currentUserCard.setDropdownEntityRecipientList(recipients)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">usercardTemplateGateway.setDropdownEntityRecipientForInformationList(recipients)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">opfab.currentUserCard.setDropdownEntityRecipientForInformationList(recipients)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">userCardTemplateGateway.setEntityUsedForSendingCard = function (entityID) {//do some stuff}</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">opfab.currentUserCard.listenToEntityUsedForSendingCard( (entityID)  &#8658; {//do some stuff} )</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">usercardTemplateGateway.setInitialEndDate(endDate)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">opfab.currentUserCard.setInitialEndDate(endDate)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">usercardTemplateGateway.setInitialExpirationDate(expirationDate)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">opfab.currentUserCard.setInitialExpirationDate(expirationDate)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">usercardTemplateGateway.setInitialLttd(lttd)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">opfab.currentUserCard.setInitialLttd(lttd)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">usercardTemplateGateway.setInitialSelectedRecipients(recipients)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">opfab.currentUserCard.setInitialSelectedRecipients(recipients)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">usercardTemplateGateway.setInitialSelectedRecipientsForInformation(recipients)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">opfab.currentUserCard.setInitialSelectedRecipientsForInformation(recipients)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">usercardTemplateGateway.setInitialSeverity(initialSeverity)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">opfab.currentUserCard.setInitialSeverity(initialSeverity)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">usercardTemplateGateway.setInitialStartDate(startDate)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">opfab.currentUserCard.setInitialStartDate(startDate)</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_write_right_for_user_rightsenum_write"><a class="anchor" href="#_write_right_for_user_rightsenum_write"></a>15.4. Write right for user (RightsEnum.Write)</h3>
<div class="paragraph">
<p>The <code>Write</code> right has been removed. Considering <code>Receive</code> and <code>ReceiveAndWrite</code> rights, <code>Write</code> was useless
and confusing for the code.</p>
</div>
<div class="paragraph">
<p>Before upgrading to 4.0, you must replace all "Write" rights by "ReceiveAndWrite" rights. If you want to
automate it, you can do it directly in the database via the following request :</p>
</div>
<div class="paragraph">
<p><code>db.perimeter.updateMany({"stateRights.right": "Write"}, {"$set": {"stateRights.$.right": "ReceiveAndWrite"}});</code></p>
</div>
</div>
<div class="sect2">
<h3 id="_cards_reminder"><a class="anchor" href="#_cards_reminder"></a>15.5. Cards reminder</h3>
<div class="paragraph">
<p>Cards reminder logic has been moved from front-end to back-end. The reminder logic is handled by the new "cards-reminder" service.</p>
</div>
<div class="paragraph">
<p>After upgrading to 4.0, you must call the <code>/reset</code> endpoint to populate the reminders database by processing all current cards with reminder set. For example using cURL:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>curl http://localhost:2107/reset -H "Authorization:Bearer $token"</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_internal_technical_account"><a class="anchor" href="#_internal_technical_account"></a>15.6. Internal technical account</h3>
<div class="paragraph">
<p>The new back service for reminder and the new service regarding mail diffusion and supervision introduce the need of an internal account to communicate between opfab back services. Therefore, if you intend to utilize any of these services, it is necessary to create an Opfab technical account with ADMIN permissions and configure it within your shared YAML configuration file, for example :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>operatorfabric:
  internalAccount:
    login: opfab
    password: the_password</code></pre>
</div>
</div>
<div class="paragraph">
<p>The services require knowledge of the URL to retrieve the account&#8217;s token, and this URL should be configured within operatorfabric.servicesUrls.authToken. A default value, based on OperatorFabric default installation, is set to: "http://web-ui/auth/token".</p>
</div>
</div>
<div class="sect2">
<h3 id="_port_mapping"><a class="anchor" href="#_port_mapping"></a>15.7. Port mapping</h3>
<div class="paragraph">
<p>In release 4.0, the listening port is not any more 8080 for services in docker, it is now identical to the default port mapping outside the docker.</p>
</div>
<div class="paragraph">
<p>So you need to modify your port mapping to migrate replacing the 8080 legacy port by the new port :</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2100</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">businessconfig</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2102</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">cards-publication</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2103</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">users</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2104</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">cards-consultation</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2105</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">external-devices</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Depending on your production configuration, you may need as well to change the ports in your nginx conf file.</p>
</div>
<div class="paragraph">
<p>If you want to keep the old port 8080, you can change it via the server.port parameter in the yml config files of the services.</p>
</div>
</div>
<div class="sect2">
<h3 id="_rabbitmq"><a class="anchor" href="#_rabbitmq"></a>15.8. RabbitMQ</h3>
<div class="paragraph">
<p>In previous versions, it was necessary to start a RabbitMQ container referencing "rabbitmq:3-management." We now highly recommend that you update your configuration to utilize "lfeoperatorfabric/of-rabbitmq:4.0.0.RELEASE" instead. This adjustment ensures that you have a qualified version that is fully compatible with OpFab.</p>
</div>
<div class="paragraph">
<p>When migrating your production environment you may be unable to start rabbitMQ with the following error in log :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>2023-09-14 13:57:00.803114+00:00 [error] &lt;0.230.0&gt; Feature flags: `maintenance_mode_status`: required feature flag not enabled! It must be enabled before upgrading RabbitMQ.
2023-09-14 13:57:00.955976+00:00 [error] &lt;0.230.0&gt; Failed to initialize feature flags registry:{disabled_required_feature_flag,
2023-09-14 13:57:00.955976+00:00 [error] &lt;0.230.0&gt;                                               maintenance_mode_status}

BOOT
FAILED
===========
Error during startup: {error,failed_to_initialize_feature_flags_registry}

2023-09-14 13:57:01.022987+00:00 [error] &lt;0.230.0&gt;
2023-09-14 13:57:01.022987+00:00 [error] &lt;0.230.0&gt; BOOT FAILED
2023-09-14 13:57:01.022987+00:00 [error] &lt;0.230.0&gt; ===========
2023-09-14 13:57:01.022987+00:00 [error] &lt;0.230.0&gt; Error during startup: {error,failed_to_initialize_feature_flags_registry}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This issue arises because the persisted data (RabbitMQ queues) generated by the previous version of RabbitMQ is incompatible with the current RabbitMQ version. To address this problem, it is necessary to remove the persisted data before launching OpFab, which can be found at the path mapping /var/lib/rabbitmq/mnesia/ within the Docker container.</p>
</div>
<div class="paragraph">
<p><strong>If you have configured RabbitMQ persistence, we recommend implementing this as a preventive measure to avoid service unavailability in production.</strong></p>
</div>
</div>
<div class="sect2">
<h3 id="_configuration"><a class="anchor" href="#_configuration"></a>15.9. Configuration</h3>
<div class="paragraph">
<p>The configuration has been simplified, you have now default parameters you do not need to set anymore in the back configuration:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>in all yml file you do not need to set anymore spring.application.name</p>
</li>
<li>
<p>a default kafka configuration is provided, you only have to add "kafka.consumer.group-id : opfab-command" to enable kafka</p>
</li>
<li>
<p>a default rabbit configuration is provided</p>
</li>
<li>
<p>default value are provided for "operatorfabric.servicesUrls.users" and "operatorfabric.servicesUrls.businessconfig"</p>
</li>
<li>
<p>"spring.data.mongodb.database" is not to be set anymore</p>
</li>
<li>
<p>you still need to set "management.endpoints.web.exposure.include: '*'" if you want to monitor opfab via prometheus</p>
</li>
<li>
<p>operatorfabric.businessconfig.storage.path is set by default to "/businessconfig-storage"</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The nginx configuration has been simplified as well, the best is to redefine your actual nginx based on the example /config/docker/nginx.conf. The main modification is the removal of the following endpoints declaration :</p>
</div>
<div class="ulist">
<ul>
<li>
<p>/archives</p>
</li>
<li>
<p>/ui</p>
</li>
<li>
<p>/ui/assets/i18n</p>
</li>
<li>
<p>/config/web-ui.json</p>
</li>
<li>
<p>/config/menu-ui.json</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>We have also implemented data compression for the information supplied by the "businessconfig" service within the "nginx.conf" reference file. This is done by adding  in the location /businessconfig :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>    gzip on;
    gzip_types application/json;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The nginx conf is not loaded anymore in /usr/share/nginx/html/opfab in the docker but in /usr/share/nginx/html/config. You need to modify your volume configuration . For example in docker compose :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>    volumes:
      - &quot;./ui-config:/usr/share/nginx/html/opfab&quot;</code></pre>
</div>
</div>
<div class="paragraph">
<p>becomes :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>    volumes:
      - &quot;./ui-config:/usr/share/nginx/html/config&quot;</code></pre>
</div>
</div>
<div class="paragraph">
<p>In the web-ui.json file, you do not need anymore to set :
- security.jwt.expire-claim
- security.oauth2.flow.provider
- security.oauth2.provider-realm
- security.oauth2.provider-url</p>
</div>
</div>
<div class="sect2">
<h3 id="_normalization_of_some_configuration_parameters"><a class="anchor" href="#_normalization_of_some_configuration_parameters"></a>15.10. Normalization of some configuration parameters</h3>
<div class="paragraph">
<p>Some configuration parameters have been renamed, so you have to check your config files and adapt them. Here are the
concerned parameters (old name &#8594; new name):</p>
</div>
<div class="ulist">
<ul>
<li>
<p>daysBeforeLogExpiration &#8594; operatorfabric.users.daysBeforeLogExpiration</p>
</li>
<li>
<p>checkAuthenticationForCardSending &#8594; operatorfabric.cards-publication.checkAuthenticationForCardSending</p>
</li>
<li>
<p>authorizeToSendCardWithInvalidProcessState &#8594; operatorfabric.cards-publication.authorizeToSendCardWithInvalidProcessState</p>
</li>
<li>
<p>checkPerimeterForCardSending &#8594; operatorfabric.cards-publication.checkPerimeterForCardSending</p>
</li>
<li>
<p>external-recipients.* &#8594; operatorfabric.cards-publication.external-recipients.*</p>
</li>
<li>
<p>opfab.kafka.topics.card.topicname &#8594; operatorfabric.cards-publication.kafka.topics.card.topicname</p>
</li>
<li>
<p>opfab.kafka.topics.response-card.topicname &#8594; operatorfabric.cards-publication.kafka.topics.response-card.topicname</p>
</li>
<li>
<p>opfab.kafka.schema.registry.url &#8594; operatorfabric.cards-publication.kafka.schema.registry.url</p>
</li>
<li>
<p>delayForDeleteExpiredCardsScheduling &#8594; operatorfabric.cards-publication.delayForDeleteExpiredCardsScheduling</p>
</li>
<li>
<p>checkIfUserIsAlreadyConnected &#8594; operatorfabric.checkIfUserIsAlreadyConnected</p>
</li>
<li>
<p>spring.data.mongodb.uri -&#8594;  operatorfabric.mongodb.uri</p>
</li>
<li>
<p>spring.rabbitmq.* -&#8594; operatorfabric.rabbitmq.*</p>
</li>
<li>
<p>spring.security.oauth2.resourceserver.jwt.jwk-set-uri -&#8594;  operatorfabric.security.oauth2.resourceserver.jwt.jwk-set-uri</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_mongodb_uri"><a class="anchor" href="#_mongodb_uri"></a>15.11. Mongodb uri</h3>
<div class="paragraph">
<p>The option "authMode=scram-sha1" has to be removed from mongodb uri as SCRAM authentication is enabled by default and "authMode" option is not supported by node.js mongodb driver.
For example you should change :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code> mongodb:
    uri: mongodb://root:password@mongodb:27017/operator-fabric?authSource=admin&amp;authMode=scram-sha1</code></pre>
</div>
</div>
<div class="paragraph">
<p>to</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code> mongodb:
    uri: mongodb://root:password@mongodb:27017/operator-fabric?authSource=admin</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_rate_limiter_for_card_sendings"><a class="anchor" href="#_rate_limiter_for_card_sendings"></a>15.12. Rate limiter for card sendings</h3>
<div class="paragraph">
<p>External publishers are now monitored by a new module which limits how many cards they can send
<a href="/documentation/current/deployment/configuration/configuration.html#cardSendingLimitCardCount"><code>cardSendingLimitCardCount</code></a>
 in a period of time
<a href="/documentation/current/deployment/configuration/configuration.html#cardSendingLimitPeriod"><code>cardSendingLimitPeriod</code></a>
.
This is to avoid potential overloading due to external apps stuck in a card sending loop.</p>
</div>
<div class="paragraph">
<p>Default value is set to 1000 cards per hour. It can be disabled / enabled with
<a href="/documentation/current/deployment/configuration/configuration.html#activateCardSendingLimiter"><code>activateCardSendingLimiter</code></a></p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_migration_guide_from_release_4_0_0_to_release_4_1_0"><a class="anchor" href="#_migration_guide_from_release_4_0_0_to_release_4_1_0"></a>16. Migration Guide from release 4.0.0 to release 4.1.0</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_optimizing_nginx_configuration_for_latency_reduction"><a class="anchor" href="#_optimizing_nginx_configuration_for_latency_reduction"></a>16.1. Optimizing Nginx Configuration for Latency Reduction</h3>
<div class="paragraph">
<p>An optimization has been introduced in the Nginx configuration to reduce latency. To implement this optimization in your <code>nginx.conf</code> you need to add in <code>location /cards/</code>  the directive <code>proxy_buffering off</code></p>
</div>
<div class="paragraph">
<p>For example :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>  location /cards/ {
    proxy_buffering off;
    proxy_set_header Host $http_host;
    proxy_pass http://cards-consultation:2104/;
    proxy_set_header X-Forwarded-For $remote_addr;
  }</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_updating_the_file_size_limit"><a class="anchor" href="#_updating_the_file_size_limit"></a>16.2. Updating the file size limit</h3>
<div class="paragraph">
<p>The limit of maximum file size has been updated to 100 MB. To implement this limit in your <code>nginx.conf</code> you need to add in <code>location /businessconfig/</code>  the directive <code>client_max_body_size 100M;</code></p>
</div>
<div class="paragraph">
<p>For example :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>  location /businessconfig {
    proxy_set_header Host $http_host;
    proxy_pass http://${MY_DOCKER_HOST}:2100;
    proxy_set_header X-Forwarded-For $remote_addr;
    client_max_body_size 100M;
  }</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_nginx_configuration_for_entity_supervision_administration"><a class="anchor" href="#_nginx_configuration_for_entity_supervision_administration"></a>16.3. Nginx Configuration for entity supervision administration</h3>
<div class="paragraph">
<p>The new 'Supervised Entities' admin page requires interaction with the supervisor API via Nginx. To enable access to the supervisor API, please incorporate the following configuration into your <code>nginx.conf</code> file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>  location ~ &quot;^/supervisor/(.*)&quot; {
    set $supervisor http://supervisor:2108;
    proxy_set_header Host $http_host;
    proxy_pass $supervisor/$1;
    proxy_set_header X-Forwarded-For $remote_addr;
  }</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_supervisor_configuration_change"><a class="anchor" href="#_supervisor_configuration_change"></a>16.4. Supervisor configuration change</h3>
<div class="paragraph">
<p>The configuration of 'supervisor.defaultConfig.entitiesToSupervise' parameter has changed. The supervised entity field <code>id</code> has been renamed to <code>entityId</code>. You should modify your configuration accordingly.</p>
</div>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>  supervisor:
    defaultConfig:
      entitiesToSupervise:
      - id: ENTITY1_FR
        supervisors:
        - ENTITY2_FR
      - id: ENTITY2_FR
        supervisors:
        - ENTITY1_FR</code></pre>
</div>
</div>
<div class="paragraph">
<p>should be changed to:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>  supervisor:
    defaultConfig:
      entitiesToSupervise:
      - entityId: ENTITY1_FR
        supervisors:
        - ENTITY2_FR
      - entityId: ENTITY2_FR
        supervisors:
        - ENTITY1_FR</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_log_directories_in_docker"><a class="anchor" href="#_log_directories_in_docker"></a>16.5. Log directories in docker</h3>
<div class="paragraph">
<p>For the services cards-reminder, supervisor, cards-external-diffusion the log directory in the docker is not anymore /usr/app/logs but /var/log/opfab. So if you map the log directory in your configuration , you need to change it.</p>
</div>
</div>
<div class="sect2">
<h3 id="_opfabapi_2"><a class="anchor" href="#_opfabapi_2"></a>16.6. OpfabAPI</h3>
<div class="paragraph">
<p>The following method is deprecated and it is recommended you use the new method:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Deprecated method or attribute</th>
<th class="tableblock halign-left valign-top">New method</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">opfab.currentCard.getEntityUsedForUserResponse()</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">opfab.currentCard.getEntitiesUsableForUserResponse()</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_migration_guide_from_release_4_1_0_to_release_4_2_0"><a class="anchor" href="#_migration_guide_from_release_4_1_0_to_release_4_2_0"></a>17. Migration Guide from release 4.1.0 to release 4.2.0</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_deletion_of_parameter_displayconnectioncirclesinpreview"><a class="anchor" href="#_deletion_of_parameter_displayconnectioncirclesinpreview"></a>17.1. Deletion of parameter displayConnectionCirclesInPreview</h3>
<div class="paragraph">
<p>The parameter <code>displayConnectionCirclesInPreview</code> has been deleted. Now, in the usercard preview, users will see
which recipients entities are connected or not via badges : a blue badge if connected and a gray one if not.
This feature is provided for all users.
So you have to remove this parameter from the configuration file <code>web-ui.json</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_configuration_files_of_the_realtime_users_screen"><a class="anchor" href="#_configuration_files_of_the_realtime_users_screen"></a>17.2. Configuration files of the realtime users screen</h3>
<div class="paragraph">
<p>Previously, to configure this screen, the json file had to fit the following structure :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="json">{
  <span class="key"><span class="delimiter">&quot;</span><span class="content">realTimeScreens</span><span class="delimiter">&quot;</span></span>: [
    {
      <span class="key"><span class="delimiter">&quot;</span><span class="content">screenName</span><span class="delimiter">&quot;</span></span>: <span class="error">&lt;</span><span class="error">N</span><span class="error">a</span><span class="error">m</span><span class="error">e</span> <span class="error">o</span><span class="error">f</span> <span class="error">t</span><span class="error">h</span><span class="error">e</span> <span class="error">s</span><span class="error">c</span><span class="error">r</span><span class="error">e</span><span class="error">e</span><span class="error">n</span><span class="error">&gt;</span>,
      <span class="key"><span class="delimiter">&quot;</span><span class="content">screenColumns</span><span class="delimiter">&quot;</span></span>: [
        {
          <span class="key"><span class="delimiter">&quot;</span><span class="content">entitiesGroups</span><span class="delimiter">&quot;</span></span>: [
            {
              <span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>: <span class="error">&lt;</span><span class="error">N</span><span class="error">a</span><span class="error">m</span><span class="error">e</span> <span class="error">o</span><span class="error">f</span> <span class="error">a</span> <span class="error">g</span><span class="error">r</span><span class="error">o</span><span class="error">u</span><span class="error">p</span> <span class="error">o</span><span class="error">f</span> <span class="error">e</span><span class="error">n</span><span class="error">t</span><span class="error">i</span><span class="error">t</span><span class="error">i</span><span class="error">e</span><span class="error">s</span><span class="error">&gt;</span>,
              <span class="key"><span class="delimiter">&quot;</span><span class="content">entities</span><span class="delimiter">&quot;</span></span>: [
                <span class="error">&lt;</span><span class="error">e</span><span class="error">n</span><span class="error">t</span><span class="error">i</span><span class="error">t</span><span class="error">y</span><span class="integer">1</span> <span class="error">i</span><span class="error">d</span><span class="error">&gt;</span>,
                <span class="error">&lt;</span><span class="error">e</span><span class="error">n</span><span class="error">t</span><span class="error">i</span><span class="error">t</span><span class="error">y</span><span class="integer">2</span> <span class="error">i</span><span class="error">d</span><span class="error">&gt;</span>
              ]
            },
            {
              <span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>: <span class="error">&lt;</span><span class="error">N</span><span class="error">a</span><span class="error">m</span><span class="error">e</span> <span class="error">o</span><span class="error">f</span> <span class="error">a</span><span class="error">n</span><span class="error">o</span><span class="error">t</span><span class="error">h</span><span class="error">e</span><span class="error">r</span> <span class="error">g</span><span class="error">r</span><span class="error">o</span><span class="error">u</span><span class="error">p</span> <span class="error">o</span><span class="error">f</span> <span class="error">e</span><span class="error">n</span><span class="error">t</span><span class="error">i</span><span class="error">t</span><span class="error">i</span><span class="error">e</span><span class="error">s</span><span class="error">&gt;</span>,
              <span class="key"><span class="delimiter">&quot;</span><span class="content">entities</span><span class="delimiter">&quot;</span></span>: [
                <span class="error">&lt;</span><span class="error">e</span><span class="error">n</span><span class="error">t</span><span class="error">i</span><span class="error">t</span><span class="error">y</span><span class="integer">3</span> <span class="error">i</span><span class="error">d</span><span class="error">&gt;</span>,
                <span class="error">&lt;</span><span class="error">e</span><span class="error">n</span><span class="error">t</span><span class="error">i</span><span class="error">t</span><span class="error">y</span><span class="integer">4</span> <span class="error">i</span><span class="error">d</span><span class="error">&gt;</span>
              ]
            }
          ]
        }
      ]
    }
  ]
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now entities shouldn&#8217;t be grouped in the configuration file anymore. Instead entities are grouped by a shared parent entity. The configuration file needs to be changed to the following structure:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="json">{
  <span class="key"><span class="delimiter">&quot;</span><span class="content">realTimeScreens</span><span class="delimiter">&quot;</span></span>: [
    {
      <span class="key"><span class="delimiter">&quot;</span><span class="content">screenName</span><span class="delimiter">&quot;</span></span>: <span class="error">&lt;</span><span class="error">N</span><span class="error">a</span><span class="error">m</span><span class="error">e</span> <span class="error">o</span><span class="error">f</span> <span class="error">t</span><span class="error">h</span><span class="error">e</span> <span class="error">s</span><span class="error">c</span><span class="error">r</span><span class="error">e</span><span class="error">e</span><span class="error">n</span><span class="error">&gt;</span>,
      <span class="key"><span class="delimiter">&quot;</span><span class="content">screenColumns</span><span class="delimiter">&quot;</span></span>: [
        {
          <span class="key"><span class="delimiter">&quot;</span><span class="content">entitiesGroups</span><span class="delimiter">&quot;</span></span>: [<span class="string"><span class="delimiter">&quot;</span><span class="content">&lt;parent entity 1 id&gt;</span><span class="delimiter">&quot;</span></span>,<span class="string"><span class="delimiter">&quot;</span><span class="content">&lt;parent entity 2 id&gt;</span><span class="delimiter">&quot;</span></span>]
        }
      ]
    }
  ]
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>With this parent entity 1 and parent entity 2 need to be declared and the name of the parent entities will be the name of the groups.</p>
</div>
</div>
<div class="sect2">
<h3 id="_updating_the_entity_roles_in_the_database"><a class="anchor" href="#_updating_the_entity_roles_in_the_database"></a>17.3. Updating the entity roles in the database</h3>
<div class="paragraph">
<p>In this release the "roles" attribute has been added to the entity object. It defines the utility of an entity. It absorbs and broaden the logic of the attribute "entityAllowedToSendCard" which becomes deprecated.
To update the entities in your mongo database, you can execute the following script located in <code>OF_HOME/src/tooling/migration-entity-roles</code> :</p>
</div>
<div class="paragraph">
<p><code>./launchMigration.sh &lt;IP or DNSNameMongoDB&gt; &lt;portMongoDB&gt; &lt;loginMongoDB&gt; &lt;passwordMongoDB&gt;</code></p>
</div>
<div class="paragraph">
<p>This script will assign the roles "ACTIVITY_AREA", "CARD_RECEIVER" and "CARD_SENDER" to all the entities that have "entityAllowedToSendCard = true" and the role "CARD_RECEIVER" to the others. Please refer to the documentation to see the other possible roles and their effect.</p>
</div>
<div class="paragraph">
<p>After successful execution of the previous script you should execute the following script to cleanup the database removing the deprecated attribute "entityAllowedToSendCard":</p>
</div>
<div class="paragraph">
<p><code>./cleanMongoAfterMigration.sh &lt;IP or DNSNameMongoDB&gt; &lt;portMongoDB&gt; &lt;loginMongoDB&gt; &lt;passwordMongoDB&gt;</code></p>
</div>
</div>
<div class="sect2">
<h3 id="_deletion_of_deprecated_functions_in_templategatewayusercardtemplategateway"><a class="anchor" href="#_deletion_of_deprecated_functions_in_templategatewayusercardtemplategateway"></a>17.4. Deletion of deprecated functions in templateGateway/usercardTemplateGateway</h3>
<div class="paragraph">
<p>Functions in templateGateway/usercardTemplateGateway do not exist anymore, you can refer to the
migration documentation to opfab 4.0 to know which functions you have to use.</p>
</div>
</div>
<div class="sect2">
<h3 id="_card_keepchildcards"><a class="anchor" href="#_card_keepchildcards"></a>17.5. Card keepChildCards</h3>
<div class="paragraph">
<p>The card field <code>keepChildCards</code> is now deprecated, use the new <code>actions</code> field (string array) including "KEEP_CHILD_CARDS" action instead.</p>
</div>
</div>
<div class="sect2">
<h3 id="_feed_process_and_state_filter"><a class="anchor" href="#_feed_process_and_state_filter"></a>17.6. Feed process and state filter</h3>
<div class="paragraph">
<p>New filters have been added to feed filters to allow filtering by card process and state.
It is possible to hide the process filter by setting <code>feed.card.hideProcessFilter</code> to <code>true</code> in <code>web-ui.json</code> config file. When process filter is hidden than also state filter is hidden.
It is possible to hide just the the state filter by setting <code>feed.card.hideStateFilter</code> to <code>true</code> in <code>web-ui.json</code> config file.</p>
</div>
</div>
<div class="sect2">
<h3 id="_user_settings"><a class="anchor" href="#_user_settings"></a>17.7. User settings</h3>
<div class="paragraph">
<p>A new setting to send emails in plain text instead of HTML has been added in the settings screen of the user.
This setting can be hidden in the configuration file of the web-ui by the field "settings.settingsScreen.hiddenSettings" by adding the value "emailToPlainText".</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_migration_guide_from_release_4_2_0_to_release_4_3_0"><a class="anchor" href="#_migration_guide_from_release_4_2_0_to_release_4_3_0"></a>18. Migration Guide from release 4.2.0 to release 4.3.0</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_admin_group"><a class="anchor" href="#_admin_group"></a>18.1. ADMIN group</h3>
<div class="paragraph">
<p>Users belonging to 'ADMIN' group will not be automatically given admin rights anymore.
The admin rights will be set only if user is member of a group with ADMIN permission.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
Before initiating the migration process, ensure that all users with administrative privileges are members of a group that has been explicitly granted the 'ADMIN' permission. Failing to do so may result in loss of the ability to administrate operator fabric
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_map_multiple_geojson_layers"><a class="anchor" href="#_map_multiple_geojson_layers"></a>18.2. Map multiple GeoJSON layers</h3>
<div class="paragraph">
<p>It is now possible to add more than one GeoJSON layer to the map. To allow the configuration of multiple layers the <code>feed.geomap.layer.geojson</code> configuration parameter in web-ui.json is now an array. for each layer it is possible to specify the url and an optional style. The style object can have styling properties for stroke, fill, image, and text styles as defined in OpenLayer flat style (<a href="https://openlayers.org/en/latest/apidoc/module-ol_style_flat.html" class="bare">openlayers.org/en/latest/apidoc/module-ol_style_flat.html</a>)
You should change your configuration for geoJSON layer to configure it as an array, for example:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>      "layer": {
        "geojson": {
          "url": "assets/layers/geojson-layer.json"
        }
      }</pre>
</div>
</div>
<div class="paragraph">
<p>should be changed to:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>      "layer": {
        "geojson": [
          {
            "url": "assets/layers/geojson-layer.json"
          }
        ]
      }</pre>
</div>
</div>
<div class="paragraph">
<p>Or adding the style:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>      "layer": {
        "geojson": [
          {
            "url": "assets/layers/geojson-layer.json",
            "style": {
              "stroke-color": "blue",
              "stroke-width": 1.5,
              "fill-color": "rgba(39, 245, 164, 0.4)"
            }
          }
        ]
      }</pre>
</div>
</div>
<div class="paragraph">
<p>If no style is defined the layer will be rendered with default Opfab style.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_migration_guide_from_release_4_3_x_to_release_4_4_0"><a class="anchor" href="#_migration_guide_from_release_4_3_x_to_release_4_4_0"></a>19. Migration Guide from release 4.3.X to release 4.4.0</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_use_of_client_id_to_obtain_token"><a class="anchor" href="#_use_of_client_id_to_obtain_token"></a>19.1. Use of client_id to obtain token</h3>
<div class="paragraph">
<p>In the example script getToken.sh, a parameter client_id is set to <code>opfab-client</code>. This value was in fact not necessary and has been removed . The client_id is managed by the <code>web-ui</code> service and is not required in the authentication requests. You can remove the client_id from your scripts.</p>
</div>
</div>
<div class="sect2">
<h3 id="_endpoints_configuration"><a class="anchor" href="#_endpoints_configuration"></a>19.2. Endpoints configuration</h3>
<div class="paragraph">
<p>To enhance consistency and avoid confusion, we made the following modifications to the endpoints:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>When accessed via <code>web-ui</code>(nginx), the endpoint <code>/cards</code> has been replaced by <code>/cards-consultation</code>.</p>
</li>
<li>
<p>When accessed via <code>web-ui</code>(nginx), the endpoint <code>/cardspub</code> has been replaced by <code>/cards-publication</code>.</p>
</li>
<li>
<p>The base path for accessing the <code>businessconfig</code> service directly (without passing through <code>web-ui</code>) has been changed from <code>/businessconfig</code> to <code>/</code>.</p>
</li>
<li>
<p>Added endpoints <code>/cards-reminder</code> and <code>/cards-external diffusion</code> to access cards-reminder and cards-external diffusion services via nginx for opfab cli</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Please note that the old endpoint <code>/businessconfig</code> is still available but will be removed in a future release.</p>
</div>
<div class="paragraph">
<p>We have simplified our nginx reference configuration. Instead of adjusting your configuration for the new release, you can rebuild your configuration using the new reference configuration (located at <code>config/docker/nginx.conf</code>) and adapt it to your specific needs.</p>
</div>
<div class="paragraph">
<p>If you prefer to adapt your existing file, the following changes should be made:</p>
</div>
<div class="paragraph">
<p>For example, consider this configuration:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>  location /cards/ {
    proxy_buffering off;
    proxy_set_header Host $http_host;
    proxy_pass http://cards-consultation:2104/;
    proxy_set_header X-Forwarded-For $remote_addr;
  }

  location /cardspub/cards {
    proxy_set_header Host $http_host;
    proxy_pass http://cards-publication:2102/cards;
    proxy_set_header X-Forwarded-For $remote_addr;
  }

   location /businessconfig {
    gzip on;
    gzip_types application/json;
    proxy_set_header Host $http_host;
    proxy_pass http://businessconfig:2100;
    proxy_set_header X-Forwarded-For $remote_addr;
    client_max_body_size 100M;
  }</pre>
</div>
</div>
<div class="paragraph">
<p>This should be changed to:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>  location /cards-consultation/ {
    proxy_buffering off;
    proxy_set_header Host $http_host;
    proxy_pass http://cards-consultation:2104/;
    proxy_set_header X-Forwarded-For $remote_addr;
  }

  location /cards-publication/ {
    proxy_set_header Host $http_host;
    proxy_pass http://cards-publication:2102/;
    proxy_set_header X-Forwarded-For $remote_addr;
  }

  location /businessconfig/ {
    gzip on;
    gzip_types application/json;
    proxy_set_header Host $http_host;
    proxy_pass http://businessconfig:2100/;
    proxy_set_header X-Forwarded-For $remote_addr;
    client_max_body_size 100M;
  }

  location /cards-external-diffusion/ {
    proxy_set_header Host $http_host;
    proxy_pass http://cards-external-diffusion:2106/;
    proxy_set_header X-Forwarded-For $remote_addr;
  }

  location /cards-reminder/ {
    proxy_set_header Host $http_host;
    proxy_pass http://cards-reminder:2107/;
    proxy_set_header X-Forwarded-For $remote_addr;
  }</pre>
</div>
</div>
<div class="paragraph">
<p>For a smooth, real-time migration, you can temporarily keep endpoints '/cards' and '/cardspub' in your Nginx configuration and remove the old one after a while.</p>
</div>
<div class="paragraph">
<p>If you are using the <code>businessconfig</code> service directly via some scripts, you need to update these scripts.</p>
</div>
</div>
<div class="sect2">
<h3 id="_tooltips"><a class="anchor" href="#_tooltips"></a>19.3. Tooltips</h3>
<div class="paragraph">
<p>For templates and external applications, the tooltip styling now allows HTML inside of it and the implementation syntax changed from:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="HTML"><span class="tag">&lt;span</span> <span class="attribute-name">opfab-tooltip-text</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Here is an example of tooltip</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">class</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">opfab-tooltip</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>Some tooltip text<span class="tag">&lt;/span&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>to :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="HTML"><span class="tag">&lt;div</span> <span class="attribute-name">class</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">opfab-tooltip</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>Some tooltip text
    <span class="tag">&lt;div</span> <span class="attribute-name">class</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">opfab-tooltip-content</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>Here is an example of a tooltip<span class="tag">&lt;/div&gt;</span>
<span class="tag">&lt;/div&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>For positioning, it is done in the element with class <code>opfab-tooltip-content</code> instead of the element with class <code>opfab-tooltip</code>. You need to change for example from:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="HTML">  <span class="tag">&lt;span</span> <span class="attribute-name">opfab-tooltip-text</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Here is an example of tooltip</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">class</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">opfab-tooltip left</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>Some tooltip text<span class="tag">&lt;/span&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>to:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="HTML"><span class="tag">&lt;div</span> <span class="attribute-name">class</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">opfab-tooltip</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>Some tooltip text
    <span class="tag">&lt;div</span> <span class="attribute-name">class</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">opfab-tooltip-content left</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>Here is an example of tooltip<span class="tag">&lt;/div&gt;</span>
<span class="tag">&lt;/div&gt;</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_migration_guide_from_release_4_4_x_to_release_4_5_0"><a class="anchor" href="#_migration_guide_from_release_4_4_x_to_release_4_5_0"></a>20. Migration Guide from release 4.4.X to release 4.5.0</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_use_of_docker_compose_v2"><a class="anchor" href="#_use_of_docker_compose_v2"></a>20.1. Use of <code>docker compose v2</code></h3>
<div class="paragraph">
<p>OperatorFabric is now using <code>docker compose v2</code>, so you have to upgrade this tool to continue using opfab.
You can find more information in the docker documentation : <a href="https://docs.docker.com/compose/migrate/" class="bare">docs.docker.com/compose/migrate/</a></p>
</div>
</div>
<div class="sect2">
<h3 id="_use_of_date_fns_instead_of_moment_js_library"><a class="anchor" href="#_use_of_date_fns_instead_of_moment_js_library"></a>20.2. Use of <code>date-fns</code> instead of <code>Moment.js</code> library</h3>
<div class="paragraph">
<p>OperatorFabric is now using <code>date-fns</code> library instead of <code>Moment.js</code>. The format used for defining a formatted date string
is now different. So, if needed:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>in the file <code>web-ui.json</code>, you have to modify your fields : <code>settings.dateTimeformat</code>
and <code>settings.dateFormat</code>.</p>
</li>
<li>
<p>in your templates when using handlebars helper <code>dateFormat</code>, you have to modify the formatting string</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can find the available formats here : <a href="https://date-fns.org/v3.6.0/docs/format" class="bare">date-fns.org/v3.6.0/docs/format</a></p>
</div>
<div class="paragraph">
<p>Especially you have to replace <code>YYYY</code> by <code>yyyy</code> and <code>DD</code> by <code>dd</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_deletion_of_the_parameter_secondsafterpublicationtoconsidercardasnotread"><a class="anchor" href="#_deletion_of_the_parameter_secondsafterpublicationtoconsidercardasnotread"></a>20.3. Deletion of the parameter <code>secondsAfterPublicationToConsiderCardAsNotRead</code></h3>
<div class="paragraph">
<p>OperatorFabric is now sending emails whether a card is read or not. So, the parameter
<code>secondsAfterPublicationToConsiderCardAsNotRead</code> having become useless, it was deleted, and
you can safely remove it from your configuration file.</p>
</div>
</div>
<div class="sect2">
<h3 id="_ui_configuration_2"><a class="anchor" href="#_ui_configuration_2"></a>20.4. UI Configuration</h3>
<div class="paragraph">
<p>Some fields of the <code>web-ui.json</code> file have changed and renamed:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>alerts.messageBusinessAutoClose</code> has been renamed as <code>alerts.alarmLevelAutoClose</code></p>
</li>
<li>
<p><code>alerts.hideBusinessMessages</code> has been renamed as <code>alerts.doNotAlertForHiddenCardReceived</code></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_hallway_mode_setting"><a class="anchor" href="#_hallway_mode_setting"></a>20.5. Hallway mode setting</h3>
<div class="paragraph">
<p>The <code>settings.usersInHallwayMode</code> configuration field has been removed from <code>web-ui.json</code>.
The option to automatically open the most recent card (hallway mode) is now available as a user setting in UI settings view.</p>
</div>
</div>
<div class="sect2">
<h3 id="_process_monitoring_configuration"><a class="anchor" href="#_process_monitoring_configuration"></a>20.6. Process monitoring configuration</h3>
<div class="paragraph">
<p>The configuration for process monitoring screen has been removed from <code>web-ui.json</code> and externalized in a dedicated JSON file. The process monitoring configuration file has to be loaded by sending an HTTP POST request to the <code>/processmonitoring</code> API of businessconfig service or using the CLI command <code>opfab process-monitoring load &lt;file&gt;</code>.
The structure of the process monitoring configuration fields has to be modified as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>"fieldsForProcesses" is now an array of objects with "process" and "fields" fields.</p>
</li>
<li>
<p>The "size" attribute in now a number, not a string as before</p>
</li>
<li>
<p>"filters" is now an object with "pageSize" and "tags" fields</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>So for example the configuration should be changed from:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="json"><span class="key"><span class="delimiter">&quot;</span><span class="content">fieldsForProcesses</span><span class="delimiter">&quot;</span></span>: {
      <span class="key"><span class="delimiter">&quot;</span><span class="content">conferenceAndITIncidentExample</span><span class="delimiter">&quot;</span></span> : [
        { <span class="key"><span class="delimiter">&quot;</span><span class="content">field</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">startDate</span><span class="delimiter">&quot;</span></span>, <span class="key"><span class="delimiter">&quot;</span><span class="content">type</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">date</span><span class="delimiter">&quot;</span></span>, <span class="key"><span class="delimiter">&quot;</span><span class="content">colName</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">Start Date</span><span class="delimiter">&quot;</span></span>, <span class="key"><span class="delimiter">&quot;</span><span class="content">size</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">200</span><span class="delimiter">&quot;</span></span>},
        { <span class="key"><span class="delimiter">&quot;</span><span class="content">field</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">titleTranslated</span><span class="delimiter">&quot;</span></span>, <span class="key"><span class="delimiter">&quot;</span><span class="content">colName</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">Title</span><span class="delimiter">&quot;</span></span>, <span class="key"><span class="delimiter">&quot;</span><span class="content">size</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">250</span><span class="delimiter">&quot;</span></span>},
        { <span class="key"><span class="delimiter">&quot;</span><span class="content">field</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">entityRecipients</span><span class="delimiter">&quot;</span></span>, <span class="key"><span class="delimiter">&quot;</span><span class="content">type</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">array</span><span class="delimiter">&quot;</span></span>, <span class="key"><span class="delimiter">&quot;</span><span class="content">colName</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">Entity Recipients</span><span class="delimiter">&quot;</span></span>, <span class="key"><span class="delimiter">&quot;</span><span class="content">size</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">400</span><span class="delimiter">&quot;</span></span>}
      ],
      <span class="key"><span class="delimiter">&quot;</span><span class="content">messageOrQuestionExample</span><span class="delimiter">&quot;</span></span> : [
        { <span class="key"><span class="delimiter">&quot;</span><span class="content">field</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">startDate</span><span class="delimiter">&quot;</span></span>, <span class="key"><span class="delimiter">&quot;</span><span class="content">type</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">date</span><span class="delimiter">&quot;</span></span>, <span class="key"><span class="delimiter">&quot;</span><span class="content">colName</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">Start Date</span><span class="delimiter">&quot;</span></span>, <span class="key"><span class="delimiter">&quot;</span><span class="content">size</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">200</span><span class="delimiter">&quot;</span></span>},
        { <span class="key"><span class="delimiter">&quot;</span><span class="content">field</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">endDate</span><span class="delimiter">&quot;</span></span>, <span class="key"><span class="delimiter">&quot;</span><span class="content">type</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">date</span><span class="delimiter">&quot;</span></span>, <span class="key"><span class="delimiter">&quot;</span><span class="content">colName</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">End Date</span><span class="delimiter">&quot;</span></span>, <span class="key"><span class="delimiter">&quot;</span><span class="content">size</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">200</span><span class="delimiter">&quot;</span></span>},
        { <span class="key"><span class="delimiter">&quot;</span><span class="content">field</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">titleTranslated</span><span class="delimiter">&quot;</span></span>, <span class="key"><span class="delimiter">&quot;</span><span class="content">colName</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">Title</span><span class="delimiter">&quot;</span></span>, <span class="key"><span class="delimiter">&quot;</span><span class="content">size</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">250</span><span class="delimiter">&quot;</span></span>},
        { <span class="key"><span class="delimiter">&quot;</span><span class="content">field</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">entityRecipients</span><span class="delimiter">&quot;</span></span>, <span class="key"><span class="delimiter">&quot;</span><span class="content">type</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">array</span><span class="delimiter">&quot;</span></span>, <span class="key"><span class="delimiter">&quot;</span><span class="content">colName</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">Entity Recipients</span><span class="delimiter">&quot;</span></span>, <span class="key"><span class="delimiter">&quot;</span><span class="content">size</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">400</span><span class="delimiter">&quot;</span></span>}
      ]
    },
    <span class="key"><span class="delimiter">&quot;</span><span class="content">filters</span><span class="delimiter">&quot;</span></span>: {
      <span class="key"><span class="delimiter">&quot;</span><span class="content">tags</span><span class="delimiter">&quot;</span></span>: {
        <span class="key"><span class="delimiter">&quot;</span><span class="content">list</span><span class="delimiter">&quot;</span></span>: [
          {
            <span class="key"><span class="delimiter">&quot;</span><span class="content">label</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">Label for tag 1</span><span class="delimiter">&quot;</span></span>,
            <span class="key"><span class="delimiter">&quot;</span><span class="content">value</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">tag1</span><span class="delimiter">&quot;</span></span>
          },
          {
            <span class="key"><span class="delimiter">&quot;</span><span class="content">label</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">Label for tag 2</span><span class="delimiter">&quot;</span></span>,
            <span class="key"><span class="delimiter">&quot;</span><span class="content">value</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">tag2</span><span class="delimiter">&quot;</span></span>
          }
        ]
      },
      <span class="key"><span class="delimiter">&quot;</span><span class="content">page</span><span class="delimiter">&quot;</span></span>: {
        <span class="key"><span class="delimiter">&quot;</span><span class="content">size</span><span class="delimiter">&quot;</span></span>: <span class="integer">10</span>
      }
    }</code></pre>
</div>
</div>
<div class="paragraph">
<p>to</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="json">   <span class="key"><span class="delimiter">&quot;</span><span class="content">fieldsForProcesses</span><span class="delimiter">&quot;</span></span>: [
      {
        <span class="key"><span class="delimiter">&quot;</span><span class="content">process</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">conferenceAndITIncidentExample</span><span class="delimiter">&quot;</span></span>,
        <span class="key"><span class="delimiter">&quot;</span><span class="content">fields</span><span class="delimiter">&quot;</span></span> : [
        { <span class="key"><span class="delimiter">&quot;</span><span class="content">field</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">startDate</span><span class="delimiter">&quot;</span></span>, <span class="key"><span class="delimiter">&quot;</span><span class="content">type</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">date</span><span class="delimiter">&quot;</span></span>, <span class="key"><span class="delimiter">&quot;</span><span class="content">colName</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">Start Date</span><span class="delimiter">&quot;</span></span>, <span class="key"><span class="delimiter">&quot;</span><span class="content">size</span><span class="delimiter">&quot;</span></span>: <span class="integer">200</span>},
        { <span class="key"><span class="delimiter">&quot;</span><span class="content">field</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">titleTranslated</span><span class="delimiter">&quot;</span></span>, <span class="key"><span class="delimiter">&quot;</span><span class="content">colName</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">Title</span><span class="delimiter">&quot;</span></span>, <span class="key"><span class="delimiter">&quot;</span><span class="content">size</span><span class="delimiter">&quot;</span></span>: <span class="integer">250</span>},
        { <span class="key"><span class="delimiter">&quot;</span><span class="content">field</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">entityRecipients</span><span class="delimiter">&quot;</span></span>, <span class="key"><span class="delimiter">&quot;</span><span class="content">type</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">array</span><span class="delimiter">&quot;</span></span>, <span class="key"><span class="delimiter">&quot;</span><span class="content">colName</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">Entity Recipients</span><span class="delimiter">&quot;</span></span>, <span class="key"><span class="delimiter">&quot;</span><span class="content">size</span><span class="delimiter">&quot;</span></span>: <span class="integer">400</span>}
      ]}, {
        <span class="key"><span class="delimiter">&quot;</span><span class="content">process</span><span class="delimiter">&quot;</span></span> : <span class="string"><span class="delimiter">&quot;</span><span class="content">messageOrQuestionExample</span><span class="delimiter">&quot;</span></span>,
        <span class="key"><span class="delimiter">&quot;</span><span class="content">fields</span><span class="delimiter">&quot;</span></span> : [
        { <span class="key"><span class="delimiter">&quot;</span><span class="content">field</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">startDate</span><span class="delimiter">&quot;</span></span>, <span class="key"><span class="delimiter">&quot;</span><span class="content">type</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">date</span><span class="delimiter">&quot;</span></span>, <span class="key"><span class="delimiter">&quot;</span><span class="content">colName</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">Start Date</span><span class="delimiter">&quot;</span></span>, <span class="key"><span class="delimiter">&quot;</span><span class="content">size</span><span class="delimiter">&quot;</span></span>: <span class="integer">200</span>},
        { <span class="key"><span class="delimiter">&quot;</span><span class="content">field</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">endDate</span><span class="delimiter">&quot;</span></span>, <span class="key"><span class="delimiter">&quot;</span><span class="content">type</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">date</span><span class="delimiter">&quot;</span></span>, <span class="key"><span class="delimiter">&quot;</span><span class="content">colName</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">End Date</span><span class="delimiter">&quot;</span></span>, <span class="key"><span class="delimiter">&quot;</span><span class="content">size</span><span class="delimiter">&quot;</span></span>: <span class="integer">200</span>},
        { <span class="key"><span class="delimiter">&quot;</span><span class="content">field</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">titleTranslated</span><span class="delimiter">&quot;</span></span>, <span class="key"><span class="delimiter">&quot;</span><span class="content">colName</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">Title</span><span class="delimiter">&quot;</span></span>, <span class="key"><span class="delimiter">&quot;</span><span class="content">size</span><span class="delimiter">&quot;</span></span>: <span class="integer">250</span>},
        { <span class="key"><span class="delimiter">&quot;</span><span class="content">field</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">entityRecipients</span><span class="delimiter">&quot;</span></span>, <span class="key"><span class="delimiter">&quot;</span><span class="content">type</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">array</span><span class="delimiter">&quot;</span></span>, <span class="key"><span class="delimiter">&quot;</span><span class="content">colName</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">Entity Recipients</span><span class="delimiter">&quot;</span></span>, <span class="key"><span class="delimiter">&quot;</span><span class="content">size</span><span class="delimiter">&quot;</span></span>: <span class="integer">400</span>}
      ]}
    ],
    <span class="key"><span class="delimiter">&quot;</span><span class="content">filters</span><span class="delimiter">&quot;</span></span>: {
      <span class="key"><span class="delimiter">&quot;</span><span class="content">tags</span><span class="delimiter">&quot;</span></span>: [
          {
            <span class="key"><span class="delimiter">&quot;</span><span class="content">label</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">Label for tag 1</span><span class="delimiter">&quot;</span></span>,
            <span class="key"><span class="delimiter">&quot;</span><span class="content">value</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">tag1</span><span class="delimiter">&quot;</span></span>
          },
          {
            <span class="key"><span class="delimiter">&quot;</span><span class="content">label</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">Label for tag 2</span><span class="delimiter">&quot;</span></span>,
            <span class="key"><span class="delimiter">&quot;</span><span class="content">value</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">tag2</span><span class="delimiter">&quot;</span></span>
          }
        ],
        <span class="key"><span class="delimiter">&quot;</span><span class="content">pageSize</span><span class="delimiter">&quot;</span></span>: <span class="integer">10</span>
      }</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_deletion_of_view_all_archived_cards_and_view_all_archived_cards_for_user_perimeters_permissions"><a class="anchor" href="#_deletion_of_view_all_archived_cards_and_view_all_archived_cards_for_user_perimeters_permissions"></a>20.7. Deletion of <code>VIEW_ALL_ARCHIVED_CARDS</code> and <code>VIEW_ALL_ARCHIVED_CARDS_FOR_USER_PERIMETERS</code> permissions</h3>
<div class="paragraph">
<p>In order to simplify the code and the administration of opfab, we have deleted the permissions
<code>VIEW_ALL_ARCHIVED_CARDS</code> and <code>VIEW_ALL_ARCHIVED_CARDS_FOR_USER_PERIMETERS</code>. So, administrators of opfab have to
update manually the permissions of the users via the UI, replacing VIEW_ALL_ARCHIVED_CARDS by
VIEW_ALL_CARDS and VIEW_ALL_ARCHIVED_CARDS_FOR_USER_PERIMETERS by VIEW_ALL_CARDS_FOR_USER_PERIMETERS.</p>
</div>
</div>
<div class="sect2">
<h3 id="_deletion_of_the_deprecated_api_method_opfab_currentcard_getentityusedforuserresponse"><a class="anchor" href="#_deletion_of_the_deprecated_api_method_opfab_currentcard_getentityusedforuserresponse"></a>20.8. Deletion of the deprecated API method <code>opfab.currentCard.getEntityUsedForUserResponse()</code></h3>
<div class="paragraph">
<p>As mentioned in the migration guide to opfab 4.1, the API method <code>opfab.currentCard.getEntityUsedForUserResponse()</code>
has been replaced by <code>opfab.currentCard.getEntitiesUsableForUserResponse()</code>. Now, this deprecated API method has been
deleted, so you need to upgrade your code and use the method <code>opfab.currentCard.getEntitiesUsableForUserResponse()</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_removed_deprecated_keepchildcards_field"><a class="anchor" href="#_removed_deprecated_keepchildcards_field"></a>20.9. Removed deprecated <code>keepChildCards</code> field</h3>
<div class="paragraph">
<p>The deprecated card field <code>keepChildCards</code> has been removed. Use the <code>actions</code> field (string array) including "KEEP_CHILD_CARDS" action instead.</p>
</div>
</div>
<div class="sect2">
<h3 id="_opfab_cli_renaming_log_commands"><a class="anchor" href="#_opfab_cli_renaming_log_commands"></a>20.10. Opfab CLI : renaming log commands</h3>
<div class="paragraph">
<p>The log commands for opfab CLI have been renamed.</p>
</div>
<div class="paragraph">
<p>Now, instead of doing <code>opfab service get-log-level &lt;serviceName&gt;</code>, you have to do <code>opfab log get-level  &lt;serviceName&gt;</code>.
And instead of doing <code>opfab service set-log-level &lt;serviceName&gt; &lt;level&gt;</code>, you have to do <code>opfab log set-level  &lt;serviceName&gt; &lt;level&gt;</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_rabbitmq_2"><a class="anchor" href="#_rabbitmq_2"></a>20.11. RabbitMQ</h3>
<div class="paragraph">
<p>The version of RabbitMQ is now 4.0.2. Before deploying it in production, if you are using a persistent queue, you need to clean the persistent file directory; otherwise, you will not be able to start the RabbitMQ docker container. (Inside the docker, the persistent folder is <code>/var/lib/rabbitmq/mnesia/</code>)</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_migration_guide_from_release_4_5_x_to_release_4_6_0"><a class="anchor" href="#_migration_guide_from_release_4_5_x_to_release_4_6_0"></a>21. Migration Guide from release 4.5.X to release 4.6.0</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_removed_field_tonotify"><a class="anchor" href="#_removed_field_tonotify"></a>21.1. Removed field <code>toNotify</code></h3>
<div class="paragraph">
<p>The card field <code>toNotify</code> has been removed. You must use the <code>actions</code> field including "STORE_ONLY_IN_ARCHIVES" action instead.</p>
</div>
</div>
<div class="sect2">
<h3 id="_new_line_added_between_opfab_fields_and_template_in_usercard_form"><a class="anchor" href="#_new_line_added_between_opfab_fields_and_template_in_usercard_form"></a>21.2. New line added between opfab fields and template in usercard form</h3>
<div class="paragraph">
<p>A new line (&lt;br/&gt;) has been added in the usercard form, between the opfab fields (service/process/state or severity or
dates fields (depending on which fields are visible or not)) and the display of the template. So you have to check that
the display of your usercard form still suits you.</p>
</div>
</div>
<div class="sect2">
<h3 id="_timeline_domain_tr_renamed_rt"><a class="anchor" href="#_timeline_domain_tr_renamed_rt"></a>21.3. Timeline domain TR renamed RT</h3>
<div class="paragraph">
<p>To be consistent, the timeline domain TR has been renamed RT (Real Time).
So if necessary, you have to update your config file <code>web-ui.json</code>, replacing value <code>TR</code> with <code>RT</code> in the field
<code>feed.timeline.domains</code>, for example :</p>
</div>
<div class="listingblock">
<div class="content">
<pre> "timeline": {
   "domains": [
     "RT",
     "J",
     "7D",
     "W",
     "M",
     "Y"
   ]
 }</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_ui_archives_and_logging_number_of_lines_per_page"><a class="anchor" href="#_ui_archives_and_logging_number_of_lines_per_page"></a>21.4. UI archives and logging number of lines per page</h3>
<div class="paragraph">
<p>Since it is now possible to select the number of lines per page displayed in the archive and logging screens, the configuration parameters <code>archive.filters.page.size</code> and <code>logging.filters.page.size</code> are no longer needed and can be removed from the web-ui.json file.</p>
</div>
</div>
<div class="sect2">
<h3 id="_configuration_for_recap_email"><a class="anchor" href="#_configuration_for_recap_email"></a>21.5. Configuration for recap email</h3>
<div class="paragraph">
<p>The feature to send weekly recapitulation email has been added and thus the configuration of operatorfabric.cardsExternalDiffusion has changed.
Before, this was the default configuration for the daily email :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>  dailyEmailTitle: 'Cards received during the day'
  hourToSendDailyEmail: 7
  minuteToSendDailyEmail: 30</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now the following fields have been added :</p>
</div>
<div class="ulist">
<ul>
<li>
<p>dailyEmailBodyPrefix</p>
</li>
<li>
<p>weeklyEmailBodyPrefix</p>
</li>
<li>
<p>weeklyEmailTitle</p>
</li>
<li>
<p>dayOfWeekToSendWeeklyRecapEmail</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>And the time fields have changed from :</p>
</div>
<div class="ulist">
<ul>
<li>
<p>hourToSendDailyEmail</p>
</li>
<li>
<p>minuteToSendDailyEmail</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>to :</p>
</div>
<div class="ulist">
<ul>
<li>
<p>hourToSendRecapEmail</p>
</li>
<li>
<p>minuteToSendRecapEmail</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The new default configuration is as such :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>  dailyEmailTitle: 'Cards received during the day'
  weeklyEmailTitle: 'Cards received during the week'
  dailyEmailBodyPrefix: 'You received the following cards during the past 24 hours : '
  weeklyEmailBodyPrefix: 'You received the following cards during the past 7 days : '
  dayOfWeekToSendWeeklyRecapEmail: 1
  hourToSendRecapEmail: 7
  minuteToSendRecapEmail: 30</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_timezone"><a class="anchor" href="#_timezone"></a>21.6. Timezone</h3>
<div class="paragraph">
<p>For the cards-external-diffusion service, the timezone configuration has been moved from the Dockerfile to the docker-compose.yml file. If nothing is set in the docker compose file, the default value will be the local timezone of your machine.</p>
</div>
</div>
<div class="sect2">
<h3 id="_email_templates"><a class="anchor" href="#_email_templates"></a>21.7. Email templates</h3>
<div class="paragraph">
<p>To be homogeneous with UI templates, it is now necessary to prefix the handlebars variables with "card" in the email templates. For example, the following code</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>&lt;div id=&quot;apogee-contingencies&quot;&gt;
    {{#data.networkContingencies}}</code></pre>
</div>
</div>
<div class="paragraph">
<p>is to be changed to</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>&lt;div id=&quot;apogee-contingencies&quot;&gt;
  {{#card.data.networkContingencies}}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_email_templates_custom_parameters"><a class="anchor" href="#_email_templates_custom_parameters"></a>21.8. Email templates custom parameters</h3>
<div class="paragraph">
<p>It is now possible to configure custom parameters to be used in handlebars email templates.
The custom parameter can be added in cards-external-diffusion configuration under the "defaultConfig.customConfig" section:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>cardsExternalDiffusion:
    adminPort: 2106
    activeOnStartup: true
    defaultConfig:
      mailFrom: opfab@localhost.it
      subjectPrefix: 'Opfab card received '
      customConfig:
             myParam1: 'myValue1'
             myParam2: 'myValue2'</code></pre>
</div>
</div>
<div class="paragraph">
<p>The custom parameters can then be referred in handlebars template prefixed with "config", for example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>{{#config.myParam1}}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This change has an impact on existing mail templates, as the existing handlebars variables will have to be prefixed with "card", for example on the existing example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>&lt;div id=&quot;apogee-contingencies&quot;&gt;
    {{#data.networkContingencies}}</code></pre>
</div>
</div>
<div class="paragraph">
<p>is to be changed to</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>&lt;div id=&quot;apogee-contingencies&quot;&gt;
  {{#card.data.networkContingencies}}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_removed_field_timespans_recurrence"><a class="anchor" href="#_removed_field_timespans_recurrence"></a>21.9. Removed field <code>timespans.recurrence</code></h3>
<div class="paragraph">
<p>The field <code>timespans.recurrence</code> has been removed. So now, to create a recurrent card, you must use the field rRule.
There is a script to migrate existing tasks using recurrence object. After the call to this script, you have to call the
endpoint "reset". Example :</p>
</div>
<div class="ulist">
<ul>
<li>
<p>node migration-rrule-recurrence.js &lt;databaseURL&gt; &lt;databasePort&gt; &lt;databaseLogin&gt; &lt;databasePassword&gt; &lt;oldProcessId&gt; &lt;newProcessId&gt; &lt;oldStateId&gt; &lt;newStateId&gt; &lt;newProcessVersion&gt;</p>
</li>
<li>
<p>curl <a href="http://localhost:2107/reset" class="bare">localhost:2107/reset</a> -H "Authorization:Bearer $token"</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_migration_guide_from_release_4_6_x_to_release_4_7_0"><a class="anchor" href="#_migration_guide_from_release_4_6_x_to_release_4_7_0"></a>22. Migration Guide from release 4.6.X to release 4.7.0</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_user_settings_2"><a class="anchor" href="#_user_settings_2"></a>22.1. User settings</h3>
<div class="paragraph">
<p>A new setting to activate or not the templating of emails has been added in the settings screen of the user.
This setting can be hidden in the configuration file of the web-ui by the field "settings.settingsScreen.hiddenSettings" by adding the value "disableCardContentInEmails".</p>
</div>
</div>
<div class="sect2">
<h3 id="_response_card"><a class="anchor" href="#_response_card"></a>22.2. Response card</h3>
<div class="paragraph">
<p>The object that should be returned by the method registered via <code>opfab.currentCard.registerFunctionToGetUserResponse</code> is to be changed.</p>
</div>
<div class="paragraph">
<p>Previously, the object was structured as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>{
    valid: true/false,
    errorMsg: string,
    responseCardData: {},
    responseState: string,
    publisher: string,
    actions: [string]
}</pre>
</div>
</div>
<div class="paragraph">
<p>Now, all elements related to the response card are encapsulated within a <code>responseCard</code> object:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>{
    valid: true/false,
    errorMsg: string,
    responseCard: {
        data: {},
        state: string,
        publisher: string,
        actions: [string]
    }
}</pre>
</div>
</div>
<div class="paragraph">
<p>Note that the <code>responseState</code> field has been renamed to <code>state</code>.</p>
</div>
<div class="paragraph">
<p>The old structure will be supported as a fallback for a limited time, it is recommended to update your code to use the new structure.
`</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_migration_guide_from_release_4_8_x_to_release_4_9_0"><a class="anchor" href="#_migration_guide_from_release_4_8_x_to_release_4_9_0"></a>23. Migration Guide from release 4.8.X to release 4.9.0</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_geomap_configuration"><a class="anchor" href="#_geomap_configuration"></a>23.1. Geomap configuration</h3>
<div class="paragraph">
<p>As a new layer type (<code>wmts</code>) has been added, the geomap configuration has been updated for improved clarity in layer management. All layers are now stored in a single property.</p>
</div>
<div class="paragraph">
<p>You must update your configuration to match this new structure.</p>
</div>
<div class="paragraph">
<p>The layers and tiles of the map can now be configured using the <code>feed.geomap.layers</code> property. This property accepts an array of objects, each representing a layer with a <code>type</code> property and additional configuration options depending on the layer type. The following layer types are supported:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>osm</code>: OpenStreetMap tiles. No additional configuration required.</p>
</li>
<li>
<p><code>geojson</code>: GeoJSON layers. Requires a <code>url</code> for the GeoJSON file and optionally a <code>style</code> object for feature styling. The <code>style</code> object supports stroke, fill, image, and text styles as defined in the OpenLayers flat style format (see: <a href="https://openlayers.org/en/latest/apidoc/module-ol_style_flat.html" class="bare">openlayers.org/en/latest/apidoc/module-ol_style_flat.html</a>).</p>
</li>
<li>
<p><code>xyz</code>: XYZ tiles. Requires a <code>url</code> endpoint with <code>{x}</code>, <code>{y}</code>, and <code>{z}</code> variables (e.g., "https://service.pdok.nl/brt/achtergrondkaart/wmts/v2_0/grijs/EPSG:3857/{z}/{x}/{y}.png"). You may also specify:</p>
<div class="ulist">
<ul>
<li>
<p><code>tileSize</code>: Integer value (e.g., 256). Required for custom background layers.</p>
</li>
<li>
<p><code>crossOrigin</code>: Optional. Default is <code>null</code>.</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>wmts</code>: WMTS layers. Requires <code>capabilitiesUrl</code>, <code>layer</code>, and <code>matrixSet</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Example configuration for the <code>feed.geomap.layers</code> property:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>&quot;layers&quot;: [
                {
                    &quot;type&quot;:&quot;osm&quot;
                },
                {
                    &quot;type&quot;:&quot;wmts&quot;,
                    &quot;capabilitiesUrl&quot;:&quot;https://data.geopf.fr/annexes/ressources/wmts/essentiels.xml&quot;,
                    &quot;layer&quot;:&quot;CADASTRALPARCELS.PARCELLAIRE_EXPRESS&quot;,
                    &quot;matrixSet&quot;:&quot;PM_0_19&quot;
                },
                {
                    &quot;type&quot;: &quot;geojson&quot;,
                    &quot;url&quot;: &quot;https://opendata.agenceore.fr/api/explore/v2.1/catalog/datasets/reseau-aerien-haute-tension-htb/exports/geojson?lang=fr&amp;timezone=Europe%2FBerlin&quot;,
                    &quot;style&quot;: {
                        &quot;stroke-color&quot;: &quot;red&quot;
                    }
                },
                {
                    &quot;type&quot;: &quot;geojson&quot;,
                    &quot;url&quot;: &quot;assets/layers/geojson-layer2.json&quot;
                }

            ]</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_entities_in_token"><a class="anchor" href="#_entities_in_token"></a>23.2. Entities in Token</h3>
<div class="paragraph">
<p>When retrieving entities from a token, the recommended approach is to use an array attribute containing entity IDs as strings. The previous method, which uses a single string with semicolon-separated IDs, remains available for backward compatibility. To enable the old mode, set the parameter <code>operatorfabric.security.jwt.entitiesIdClaimSingleString</code> to <code>true</code> in your YAML services configuration.</p>
</div>
</div>
<div class="sect2">
<h3 id="_deletion_of_monitoring_screen"><a class="anchor" href="#_deletion_of_monitoring_screen"></a>23.3. Deletion of monitoring screen</h3>
<div class="paragraph">
<p>The monitoring screen is not needed anymore as a similar screen can be defined via custom screens.
Here is a custom screen configuration that can replace the monitoring screen :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>{
    const CustomScreenMonitoring = {
        id: 'monitoringId',
        name: 'monitoring',
        headerFilters: ['PROCESS', 'TYPE_OF_STATE', 'RESPONSE_FROM_MY_ENTITIES'],

        results: {
            columns: [
                {
                    field: 'severity',
                    cardField: 'severity',
                    fieldType: 'SEVERITY'
                },
                {
                    field: 'TIME',
                    headerName: 'TIME',
                    cardField: 'publishDate',
                    fieldType: 'DATE_AND_TIME',
                    minWidth: 150,
                    flex: 0.5
                },
                {
                    field: 'title',
                    headerName: 'TITLE',
                    cardField: 'titleTranslated',
                    fieldType: 'STRING',
                    flex: 1,
                    minWidth: 150
                },
                {
                    field: 'summary',
                    headerName: 'SUMMARY',
                    cardField: 'summaryTranslated',
                    fieldType: 'STRING',
                    flex: 2,
                    minWidth: 150,
                    showTooltips: true
                },
                {
                    fieldType: 'TYPE_OF_STATE',
                    headerName: 'PROCESS STATUS',
                    flex: 0.6,
                    minWidth: 150
                },
                {
                    field: 'publisher',
                    headerName: 'EMITTER',
                    cardField: 'publisher',
                    fieldType: 'PUBLISHER',
                    flex: 1,
                    minWidth: 150
                },
                {
                    headerName: 'ANSWERS',
                    fieldType: 'RESPONSES',
                    flex: 2,
                    minWidth: 400
                }
            ]
        }
    };
    opfab.businessconfig.registerCustomScreen(CustomScreenMonitoring);
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</body>
</html>