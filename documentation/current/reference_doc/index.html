<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.8">
<title>OperatorFabric Reference Documentation</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/* Asciidoctor default stylesheet | MIT License | http://asciidoctor.org */
/* Uncomment @import statement below to use as custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section,summary{display:block}
audio,canvas,video{display:inline-block}
audio:not([controls]){display:none;height:0}
script{display:none!important}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
a{background:transparent}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*::before,*::after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto;tab-size:4;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:none}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite::before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt,table tr:nth-of-type(even){background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
*:not(pre)>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background-color:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed;word-wrap:break-word}
*:not(pre)>code.nobreak{word-wrap:normal}
*:not(pre)>code.nowrap{white-space:nowrap}
pre,pre>code{line-height:1.45;color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;text-rendering:optimizeSpeed}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background-color:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background-color:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:100%;background-color:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock pre:not(.highlight),.listingblock pre[class="highlight"],.listingblock pre[class^="highlight "],.listingblock pre.CodeRay,.listingblock pre.prettyprint{background:#f7f7f8}
.sidebarblock .literalblock pre,.sidebarblock .listingblock pre:not(.highlight),.sidebarblock .listingblock pre[class="highlight"],.sidebarblock .listingblock pre[class^="highlight "],.sidebarblock .listingblock pre.CodeRay,.sidebarblock .listingblock pre.prettyprint{background:#f2f1f1}
.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:1em}}
.literalblock pre.nowrap,.literalblock pre.nowrap pre,.listingblock pre.nowrap,.listingblock pre.nowrap pre{white-space:pre;word-wrap:normal}
.literalblock.output pre{color:#f7f7f8;background-color:rgba(0,0,0,.9)}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:#999}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:#999}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
table.pyhltable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.pyhltable td{vertical-align:top;padding-top:0;padding-bottom:0;line-height:1.45}
table.pyhltable td.code{padding-left:.75em;padding-right:0}
pre.pygments .lineno,table.pyhltable td:not(.code){color:#999;padding-left:0;padding-right:.5em;border-right:1px solid #dddddf}
pre.pygments .lineno{display:inline-block;margin-right:.25em}
table.pyhltable .linenodiv{background:none!important;padding-right:0!important}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt,.quoteblock .quoteblock{margin:0 0 1.25em;padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;text-align:left;margin-right:0}
table.tableblock{max-width:100%;border-collapse:separate}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>thead>tr>.tableblock,table.grid-all>tbody>tr>.tableblock{border-width:0 1px 1px 0}
table.grid-all>tfoot>tr>.tableblock{border-width:1px 1px 0 0}
table.grid-cols>*>tr>.tableblock{border-width:0 1px 0 0}
table.grid-rows>thead>tr>.tableblock,table.grid-rows>tbody>tr>.tableblock{border-width:0 0 1px}
table.grid-rows>tfoot>tr>.tableblock{border-width:1px 0 0}
table.grid-all>*>tr>.tableblock:last-child,table.grid-cols>*>tr>.tableblock:last-child{border-right-width:0}
table.grid-all>tbody>tr:last-child>.tableblock,table.grid-all>thead:last-child>tr>.tableblock,table.grid-rows>tbody>tr:last-child>.tableblock,table.grid-rows>thead:last-child>tr>.tableblock{border-bottom-width:0}
table.frame-all{border-width:1px}
table.frame-sides{border-width:0 1px}
table.frame-topbot,table.frame-ends{border-width:1px 0}
table.stripes-all tr,table.stripes-odd tr:nth-of-type(odd){background:#f8f8f7}
table.stripes-none tr,table.stripes-odd tr:nth-of-type(even){background:none}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
td>div.verse{white-space:pre}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{margin-right:.25em}
ul.inline{display:-ms-flexbox;display:-webkit-box;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background-color:#00fafa}
.black{color:#000}
.black-background{background-color:#000}
.blue{color:#0000bf}
.blue-background{background-color:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background-color:#fa00fa}
.gray{color:#606060}
.gray-background{background-color:#7d7d7d}
.green{color:#006000}
.green-background{background-color:#007d00}
.lime{color:#00bf00}
.lime-background{background-color:#00fa00}
.maroon{color:#600000}
.maroon-background{background-color:#7d0000}
.navy{color:#000060}
.navy-background{background-color:#00007d}
.olive{color:#606000}
.olive-background{background-color:#7d7d00}
.purple{color:#600060}
.purple-background{background-color:#7d007d}
.red{color:#bf0000}
.red-background{background-color:#fa0000}
.silver{color:#909090}
.silver-background{background-color:#bcbcbc}
.teal{color:#006060}
.teal-background{background-color:#007d7d}
.white{color:#bfbfbf}
.white-background{background-color:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background-color:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background-color:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background-color:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media print,amzn-kf8{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<style>
/* Stylesheet for CodeRay to match GitHub theme | MIT License | http://foundation.zurb.com */
/*pre.CodeRay {background-color:#f7f7f8;}*/
.CodeRay .line-numbers{border-right:1px solid #d8d8d8;padding:0 0.5em 0 .25em}
.CodeRay span.line-numbers{display:inline-block;margin-right:.5em;color:rgba(0,0,0,.3)}
.CodeRay .line-numbers strong{color:rgba(0,0,0,.4)}
table.CodeRay{border-collapse:separate;border-spacing:0;margin-bottom:0;border:0;background:none}
table.CodeRay td{vertical-align: top;line-height:1.45}
table.CodeRay td.line-numbers{text-align:right}
table.CodeRay td.line-numbers>pre{padding:0;color:rgba(0,0,0,.3)}
table.CodeRay td.code{padding:0 0 0 .5em}
table.CodeRay td.code>pre{padding:0}
.CodeRay .debug{color:#fff !important;background:#000080 !important}
.CodeRay .annotation{color:#007}
.CodeRay .attribute-name{color:#000080}
.CodeRay .attribute-value{color:#700}
.CodeRay .binary{color:#509}
.CodeRay .comment{color:#998;font-style:italic}
.CodeRay .char{color:#04d}
.CodeRay .char .content{color:#04d}
.CodeRay .char .delimiter{color:#039}
.CodeRay .class{color:#458;font-weight:bold}
.CodeRay .complex{color:#a08}
.CodeRay .constant,.CodeRay .predefined-constant{color:#008080}
.CodeRay .color{color:#099}
.CodeRay .class-variable{color:#369}
.CodeRay .decorator{color:#b0b}
.CodeRay .definition{color:#099}
.CodeRay .delimiter{color:#000}
.CodeRay .doc{color:#970}
.CodeRay .doctype{color:#34b}
.CodeRay .doc-string{color:#d42}
.CodeRay .escape{color:#666}
.CodeRay .entity{color:#800}
.CodeRay .error{color:#808}
.CodeRay .exception{color:inherit}
.CodeRay .filename{color:#099}
.CodeRay .function{color:#900;font-weight:bold}
.CodeRay .global-variable{color:#008080}
.CodeRay .hex{color:#058}
.CodeRay .integer,.CodeRay .float{color:#099}
.CodeRay .include{color:#555}
.CodeRay .inline{color:#000}
.CodeRay .inline .inline{background:#ccc}
.CodeRay .inline .inline .inline{background:#bbb}
.CodeRay .inline .inline-delimiter{color:#d14}
.CodeRay .inline-delimiter{color:#d14}
.CodeRay .important{color:#555;font-weight:bold}
.CodeRay .interpreted{color:#b2b}
.CodeRay .instance-variable{color:#008080}
.CodeRay .label{color:#970}
.CodeRay .local-variable{color:#963}
.CodeRay .octal{color:#40e}
.CodeRay .predefined{color:#369}
.CodeRay .preprocessor{color:#579}
.CodeRay .pseudo-class{color:#555}
.CodeRay .directive{font-weight:bold}
.CodeRay .type{font-weight:bold}
.CodeRay .predefined-type{color:inherit}
.CodeRay .reserved,.CodeRay .keyword {color:#000;font-weight:bold}
.CodeRay .key{color:#808}
.CodeRay .key .delimiter{color:#606}
.CodeRay .key .char{color:#80f}
.CodeRay .value{color:#088}
.CodeRay .regexp .delimiter{color:#808}
.CodeRay .regexp .content{color:#808}
.CodeRay .regexp .modifier{color:#808}
.CodeRay .regexp .char{color:#d14}
.CodeRay .regexp .function{color:#404;font-weight:bold}
.CodeRay .string{color:#d20}
.CodeRay .string .string .string{background:#ffd0d0}
.CodeRay .string .content{color:#d14}
.CodeRay .string .char{color:#d14}
.CodeRay .string .delimiter{color:#d14}
.CodeRay .shell{color:#d14}
.CodeRay .shell .delimiter{color:#d14}
.CodeRay .symbol{color:#990073}
.CodeRay .symbol .content{color:#a60}
.CodeRay .symbol .delimiter{color:#630}
.CodeRay .tag{color:#008080}
.CodeRay .tag-special{color:#d70}
.CodeRay .variable{color:#036}
.CodeRay .insert{background:#afa}
.CodeRay .delete{background:#faa}
.CodeRay .change{color:#aaf;background:#007}
.CodeRay .head{color:#f8f;background:#505}
.CodeRay .insert .insert{color:#080}
.CodeRay .delete .delete{color:#800}
.CodeRay .change .change{color:#66f}
.CodeRay .head .head{color:#f4f}
</style>
</head>
<body class="article toc2 toc-left">
<div id="header">
<h1>OperatorFabric Reference Documentation</h1>
<div class="details">
<span id="revnumber">version 1.7.0.RELEASE,</span>
<span id="revdate">19 October 2020</span>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_introduction">1. Introduction</a></li>
<li><a href="#_sending_cards">2. Sending cards</a>
<ul class="sectlevel2">
<li><a href="#card_structure">2.1. Card Structure</a>
<ul class="sectlevel3">
<li><a href="#_technical_information_of_the_card">2.1.1. Technical Information of the card</a>
<ul class="sectlevel4">
<li><a href="#_mandatory_information">2.1.1.1. Mandatory information</a></li>
<li><a href="#_state_in_the_process_state">2.1.1.2. State in the process (<code>state</code>)</a></li>
<li><a href="#_recipient_recipient">2.1.1.3. Recipient (<code>recipient</code>)</a></li>
<li><a href="#_optional_information">2.1.1.4. Optional information</a></li>
<li><a href="#_business_period">2.1.1.5. Business period</a></li>
<li><a href="#_store_information">2.1.1.6. Store information</a></li>
</ul>
</li>
<li><a href="#_user_destined_information_of_the_card">2.1.2. User destined Information of the card</a>
<ul class="sectlevel4">
<li><a href="#_in_card_format">2.1.2.1. in Card Format</a></li>
<li><a href="#_custom_part">2.1.2.2. Custom part</a></li>
</ul>
</li>
<li><a href="#_presentation_information_of_the_card">2.1.3. Presentation Information of the card</a>
<ul class="sectlevel4">
<li><a href="#_details_details">2.1.3.1. details (<code>details</code>)</a></li>
<li><a href="#_timespans_timespans">2.1.3.2. TimeSpans (<code>timeSpans</code>)</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_cards_examples">2.2. Cards Examples</a>
<ul class="sectlevel3">
<li><a href="#minimal_card">2.2.1. Minimal Card</a>
<ul class="sectlevel4">
<li><a href="#_send_to_one_user">2.2.1.1. Send to One User</a></li>
<li><a href="#_send_to_several_users">2.2.1.2. Send to several users</a></li>
</ul>
</li>
<li><a href="#_regular_card">2.2.2. Regular Card</a>
<ul class="sectlevel4">
<li><a href="#_full_of_hidden_data">2.2.2.1. Full of Hidden data</a></li>
<li><a href="#_fully_useful">2.2.2.2. Fully useful</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a href="#_card_rendering">3. Card rendering</a>
<ul class="sectlevel2">
<li><a href="#_declaring_a_process_and_its_configuration">3.1. Declaring a Process and its configuration</a>
<ul class="sectlevel3">
<li><a href="#_the_config_json_file">3.1.1. The config.json file</a></li>
<li><a href="#_i18n">3.1.2. i18n</a>
<ul class="sectlevel4">
<li><a href="#_template_folder">3.1.2.1. Template folder</a></li>
<li><a href="#_processes_and_states">3.1.2.2. Processes and States</a></li>
<li><a href="#_upload">3.1.2.3. Upload</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#template_description">3.2. Templates</a>
<ul class="sectlevel3">
<li><a href="#_operatorfabric_specific_handlebars_helpers">3.2.1. OperatorFabric specific handlebars helpers</a>
<ul class="sectlevel4">
<li><a href="#numberformat">3.2.1.1. numberFormat</a></li>
<li><a href="#dateformat">3.2.1.2. dateFormat</a></li>
<li><a href="#slice">3.2.1.3. slice</a></li>
<li><a href="#now">3.2.1.4. now</a></li>
<li><a href="#preservespace">3.2.1.5. preserveSpace</a></li>
<li><a href="#bool">3.2.1.6. bool</a></li>
<li><a href="#math">3.2.1.7. math</a></li>
<li><a href="#split">3.2.1.8. split</a></li>
<li><a href="#svg">3.2.1.9. svg</a></li>
<li><a href="#i18n">3.2.1.10. i18n</a></li>
<li><a href="#sort">3.2.1.11. sort</a></li>
<li><a href="#arrayContains">3.2.1.12. arrayContains</a></li>
<li><a href="#times">3.2.1.13. times</a></li>
<li><a href="#toBreakage">3.2.1.14. toBreakage</a></li>
<li><a href="#keyValue">3.2.1.15. keyValue</a></li>
<li><a href="#_keepspacesandendofline">3.2.1.16. keepSpacesAndEndOfLine</a></li>
</ul>
</li>
<li><a href="#_charts">3.2.2. Charts</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#response_cards">4. Response cards</a>
<ul class="sectlevel2">
<li><a href="#_steps_needed_to_use_a_response_card">4.1. Steps needed to use a response card</a>
<ul class="sectlevel3">
<li><a href="#_define_a_third_party_tool">4.1.1. Define a third party tool</a></li>
<li><a href="#_configure_the_response_in_config_json">4.1.2. Configure the response in config.json</a></li>
<li><a href="#_design_the_question_form_in_the_template">4.1.3. Design the question form in the template</a></li>
<li><a href="#_define_permissions">4.1.4. Define permissions</a></li>
</ul>
</li>
<li><a href="#_send_a_question_card">4.2. Send a question card</a></li>
<li><a href="#_integrate_child_cards">4.3. Integrate child cards</a></li>
</ul>
</li>
<li><a href="#_archived_cards">5. Archived Cards</a>
<ul class="sectlevel2">
<li><a href="#_key_concepts">5.1. Key concepts</a></li>
<li><a href="#_archives_screen_in_the_ui">5.2. Archives screen in the UI</a></li>
</ul>
</li>
<li><a href="#users_management">6. User management</a>
<ul class="sectlevel2">
<li><a href="#_users_groups_entities_and_perimeters">6.1. Users, groups, entities and perimeters</a>
<ul class="sectlevel3">
<li><a href="#_users">6.1.1. Users</a>
<ul class="sectlevel4">
<li><a href="#_automated_user_creation">6.1.1.1. Automated user creation</a></li>
</ul>
</li>
<li><a href="#_groups">6.1.2. Groups</a></li>
<li><a href="#_entities">6.1.3. Entities</a></li>
<li><a href="#_perimeters">6.1.4. Perimeters</a></li>
<li><a href="#_alternative_way_to_manage_groups_and_entities">6.1.5. Alternative way to manage groups and entities</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_ui_customization">7. UI Customization</a>
<ul class="sectlevel2">
<li><a href="#_ui_configuration">7.1. UI configuration</a></li>
<li><a href="#menu_entries">7.2. Menu Entries</a>
<ul class="sectlevel3">
<li><a href="#_config_json_declaration">7.2.1. config.json declaration</a></li>
<li><a href="#_examples_2">7.2.2. Examples</a></li>
<li><a href="#_operator_fabric_theme">7.2.3. Operator Fabric theme</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>The aim of this document is to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Explain what OperatorFabric is about and define the concepts it relies on</p>
</li>
<li>
<p>Give a basic tour of its features from a user perspective</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_introduction"><a class="anchor" href="#_introduction"></a>1. Introduction</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To perform their duties, an operator has to interact with multiple applications
(perform actions, watch for alerts, etc.), which can prove difficult if
there are too many of them.</p>
</div>
<div class="paragraph">
<p>The idea is to aggregate all the notifications from all these applications
into a single screen, and to allow the operator to act on them if needed.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="../images/feed_screenshot.png" alt="Feed screen layout">
</div>
</div>
<div class="paragraph">
<p>These notifications are materialized by <strong>cards</strong> sorted in a <strong>feed</strong> according
to their period of relevance and their severity.
When a card is selected in the feed, the right-hand pane displays the <strong>details</strong>
of the card.</p>
</div>
<div class="paragraph">
<p>In addition, the cards will also translate as events displayed on a <strong>timeline</strong>
 at the top of the screen.</p>
</div>
<div class="paragraph">
<p>Part of the value of OperatorFabric is that it makes the integration very
simple on the part of the third-party applications.
To start publishing cards to users in an OperatorFabric instance, all they
have to do is:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Register as a publisher through the "Businessconfig" service and provide a "bundle"
containing handlebars templates defining how cards should be rendered,
i18n info etc.</p>
</li>
<li>
<p>Publish cards as json containing card data through the card publication API</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>OperatorFabric will then:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Dispatch the cards to the appropriate users (by computing the actual users
who should receive the card from the recipients rules defined in the card)</p>
</li>
<li>
<p>Take care of the rendering of the cards</p>
</li>
<li>
<p>Display relevant information from the cards in the timeline</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>A card is not only information, it could be question(s) the operator has to answer.
When the operator is responding, a  card is emitted to the sender of the initial card
and the response could be seen by other operators.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="../images/ResponseCardScreenshot.png" alt="Feed screen layout">
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_sending_cards"><a class="anchor" href="#_sending_cards"></a>2. Sending cards</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The Cards Publication Service exposes a REST API through which third-party applications, or "publishers" can post cards
to OperatorFabric. It then handles those cards:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Time-stamping them with a "publishDate"</p>
</li>
<li>
<p>Sending them to the message broker (RabbitMQ) to be delivered in real time to the appropriate operators</p>
</li>
<li>
<p>Persisting them to the database (MongoDB) for later consultation</p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="card_structure"><a class="anchor" href="#card_structure"></a>2.1. Card Structure</h3>
<div class="paragraph">
<p>Cards are represented as <code>Json</code>Â objects. The technical design of cards is described in
<a href="../../../../documentation/current/api/cards/">the cards api documentation</a>
. A card correspond to the state of a Process in OperatorFabric.</p>
</div>
<div class="sect3">
<h4 id="_technical_information_of_the_card"><a class="anchor" href="#_technical_information_of_the_card"></a>2.1.1. Technical Information of the card</h4>
<div class="paragraph">
<p>Those attributes are used by OperatorFabric to manage how cards are stored, to whom and when they&#8217;re sent.</p>
</div>
<div class="sect4">
<h5 id="_mandatory_information"><a class="anchor" href="#_mandatory_information"></a>2.1.1.1. Mandatory information</h5>
<div class="paragraph">
<p>Below, the <code>json</code> technical key is in the '()' following the title.</p>
</div>
<div class="sect5">
<h6 id="_publisher_publisher"><a class="anchor" href="#_publisher_publisher"></a>Publisher (<code>publisher</code>)</h6>
<div class="paragraph">
<p>The publisher field bears the identifier of the emitter of the card, be it an entity or an external service.</p>
</div>
</div>
<div class="sect5">
<h6 id="card_process"><a class="anchor" href="#card_process"></a>Process (<code>process</code>)</h6>
<div class="paragraph">
<p>This field indicates which process the card is attached to. This information is used to resolve the presentation
resources (bundle) used to render the card and card details.</p>
</div>
</div>
<div class="sect5">
<h6 id="card_process_version"><a class="anchor" href="#card_process_version"></a>Process Version (<code>processVersion</code>)</h6>
<div class="paragraph">
<p>The rendering of cards of a given process can evolve over time. To allow for this while making sure previous cards
remain correctly handled, OperatorFabric can manage several versions of the same process.
The <code>processVersion</code> field indicate which version of the process should be used to retrieve the presentation resources
(i18n, templates, etc.) to render this card.</p>
</div>
</div>
<div class="sect5">
<h6 id="_process_instance_identifier_processinstanceid"><a class="anchor" href="#_process_instance_identifier_processinstanceid"></a>Process Instance Identifier (<code>processInstanceId</code>)</h6>
<div class="paragraph">
<p>A card is associated to a given process, which defines how it is rendered, but it is also more precisely associated to
a <strong>specific instance</strong> of this process. The <code>processInstanceId</code> field contains the unique identifier of the process instance.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_state_in_the_process_state"><a class="anchor" href="#_state_in_the_process_state"></a>2.1.1.2. State in the process (<code>state</code>)</h5>
<div class="paragraph">
<p>The card represent a specific state in the process. In addition to the process, this information is used to resolve the presentation
resources used to render the card and card details.</p>
</div>
<div class="sect5">
<h6 id="start_date"><a class="anchor" href="#start_date"></a>Start Date (<code>startDate</code>)</h6>
<div class="paragraph">
<p>Start date of the active period of the card (process business time).</p>
</div>
</div>
<div class="sect5">
<h6 id="_severity_severity"><a class="anchor" href="#_severity_severity"></a>Severity (<code>severity</code>)</h6>
<div class="paragraph">
<p>The severity is a core principe of the OperatorFabric Card system. There are 4 severities available.
A color is associated in the GUI to each severity. Here the details about severity and their meaning for OperatorFabric:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>ALARM: represents a critical state of the associated process, need an action from the operator. In the UI, the card is red;</p>
</li>
<li>
<p>ACTION: the associated process need an action form operators in order to evolve correctly. In the UI, the card is orange;</p>
</li>
<li>
<p>COMPLIANT: the process related to the card is in a compliant status. In the UI, the card is green.;</p>
</li>
<li>
<p>INFORMATION: give information to the operator. In the UI, the card is blue.</p>
</li>
</ol>
</div>
</div>
<div class="sect5">
<h6 id="card_title"><a class="anchor" href="#card_title"></a>Title (<code>title</code>)</h6>
<div class="paragraph">
<p>This attribute is display as header of a card in the feed of the GUI. It&#8217;s the main User destined Information of a card. The value refer to an <code>i18n</code> value used to localize this information.</p>
</div>
</div>
<div class="sect5">
<h6 id="card_summary"><a class="anchor" href="#card_summary"></a>Summary (<code>summary</code>)</h6>
<div class="paragraph">
<p>This attribute is display as a description of a card in the feed of the GUI, when the card is selected by the operator. It&#8217;s completing the information of the card title. The value refer to an <code>i18n</code> value used to localize this information.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_recipient_recipient"><a class="anchor" href="#_recipient_recipient"></a>2.1.1.3. Recipient (<code>recipient</code>)</h5>
<div class="paragraph">
<p>Declares to whom the card is send. For more details about way recipient works see
<a href="../../../../documentation/current/reference_doc/index.html#display_rules">Display rules</a>
. Without recipient declaration a card is useless in <code>OperatorFabric</code> system.</p>
</div>
</div>
<div class="sect4">
<h5 id="_optional_information"><a class="anchor" href="#_optional_information"></a>2.1.1.4. Optional information</h5>
<div class="sect5">
<h6 id="end_date"><a class="anchor" href="#end_date"></a>End Date (<code>endDate</code>)</h6>
<div class="paragraph">
<p>End date of the active period of the card (process business time).</p>
</div>
</div>
<div class="sect5">
<h6 id="_tags_tag"><a class="anchor" href="#_tags_tag"></a>Tags (<code>tag</code>)</h6>
<div class="paragraph">
<p>Tags are intended as an additional way to filter cards in the feed of the GUI.</p>
</div>
</div>
<div class="sect5">
<h6 id="_entityrecipients_entityrecipients"><a class="anchor" href="#_entityrecipients_entityrecipients"></a>EntityRecipients (<code>entityRecipients</code>)</h6>
<div class="paragraph">
<p>Used to send cards to entity : all users members of the listed entities who have the right for the process/state of the card will receive it. If this field is used in conjunction with groups recipients, to receive the cards :</p>
</div>
<div class="ulist">
<ul>
<li>
<p>users must be members of one of the entities AND one of the groups to receive the cards.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>OR</p>
</div>
<div class="ulist">
<ul>
<li>
<p>users must be members of one of the entities AND have the right for the process/state of the card.</p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="_last_time_to_decide_lttd"><a class="anchor" href="#_last_time_to_decide_lttd"></a>Last Time to Decide (<code>lttd</code>)</h6>
<div class="paragraph">
<p>Fixes the moment until when a <code>response</code> is possible for the card. After this moment, the response button won&#8217;t be useable. When lttd time is approaching, a clock is visible on the card in the feed with the residual time.  The lttd time can be set for cards that don&#8217;t expect any response</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_business_period"><a class="anchor" href="#_business_period"></a>2.1.1.5. Business period</h5>
<div class="paragraph">
<p>We define the business period as starting form startDate to endDate.  The card will be visible on the UI if the business period overlap the user chosen period (i.e the period selected on  the timeline). If endDate is not set, the  card will be visible as soon as the startDate is before the end of the chosen period.</p>
</div>
</div>
<div class="sect4">
<h5 id="_store_information"><a class="anchor" href="#_store_information"></a>2.1.1.6. Store information</h5>
<div class="sect5">
<h6 id="_uid_uid"><a class="anchor" href="#_uid_uid"></a>uid (<code>uid</code>)</h6>
<div class="paragraph">
<p>Unique identifier of the card in the OperatorFabric system. This attribute can be sent with card, but by default it&#8217;s managed by OperatorFabric.</p>
</div>
</div>
<div class="sect5">
<h6 id="_id_id"><a class="anchor" href="#_id_id"></a>id (<code>id</code>)</h6>
<div class="paragraph">
<p>State id of the associated process, determined by <code>OperatorFabric</code> can be set arbitrarily by the <code>publisher</code>. The id is determined by 'OperatorFabric' as follow : process.processIntanceId</p>
</div>
</div>
<div class="sect5">
<h6 id="_publish_date_publishdate"><a class="anchor" href="#_publish_date_publishdate"></a>Publish Date (<code>publishDate</code>)</h6>
<div class="paragraph">
<p>Indicates when the card has been registered in <code>OperatorFabric</code> system. This is a technical information exclusively managed by <code>OperatorFabric</code>.</p>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_user_destined_information_of_the_card"><a class="anchor" href="#_user_destined_information_of_the_card"></a>2.1.2. User destined Information of the card</h4>
<div class="paragraph">
<p>There are two kind of User destined information in a card. Some are restricted to the card format, others are defined by the publisher as long as there are encoded in <code>json</code>Â format.</p>
</div>
<div class="sect4">
<h5 id="_in_card_format"><a class="anchor" href="#_in_card_format"></a>2.1.2.1. in Card Format</h5>
<div class="sect5">
<h6 id="_title_title"><a class="anchor" href="#_title_title"></a>Title (<code>title</code>)</h6>
<div class="paragraph">
<p>See
<a href="../../../../documentation/current/reference_doc/index.html#card_title">Title</a>
.</p>
</div>
</div>
<div class="sect5">
<h6 id="_summary_summary"><a class="anchor" href="#_summary_summary"></a>Summary (<code>summary</code>)</h6>
<div class="paragraph">
<p>See
<a href="../../../../documentation/current/reference_doc/index.html#card_summary">Summary</a>
.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_custom_part"><a class="anchor" href="#_custom_part"></a>2.1.2.2. Custom part</h5>
<div class="sect5">
<h6 id="_data_data"><a class="anchor" href="#_data_data"></a>Data (<code>data</code>)</h6>
<div class="paragraph">
<p>Determines where custom information is store. The content in this attribute, is purely <code>publisher</code> choice.
This content, as long as it&#8217;s in <code>json</code> format can be used to display details. For the way the details are
displayed, see below.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
You must not use dot in json field names. In this case, the card will be refused with following message :
"Error, unable to handle pushed Cards: Map key xxx.xxx contains dots but no replacement was configured!""
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_presentation_information_of_the_card"><a class="anchor" href="#_presentation_information_of_the_card"></a>2.1.3. Presentation Information of the card</h4>
<div class="sect4">
<h5 id="_details_details"><a class="anchor" href="#_details_details"></a>2.1.3.1. details (<code>details</code>)</h5>
<div class="paragraph">
<p>This attribute is a string of objects containing a <code>title</code> attribute which is <code>i18n</code> key and a <code>template</code> attribute
which refers to a template name contained in the publisher bundle. The bundle in which those resources will be looked
for is the one corresponding to the
<a href="../../../../documentation/current/reference_doc/index.html#card_process_version">version</a>
declared in the card for the current
<a href="../../../../documentation/current/reference_doc/index.html#card_process">process</a>
.
If no resource is found, either because there is no bundle for the given version or
there is no resource for the given key, then the corresponding key is displayed in the details section of the GUI.</p>
</div>
<div class="paragraph">
<p><strong>example:</strong></p>
</div>
<div class="paragraph">
<p>The <code>TEST</code> process only has a <code>0.1</code> version uploaded in the current <code>OperatorFabric</code> system. The <code>details</code> value is
<code>[{"title":{"key":"first.tab.title"},"template":"template0"}]</code>.</p>
</div>
<div class="paragraph">
<p>If the <code>processVersion</code> of the card is <code>2</code> then only the <code>title</code> key declared in the <code>details</code> array will be displayed
without any translation, i.e. the tab will contains <code>TEST.2.first.tab.title</code> and will be empty. If the <code>l10n</code> for
the title is not available, then the tab title will be still <code>TEST.2.first.tab.title</code> but the template will be computed
and the details section will display the template content.</p>
</div>
</div>
<div class="sect4">
<h5 id="_timespans_timespans"><a class="anchor" href="#_timespans_timespans"></a>2.1.3.2. TimeSpans (<code>timeSpans</code>)</h5>
<div class="paragraph">
<p>When the simple startDate and endDate are not enough to characterize your
process business times, you can add a list of TimeSpan to your card. TimeSpans
are rendered in the timeline component as cluster bubbles. This has no effect on the feed
content.</p>
</div>
<div class="paragraph">
<p><strong>example :</strong></p>
</div>
<div class="paragraph">
<p>to display the card two times in the timeline you can add two TimeSpan to your
card:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>{
	"publisher":"TSO1",
	"publisherVersion":"0.1",
	"process":"process",
	"processInstanceId":"process-000",
	"startDate":1546297200000,
	"severity":"INFORMATION",
	...
	"timeSpans" : [
        {"start" : 1546297200000},
        {"start" : 1546297500000}
    ]

}</pre>
</div>
</div>
<div class="paragraph">
<p>In this sample, the card will be displayed twice in the time line. The card
start date will be ignored.</p>
</div>
<div class="paragraph">
<p>For timeSpans, you can specify an end date but it is not implemented in OperatorFabric (it was intended for future uses but it will be deprecated).</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_cards_examples"><a class="anchor" href="#_cards_examples"></a>2.2. Cards Examples</h3>
<div class="paragraph">
<p>Before detailing the content of cards, let&#8217;s show you what cards look like through few examples of json.</p>
</div>
<div class="sect3">
<h4 id="minimal_card"><a class="anchor" href="#minimal_card"></a>2.2.1. Minimal Card</h4>
<div class="paragraph">
<p>The OperatorFabric Card specification defines mandatory attributes, but some optional attributes are needed for cards to be useful in OperatorFabric. Let&#8217;s clarify those point through few examples of minimal cards and what happens when they&#8217;re used as if.</p>
</div>
<div class="sect4">
<h5 id="_send_to_one_user"><a class="anchor" href="#_send_to_one_user"></a>2.2.1.1. Send to One User</h5>
<div class="paragraph">
<p>The following card contains only the mandatory attributes.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>{
	"publisher":"TSO1",
	"processVersion":"0.1",
	"process":"process",
	"processInstanceId":"process-000",
	"state":"myState",
	"startDate":1546297200000,
	"severity":"INFORMATION",
	"title":{"key":"card.title.key"},
	"summary":{"key":"card.summary.key"},
	"userRecipients": ["tso1-operator"]

}</pre>
</div>
</div>
<div class="paragraph">
<p>This an information about the process instance <code>process-000</code> of process <code>process</code>, sent by <code>TSO1</code>. The title and the summary refer to <code>i18n</code> keys
defined in the associated <code>i18n</code> files of the process. This card is displayable since the first january 2019 and
should only be received by the user using the <code>tso1-operator</code> login.</p>
</div>
</div>
<div class="sect4">
<h5 id="_send_to_several_users"><a class="anchor" href="#_send_to_several_users"></a>2.2.1.2. Send to several users</h5>
<div class="sect5">
<h6 id="_simple_case_sending_to_a_group"><a class="anchor" href="#_simple_case_sending_to_a_group"></a>Simple case (sending to a group)</h6>
<div class="paragraph">
<p>The following example is nearly the same as the previous one except for the recipient.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>{
	"publisher":"TSO1",
	"processVersion":"0.1",
	"process":"process",
	"processInstanceId":"process-000",
	"state":"myState",
	"startDate":1546297200000,
	"severity":"INFORMATION",
	"title":{"key":"card.title.key"},
	"summary":{"key":"card.summary.key"},
	"groupRecipients": ["TSO1"]
}</pre>
</div>
</div>
<div class="paragraph">
<p>Here, the recipient is a group, the <code>TSO1</code>. So all users who are members of this group will receive the card.</p>
</div>
</div>
<div class="sect5">
<h6 id="_simple_case_sending_to_a_group_and_an_entity"><a class="anchor" href="#_simple_case_sending_to_a_group_and_an_entity"></a>Simple case (sending to a group and an entity)</h6>
<div class="paragraph">
<p>The following example is nearly the same as the previous one except for the recipient.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>{
	"publisher":"TSO1",
	"processVersion":"0.1",
	"process":"process",
	"processInstanceId":"process-000",
	"state":"myState",
	"startDate":1546297200000,
	"severity":"INFORMATION",
	"title":{"key":"card.title.key"},
	"summary":{"key":"card.summary.key"},
	"groupRecipients": ["TSO1"],
	"entityRecipients" : ["ENTITY1"]
}</pre>
</div>
</div>
<div class="paragraph">
<p>Here, the recipients are a group and an entity, the <code>TSO1</code> group and <code>ENTITY1</code> entity. So all users who are both members
of this group and this entity will receive the card.</p>
</div>
</div>
<div class="sect5">
<h6 id="_simple_case_sending_to_an_entity"><a class="anchor" href="#_simple_case_sending_to_an_entity"></a>Simple case (sending to an entity)</h6>
<div class="paragraph">
<p>The following example is nearly the same as the previous one except for the recipient.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>{
	"publisher":"TSO1",
	"processVersion":"0.1",
	"process":"process",
	"processInstanceId":"process-000",
	"state":"myState",
	"startDate":1546297200000,
	"severity":"INFORMATION",
	"title":{"key":"card.title.key"},
	"summary":{"key":"card.summary.key"},
	"entityRecipients" : ["ENTITY1"]
}</pre>
</div>
</div>
<div class="paragraph">
<p>Here, the recipient is an entity and there is no more groups. So all users who has the right perimeter and who are members of this entity will receive the card. More information on perimeter can be found in
<a href="../../../../documentation/current/reference_doc/index.html#users_management">user documentation</a></p>
</div>
</div>
<div class="sect5">
<h6 id="_complex_case"><a class="anchor" href="#_complex_case"></a>Complex case</h6>
<div class="paragraph">
<p>If this card need to be viewed by a user who is not in the <code>TSO1</code> group, it&#8217;s possible to tune more precisely the
definition of the recipient. If the <code>tso2-operator</code> needs to see also this card, the recipient definition could be(the following code details only the recipient part):</p>
</div>
<div class="literalblock">
<div class="content">
<pre>"groupRecipients": ["TSO1"],
"userRecipients": ["tso2-operator"]</pre>
</div>
</div>
<div class="paragraph">
<p>So here, all the users of the <code>TSO1</code> group will receive the <code>INFORMATION</code> as should the <code>tos2-operator</code> user.</p>
</div>
<div class="paragraph">
<p>Another example, if a card is destined to the operators of <code>TSO1</code> and <code>TSO2</code> and needs to be also seen by the <code>admin</code>, the recipient configuration looks like:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>"groupRecipients": ["TSO1", "TSO2"],
"userRecipients": ["admin"]</pre>
</div>
</div>
<div class="paragraph">
<p>There is and alternative way to declare recipients of card, this syntax is more complex and will be deprecated:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>"recipient":{
	"type":"UNION",
	"recipients":[
		{ "type": "GROUP", "identity":"TSO1"},
		{ "type": "USER", "identity":"tso2-operator"}
		]
	}</pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_regular_card"><a class="anchor" href="#_regular_card"></a>2.2.2. Regular Card</h4>
<div class="paragraph">
<p>The previous cards were nearly empty regarding information carrying. In fact, cards are intended to contain more information than a title and a summary. The optional attribute <code>data</code> is here for that. This attribute is destined to contain any <code>json</code> object. The creator of the card is free to put any information needed as long as it&#8217;s in a <code>json</code> format.</p>
</div>
<div class="sect4">
<h5 id="_full_of_hidden_data"><a class="anchor" href="#_full_of_hidden_data"></a>2.2.2.1. Full of Hidden data</h5>
<div class="paragraph">
<p>For this example we will use our previous example for the <code>TSO1</code> group with a <code>data</code> attribute containing the definition of a <code>json</code> object containing two attributes: <code>stringExample</code> and <code>numberExample</code>.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>{
	"publisher":"TSO1",
	"processVersion":"0.1",
	"process":"process",
	"processInstanceId":"process-000",
	"state":"myState",
	"startDate":1546297200000,
	"severity":"INFORMATION",
	"title":{"key":"card.title.key"},
	"summary":{"key":"card.summary.key"},
	"userRecipients": ["tso1-operator"],
	"data":{
		"stringExample":"This is a not so random string of characters.",
		"numberExample":123
		}

}</pre>
</div>
</div>
<div class="paragraph">
<p>This card contains some data but when selected in the feed nothing more than the previous example of card happen because
there is no rendering configuration.</p>
</div>
</div>
<div class="sect4">
<h5 id="_fully_useful"><a class="anchor" href="#_fully_useful"></a>2.2.2.2. Fully useful</h5>
<div class="paragraph">
<p>When a card is selected in the feed (of the GUI), the data is displayed in the detail panel.
The way details are formatted depends on the template contained in the bundle associated with the process as
<a href="../../../../documentation/current/reference_doc/index.html#template_description">described here</a>
. To have an effective example without to many actions to performed, the following example will use an already existing
configuration.The one presents in the development version of OperatorFabric, for test purpose(<code>TEST</code> bundle).</p>
</div>
<div class="paragraph">
<p>At the card level, the attributes in the card telling OperatorFabric which template to use is the <code>details</code> attributes.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>{
	"publisher":"TEST_PUBLISHER",
	"processVersion":"1",
	"process":"TEST",
	"processInstanceId":"process-000",
	"state":"myState",
	"startDate":1546297200000,
	"severity":"INFORMATION",
	"title":{"key":"process.title"},
	"summary":{"key":"process.summary"},
	"userRecipients": ["tso1-operator"]
	"data":{"rootProp":"Data displayed in the detail panel"},
	"details":[{"title":{"key":"process.detail.tab.first"}, "templateName":"template1"}]

}</pre>
</div>
</div>
<div class="paragraph">
<p>So here a single custom data is defined and it&#8217;s <code>rootProp</code>. This attribute is used by the template called by the
<code>details</code> attribute. This attribute contains an array of <code>json</code> object containing an <code>i18n</code> key and a <code>template</code>
reference. Each of those object is a tab in the detail panel of the GUI.</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_card_rendering"><a class="anchor" href="#_card_rendering"></a>3. Card rendering</h2>
<div class="sectionbody">
<div class="paragraph">
<p>As stated above, third applications interact with OperatorFabric by sending cards.</p>
</div>
<div class="paragraph">
<p>The Businessconfig service allows them to tell OperatorFabric for each process how these cards should be rendered including translation if
several languages are supported.  Configuration is done via files zipped in a "bundle", these files are send to OperatorFabric via a REST end point.</p>
</div>
<div class="paragraph">
<p>In addition, it lets third-party applications define additional menu entries for the navbar (for example linking back
to the third-party application) that can be integrated either as iframe or external links.</p>
</div>
<div class="sect2">
<h3 id="_declaring_a_process_and_its_configuration"><a class="anchor" href="#_declaring_a_process_and_its_configuration"></a>3.1. Declaring a Process and its configuration</h3>
<div class="paragraph">
<p>The business configuration for processes is declared in the form of a bundle, as described below.
Once this bundle fully created, it must be uploaded to the server through the Businessconfig service.</p>
</div>
<div class="paragraph">
<p>The way configuration is done is explained with examples before a more technical review of the configuration details.
The following instructions describe tests to perform on OperatorFabric to understand how customization is working in it.
The card data used here are sent automatically using a script as described
<a href="../../../../documentation/current/reference_doc/index.html#card_sending_script">here</a></p>
</div>
<div class="paragraph">
<p>A bundle contains all the configuration regarding a given business process, describing for example the various steps
of the process but also how the associated cards and card details should be displayed.
Those <code>tar.gz</code> archives contain a descriptor file
named <code>config.json</code>, eventually some <code>css files</code>, <code>i18n files</code> and <code>handlebars templates</code> to do so.</p>
</div>
<div class="paragraph">
<p>For didactic purposes, in this section, the businessconfig name is <code>BUNDLE_TEST</code> (to match the parameters used by the script).
This bundle is localized for <code>en</code> and <code>fr</code>.</p>
</div>
<div class="paragraph">
<p>As detailed in the <code>Businessconfig core service README</code> the bundle contains at least a metadata file called <code>config.json</code>,
a <code>css</code> folder, an <code>i18n</code> folder and a <code>template</code> folder.
All elements except the <code>config.json file</code> are optional.</p>
</div>
<div class="paragraph">
<p>The files of this example are organized as below:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>bundle
âââ config.json
âââ css
âÂ Â  âââ bundleTest.css
âââ i18n
âÂ Â  âââ en.json
âÂ Â  âââ fr.json
âââ template
    âââ en
    âÂ Â  âââ template1.handlebars
    âÂ Â  âââ template2.handlebars
    âââ fr
        âââ template1.handlebars
        âââ template2.handlebars</pre>
</div>
</div>
<div class="sect3">
<h4 id="_the_config_json_file"><a class="anchor" href="#_the_config_json_file"></a>3.1.1. The config.json file</h4>
<div class="paragraph">
<p>It&#8217;s a description file in <code>json</code> format. It lists the content of the bundle.</p>
</div>
<div class="paragraph">
<p><strong>example</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="JSON">{
  <span class="key"><span class="delimiter">&quot;</span><span class="content">id</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">TEST</span><span class="delimiter">&quot;</span></span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">version</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">1</span><span class="delimiter">&quot;</span></span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">uiVisibility</span><span class="delimiter">&quot;</span></span>: {
    <span class="key"><span class="delimiter">&quot;</span><span class="content">monitoring</span><span class="delimiter">&quot;</span></span>: <span class="value">true</span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">logging</span><span class="delimiter">&quot;</span></span>: <span class="value">true</span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">calendar</span><span class="delimiter">&quot;</span></span>: <span class="value">true</span>
  },
  <span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">process.label</span><span class="delimiter">&quot;</span></span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">defaultLocale</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">fr</span><span class="delimiter">&quot;</span></span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">menuLabel</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">menu.label</span><span class="delimiter">&quot;</span></span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">menuEntries</span><span class="delimiter">&quot;</span></span>: [
    {
      <span class="key"><span class="delimiter">&quot;</span><span class="content">id</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">uid test 0</span><span class="delimiter">&quot;</span></span>,
      <span class="key"><span class="delimiter">&quot;</span><span class="content">url</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">https://opfab.github.io/</span><span class="delimiter">&quot;</span></span>,
      <span class="key"><span class="delimiter">&quot;</span><span class="content">label</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">menu.first</span><span class="delimiter">&quot;</span></span>,
      <span class="key"><span class="delimiter">&quot;</span><span class="content">linkType</span><span class="delimiter">&quot;</span></span> : <span class="string"><span class="delimiter">&quot;</span><span class="content">BOTH</span><span class="delimiter">&quot;</span></span>
    },
    {
      <span class="key"><span class="delimiter">&quot;</span><span class="content">id</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">uid test 1</span><span class="delimiter">&quot;</span></span>,
      <span class="key"><span class="delimiter">&quot;</span><span class="content">url</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">https://www.lfenergy.org/</span><span class="delimiter">&quot;</span></span>,
      <span class="key"><span class="delimiter">&quot;</span><span class="content">label</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">menu.second</span><span class="delimiter">&quot;</span></span>,
      <span class="key"><span class="delimiter">&quot;</span><span class="content">linkType</span><span class="delimiter">&quot;</span></span> : <span class="string"><span class="delimiter">&quot;</span><span class="content">TAB</span><span class="delimiter">&quot;</span></span>
    }
  ],
  <span class="key"><span class="delimiter">&quot;</span><span class="content">states</span><span class="delimiter">&quot;</span></span>: {
    <span class="key"><span class="delimiter">&quot;</span><span class="content">firstState</span><span class="delimiter">&quot;</span></span>: {
      <span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>:  <span class="string"><span class="delimiter">&quot;</span><span class="content">state.label</span><span class="delimiter">&quot;</span></span>,
      <span class="key"><span class="delimiter">&quot;</span><span class="content">color</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">blue</span><span class="delimiter">&quot;</span></span>,
      <span class="key"><span class="delimiter">&quot;</span><span class="content">details</span><span class="delimiter">&quot;</span></span>: [
        {
          <span class="key"><span class="delimiter">&quot;</span><span class="content">title</span><span class="delimiter">&quot;</span></span>: {
            <span class="key"><span class="delimiter">&quot;</span><span class="content">key</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">template.title</span><span class="delimiter">&quot;</span></span>
          },
          <span class="key"><span class="delimiter">&quot;</span><span class="content">templateName</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">operation</span><span class="delimiter">&quot;</span></span>
        }
      ],
      <span class="key"><span class="delimiter">&quot;</span><span class="content">acknowledgementAllowed</span><span class="delimiter">&quot;</span></span>: <span class="value">false</span>
    }
  }
}</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>id: id of the process</p>
</li>
<li>
<p>name: process name (i18n key);</p>
</li>
<li>
<p>version: enable the correct display, even the old ones as all versions are stored by the server. Your <strong>card</strong> has a version
field that will be matched to businessconfig configuration for correct rendering ;</p>
</li>
<li>
<p>states  : list the available  states; actions and templates are associated to states, in the same way is the possibility of making the cards enabled for being acknowledged by user;</p>
</li>
<li>
<p>menuLabel in the main bar menu as <code>i18nLabelKey</code>: optional, used if the businessconfig service add one or several entry in
the OperatorFabric main menu bar, see the
<a href="../../../../documentation/current/reference_doc/index.html#menu_entries">menu entries</a>
section for details;</p>
</li>
<li>
<p>extra menu entries as <code>menuEntries</code>: optional, see below for the declaration format of objects of this array, see the
<a href="../../../../documentation/current/reference_doc/index.html#menu_entries">menu entries</a>
section for details;</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The mandatory declarations are <code>id</code>,'name' and <code>version</code> attributes.</p>
</div>
<div class="paragraph">
<p>See the
<a href="../../../../documentation/current/api/businessconfig/index.html">Businessconfig API documentation</a>
for details.</p>
</div>
</div>
<div class="sect3">
<h4 id="_i18n"><a class="anchor" href="#_i18n"></a>3.1.2. i18n</h4>
<div class="paragraph">
<p>There are two ways of i18n for businessconfig service. The first one is done using l10n files which are located in the <code>i18n</code>
folder, the second one throughout l10n name folder nested in the <code>template</code> folder.</p>
</div>
<div class="paragraph">
<p>The <code>i18n</code> folder contains one json file per l10n.</p>
</div>
<div class="paragraph">
<p>These localisation is used for integration of the businessconfig service into OperatorFabric, i.e. the label displayed for the
process , the state , the label displayed for each tab of the details of the card, the label of the actions&#8230;&#8203;</p>
</div>
<div class="sect4">
<h5 id="_template_folder"><a class="anchor" href="#_template_folder"></a>3.1.2.1. Template folder</h5>
<div class="paragraph">
<p>The <code>template</code> folder must contain localized folder for the i18n of the card details. This is why in our example, as the bundle is localized for <code>en</code> and <code>fr</code> language, the <code>template</code> folder contains a <code>en</code> and a <code>fr</code> folder.</p>
</div>
<div class="sect5">
<h6 id="_i18n_file"><a class="anchor" href="#_i18n_file"></a>i18n file</h6>
<div class="paragraph">
<p>If there is no i18n file or key is missing, the i18n key is displayed in OperatorFabric.</p>
</div>
<div class="paragraph">
<p>The choice of i18n keys is left to the Businessconfig service maintainer. The keys are referenced in the following places:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>config.json</code> file:</p>
<div class="ulist">
<ul>
<li>
<p><code>i18nLabelKey</code>: key used for the label for the businessconfig service displayed in the main menu bar of OperatorFabric;</p>
</li>
<li>
<p><code>label</code> of <code>menu entry declaration</code>: key used to l10n the <code>menu entries</code> declared by the Businessconfig party in the bundle;</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>card data</code>: values of <code>card title</code> and <code>card summary</code> refer to <code>i18n keys</code> as well as <code>key attribute</code> in the
<code>card detail</code> section of the card data.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>example</strong></p>
</div>
<div class="paragraph">
<p>So in this example the process is named <code>Bundle Test</code> with <code>BUNDLE_TEST</code> technical name. The bundle provide an
english and a french l10n.</p>
</div>
<div class="paragraph">
<p>The example bundle defined an new menu entry given access to 3 entries. The title and the summary have to be l10n,
so needs to be the 2 tabs titles.</p>
</div>
<div class="paragraph">
<p>The name of the process as displayed in the main menu bar of OperatorFabric. It will have the key
<code>"businessconfig-name-in-menu-bar"</code>. The english l10n will be <code>Bundle Test</code> and the french one will be <code>Bundle de test</code>.</p>
</div>
<div class="paragraph">
<p>A name for the three entries in the process entry menu. Their keys will be in order <code>"first-menu-entry"</code>, <code>"b-menu-entry"</code> and <code>"the-other-menu-entry"</code> for an english l10n as <code>Entry One</code>, <code>Entry Two</code> and <code>Entry Three</code> and in french as <code>EntrÃ©e une</code>, <code>EntrÃ©e deux</code> and <code>EntrÃ©e trois</code>.</p>
</div>
<div class="paragraph">
<p>The title for the card and its summary. As the card used here are generated by the script of the <code>cards-publication</code> project we have to used the key declared there. So they are respectively <code>process.title</code> and <code>process.summary</code> with the following l10ns for english: <code>Card Title</code> and <code>Card short description</code>, and for french l10ns: <code>Titre de la carte</code> and <code>Courte description de la carte</code>.</p>
</div>
<div class="paragraph">
<p>A title for each (two of them) tab of the detail cards. As for card title and card summary, those keys are already defined by the test script. There are <code>"process.detail.tab.first"</code> and <code>"process.detail.tab.second"</code>. For english l10n, the values are <code>First Detail List</code> and <code>Second Detail List</code> and for the french l10n, the values are <code>PremiÃ¨re liste de dÃ©tails</code> and <code>Seconde liste de dÃ©tails</code>.</p>
</div>
<div class="paragraph">
<p>Here is the content of <code>en.json</code></p>
</div>
<div class="literalblock">
<div class="content">
<pre>{
	"businessconfig-name-in-menu-bar":"Bundle Test",
		"first-menu-entry":"Entry One",
		"b-menu-entry":"Entry Two",
		"the-other-menu-entry":"Entry Three",
		"process":{
			"title":"Card Title",
			"summary":"Card short description",
			"detail":{
				"tab":{
					"first":"First Detail List",
					"second":"Second Detail List"
				}
			}
		}
}</pre>
</div>
</div>
<div class="paragraph">
<p>Here the content of <code>fr.json</code></p>
</div>
<div class="literalblock">
<div class="content">
<pre>{
	"businessconfig-name-in-menu-bar":"Bundle de test",
		"first-menu-entry":"EntrÃ©e une",
		"b-menu-entry":"EntrÃ©e deux",
		"the-other-menu-entry":"EntrÃ©e trois",
		"process":{
			"title":"Titre de la carte",
			"summary":"Courte description de la carte",
			"detail":{
				"tab":{
					"first":"PremiÃ¨re liste de dÃ©tails",
					"second":"DeuxiÃ¨me liste de dÃ©tails"
				}
			}
		}
}</pre>
</div>
</div>
<div class="paragraph">
<p>Once the bundle is correctly uploaded, the way to verify if the i18n have been correctly uploaded is to use the GETÂ 
method of businessconfig api for i18n file.</p>
</div>
<div class="paragraph">
<p>The endpoint is described
<a href="../../../../documentation/current/api/businessconfig/index.html#/businessconfig/getI18n">here</a>
.</p>
</div>
<div class="paragraph">
<p>The <code>locale</code> language, the <code>version</code> of the bundle and the <code>technical name</code> of the businessconfig party are needed to get
json in the response.</p>
</div>
<div class="paragraph">
<p>To verify if the french l10n data of the version 1 of the BUNDLE_TEST businessconfig party we could use the following
command line</p>
</div>
<div class="paragraph">
<p><code>curl -X GET "http://localhost:2100/businessconfig/BUNDLE_TEST/i18n?locale=fr&amp;version=1" -H  "accept: application/json"</code></p>
</div>
<div class="paragraph">
<p>The service response with a 200Â status and with the json corresponding to the defined fr.json file show below.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>{
"businessconfig-name-in-menu-bar":"Bundle de test",
"first-menu-entry":"EntrÃ©e une",
"b-menu-entry":"EntrÃ©e deux",
"the-other-menu-entry":"EntrÃ©e trois",
"tests":{
	"title":"Titre de la carte",
	"summary":"Courte description de la carte",
	"detail":{
		"tab":{
			"first":"PremiÃ¨re liste de dÃ©tails",
			"second":"DeuxiÃ¨me liste de dÃ©tails"
			}
		}
}
}</pre>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_processes_and_states"><a class="anchor" href="#_processes_and_states"></a>3.1.2.2. Processes and States</h5>
<div class="paragraph">
<p>Processes and their states allows to match a Businessconfig Party service process specific state to a list of templates for card details and
actions allowing specific card rendering for each state of the business process.</p>
</div>
<div class="paragraph">
<p>The purpose of this section is to display elements of businessconfig card data in a custom format.</p>
</div>
<div class="paragraph">
<p>Regarding the card detail customization, all the examples in this section will be based on the cards generated by the script existing in the <code>Cards-Publication</code> project. For the examples given here, this script is run with arguments detailed in the following command line:</p>
</div>
<div id="card_sending_script" class="literalblock">
<div class="content">
<pre>$OPERATOR_FABRIC_HOME/services/core/cards-publication/src/main/bin/push_card_loop.sh</pre>
</div>
</div>
<div class="paragraph">
<p>where:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>$OPERATOR_FABRIC_HOME</code> is the root folder of OperatorFabric where tests are performed;</p>
</li>
<li>
<p><code>BUNDLE_TEST</code> is the name of the Businessconfig party;</p>
</li>
<li>
<p><code>tests</code> is the name of the process referred by published cards.</p>
</li>
</ul>
</div>
<div class="sect5">
<h6 id="_configuration"><a class="anchor" href="#_configuration"></a>configuration</h6>
<div class="paragraph">
<p>The process entry in the configuration file is a dictionary of processes, each key maps to a process definition.
A process definition is itself a dictionary of states, each key maps to a state definition. A state is defined by:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>a list of details: details are a combination of an internationalized title (title), css class styling element
(titleStyle) and a template reference</p>
</li>
<li>
<p>a dictionary of actions: actions are described below</p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="_templates"><a class="anchor" href="#_templates"></a>Templates</h6>
<div class="paragraph">
<p>For demonstration purposes, there will be two simple templates. For more advance feature go to the section detailing the handlebars templates in general and helpers available in OperatorFabric.
As the card used in this example are created
<a href="../../../../documentation/current/reference_doc/index.html#card_sending_script">above</a>
, the bundle template folder needs to contain 2 templates: <code>template1.handlebars</code> and <code>template2.handlebars</code>.</p>
</div>
<div class="paragraph">
<p>examples of template (i18n versions)</p>
</div>
<div class="paragraph">
<p><code>/template/en/template1.handlers</code></p>
</div>
<div class="literalblock">
<div class="content">
<pre>&lt;h2&gt;Template Number One&lt;/h2&gt;
&lt;div class="bundle-test"&gt;'{{card.data.level1.level1Prop}}'&lt;/div&gt;</pre>
</div>
</div>
<div class="paragraph">
<p><code>/template/fr/template1.handlers</code></p>
</div>
<div class="literalblock">
<div class="content">
<pre>&lt;h2&gt;Patron numÃ©ro Un&lt;/h2&gt;
&lt;div class="bundle-test"&gt;'{{card.data.level1.level1Prop}}'&lt;/div&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>Those templates display a l10n title and an line containing the value of the scope property <code>card.level1.level1Prop</code> which is <code>This is a root property</code>.</p>
</div>
<div class="paragraph">
<p><code>/template/en/template2.handelbars</code></p>
</div>
<div class="literalblock">
<div class="content">
<pre>&lt;h2&gt;Second Template&lt;/h2&gt;
&lt;ul class="bundle-test-list"&gt;
	{{#each card.data.level1.level1Array}}
		&lt;li class="bunle-test-list-item"&gt;{{this.level1ArrayProp}}&lt;/li&gt;
	{{/each}}
&lt;/ul&gt;</pre>
</div>
</div>
<div class="paragraph">
<p><code>/template/fr/template2.handelbars</code></p>
</div>
<div class="literalblock">
<div class="content">
<pre>&lt;h2&gt;Second patron&lt;/h2&gt;
&lt;ul class="bundle-test-list"&gt;
	{{#each card.data.level1.level1Array}}
		&lt;li class="bunle-test-list-item"&gt;{{this.level1ArrayProp}}&lt;/li&gt;
	{{/each}}
&lt;/ul&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>Those templates display also a l10n title and a list of numeric values from 1 to 3.</p>
</div>
</div>
<div class="sect5">
<h6 id="_css"><a class="anchor" href="#_css"></a>CSS</h6>
<div class="paragraph">
<p>This folder contains regular css files.
The file name must be declared in the <code>config.json</code> file in order to be used in the templates and applied to them.</p>
</div>
<div class="sect6">
<h7 id="_examples"><a class="anchor" href="#_examples"></a>Examples</h7>
<div class="paragraph">
<p>As above, all parts of files irrelevant for our example are symbolised by a <code>â¦</code> character.</p>
</div>
<div class="paragraph">
<p><strong>Declaration of css files in <code>config.json</code> file</strong></p>
</div>
<div class="literalblock">
<div class="content">
<pre>{
	â¦
    "states" : {
            "state1" : {
                  â¦
	                "styles":["bundleTest"]
	â¦
}</pre>
</div>
</div>
<div class="paragraph">
<p><strong>CSS Class used in <code>./template/en/template1.handlebars</code></strong></p>
</div>
<div class="literalblock">
<div class="content">
<pre>	â¦
	&lt;div class="bundle-test"&gt;'{{card.data.level1.level1Prop}}'&lt;/div&gt;
	â¦</pre>
</div>
</div>
<div class="paragraph">
<p>As seen above, the value of <code>{{card.data.level1.level1Prop}}</code> of a test card is <code>This is a level1 property</code></p>
</div>
<div class="paragraph">
<p><strong>Style declaration in <code>./css/bundleTest.css</code></strong></p>
</div>
<div class="literalblock">
<div class="content">
<pre>.h2{
	color:#fd9312;
	font-weight: bold;
}</pre>
</div>
</div>
<div class="paragraph">
<p><strong>Expected result</strong></p>
</div>
<div class="imageblock">
<div class="content">
<img src="../images/expected-result.png" alt="Formatted root property">
</div>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_upload"><a class="anchor" href="#_upload"></a>3.1.2.3. Upload</h5>
<div class="paragraph">
<p>For this, the bundle is submitted to the OperatorFabric server using a POSTÂ http method as described in the
<a href="../../../../documentation/current/api/businessconfig/.html#/businessconfig/uploadBundle">Businessconfig Service API documentation</a>
.</p>
</div>
<div class="paragraph">
<p>Example :</p>
</div>
<div class="literalblock">
<div class="content">
<pre>cd $BUNDLE_FOLDER
curl -X POST "http://localhost:2100/businessconfig" -H  "accept: application/json" -H  "Content-Type: multipart/form-data" -F "file=@bundle-test.tar.gz;type=application/gzip"</pre>
</div>
</div>
<div class="paragraph">
<p>Where:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>$BUNDLE_FOLDER</code> is the folder containing the bundle archive to be uploaded.</p>
</li>
<li>
<p><code>bundle-test.tar.gz</code> is the name of the uploaded bundle.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These command line should return a <code>200Â http status</code> response with the details of the of the bundle in the response body such as :</p>
</div>
<div class="literalblock">
<div class="content">
<pre>{
  "menuEntriesData": [
    {
      "id": "uid test 0",
      "url": "https://opfab.github.io/whatisopfab/",
      "label": "first-menu-entry"
    },
    {
      "id": "uid test 0",
      "url": "https://www.lfenergy.org/",
      "label": "b-menu-entry"
    },
    {
      "id": "uid test 1",
      "url": "https://github.com/opfab/opfab.github.io",
      "label": "the-other-menu-entry"
    }
  ],
  "id":"BUNDLE_TEST"
  "name": "BUNDLE_TEST",
  "version": "1",
  "i18nLabelKey": "businessconfig-name-in-menu-bar",
  "menuEntries": [
    {
      "id": "uid test 0",
      "url": "https://opfab.github.io/whatisopfab/",
      "label": "first-menu-entry"
    },
    {
      "id": "uid test 0",
      "url": "https://www.lfenergy.org/",
      "label": "b-menu-entry"
    },
    {
      "id": "uid test 1",
      "url": "https://github.com/opfab/opfab.github.io",
      "label": "the-other-menu-entry"
    }
  ],
  "states" : {
          "start" : {
            "details" : [ {
              "title" : {
                "key" : "start.first.title"
              },
              "titleStyle" : "startTitle text-danger",
              "templateName" : "template1"
            } ]

          },
          "end" : {
            "details" : [ {
              "title" : {
                "key" : "end.first.title"
              },
              "titleStyle" : "startTitle text-info",
              "templateName" : "template2",
              "styles" : [ "bundleTest.css" ]
            } ]
          }
      }
}</pre>
</div>
</div>
<div class="paragraph">
<p>Otherwise please refer to the
<a href="../../../../documentation/current/getting_started/index.html#troubleshooting_bundle">Troubleshooting</a>
section to resolve the problem.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="template_description"><a class="anchor" href="#template_description"></a>3.2. Templates</h3>
<div class="paragraph">
<p>Templates are <a href="https://handlebarsjs.com/">Handlebars</a> template files. Templates
are fuelled with a scope structure composed of</p>
</div>
<div class="ulist">
<ul>
<li>
<p>a <strong>card</strong> property (See
<a href="../../../../documentation/current/api/cards/index.html">card data model</a>
for more information)</p>
</li>
<li>
<p>a <strong>userContext</strong> :</p>
<div class="ulist">
<ul>
<li>
<p><strong>login</strong>: user login</p>
</li>
<li>
<p><strong>token</strong>: user jwt token</p>
</li>
<li>
<p><strong>firstName</strong>: user first name</p>
</li>
<li>
<p><strong>lastName</strong>: user last name</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>In addition to Handlebars basic syntax and helpers, OperatorFabric defines the
following helpers :</p>
</div>
<div class="sect3">
<h4 id="_operatorfabric_specific_handlebars_helpers"><a class="anchor" href="#_operatorfabric_specific_handlebars_helpers"></a>3.2.1. OperatorFabric specific handlebars helpers</h4>
<div class="sect4">
<h5 id="numberformat"><a class="anchor" href="#numberformat"></a>3.2.1.1. numberFormat</h5>
<div class="paragraph">
<p>formats a number parameter using
<a href="https://developer.mozilla.org/fr/docs/Web/JavaScript/Reference/Objets_globaux/Nu" class="bare">developer.mozilla.org/fr/docs/Web/JavaScript/Reference/Objets_globaux/Nu</a>
mberFormat[Intl.NumberFormat].
The locale used is the current user selected one, and options are passed as hash
parameters (<a href="https://handlebarsjs.com/">see Handlebars doc Literals section</a>).</p>
</div>
<div class="literalblock">
<div class="content">
<pre>{{numberFormat card.data.price style="currency" currency="EUR"}}</pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="dateformat"><a class="anchor" href="#dateformat"></a>3.2.1.2. dateFormat</h5>
<div class="paragraph">
<p>formats the submitted parameters (millisecond since epoch) using
<a href="https://momentjs.com/">mement.format</a>. The locale used is the current user
selected one, the format is "format" hash parameter
(<a href="https://handlebarsjs.com/">see Handlebars doc Literals section</a>).</p>
</div>
<div class="literalblock">
<div class="content">
<pre>{{dateFormat card.data.birthday format="MMMM Do YYYY, h:mm:ss a"}}</pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="slice"><a class="anchor" href="#slice"></a>3.2.1.3. slice</h5>
<div class="paragraph">
<p>extracts a sub array from ann array</p>
</div>
<div class="paragraph">
<p>example:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>&lt;!--
{"array": ["foo","bar","baz"]}
--&gt;
&lt;ul&gt;
{{#each (slice array 0 2)}}
  &lt;li&gt;{{this}}&lt;/li&gt;
{{/each}}
&lt;/ul&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>outputs:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>&lt;ul&gt;
  &lt;li&gt;foo&lt;/li&gt;
  &lt;li&gt;bar&lt;/li&gt;
&lt;/ul&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>and</p>
</div>
<div class="literalblock">
<div class="content">
<pre>&lt;!--
{"array": ["foo","bar","baz"]}
--&gt;
&lt;ul&gt;
{{#each (slice array 1)}}
  &lt;li&gt;{{this}}&lt;/li&gt;
{{/each}}
&lt;/ul&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>outputs:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>&lt;ul&gt;
  &lt;li&gt;bar&lt;/li&gt;
  &lt;li&gt;baz&lt;/li&gt;
&lt;/ul&gt;</pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="now"><a class="anchor" href="#now"></a>3.2.1.4. now</h5>
<div class="paragraph">
<p>outputs the current date in millisecond from epoch. The date is computed from
application internal time service and thus may be different from the date that
one can compute from javascript api which relies on the browsers' system time.</p>
</div>
<div class="paragraph">
<p>NB: Due to Handlebars limitation you must provide at least one argument to
helpers otherwise, Handlebars will confuse a helper and a variable. In the
bellow example, we simply pass an empty string.</p>
</div>
<div class="paragraph">
<p>example:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>&lt;div&gt;{{now ""}}&lt;/div&gt;
&lt;br&gt;
&lt;div&gt;{{dateFormat (now "") format="MMMM Do YYYY, h:mm:ss a"}}&lt;/div&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>outputs</p>
</div>
<div class="literalblock">
<div class="content">
<pre>&lt;div&gt;1551454795179&lt;/div&gt;
&lt;br&gt;
&lt;div&gt;mars 1er 2019, 4:39:55 pm&lt;/div&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>for a local set to <code>FR_fr</code></p>
</div>
</div>
<div class="sect4">
<h5 id="preservespace"><a class="anchor" href="#preservespace"></a>3.2.1.5. preserveSpace</h5>
<div class="paragraph">
<p>preserves space in parameter string to avoid html standard space trimming.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>{{preserveSpace card.data.businessId}}</pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="bool"><a class="anchor" href="#bool"></a>3.2.1.6. bool</h5>
<div class="paragraph">
<p>returns a boolean result value on an arithmetical operation (including object
equality) or boolean operation.</p>
</div>
<div class="paragraph">
<p>Arguments: - v1: left value operand - op: operator (string value) - v2: right
value operand</p>
</div>
<div class="paragraph">
<p>arithmetical operators:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>==</p>
</li>
<li>
<p>===</p>
</li>
<li>
<p>!=</p>
</li>
<li>
<p>!==</p>
</li>
<li>
<p>&lt;</p>
</li>
<li>
<p>&#8656;</p>
</li>
<li>
<p>&gt;</p>
</li>
<li>
<p>&gt;=</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>boolean operators:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>&amp;&amp;</p>
</li>
<li>
<p>||</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>examples:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>{{#if (bool v1 '&lt;' v2)}}
  v1 is strictly lower than v2
{{else}}
 V2 is lower or equal to v1
{{/if}}</pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="math"><a class="anchor" href="#math"></a>3.2.1.7. math</h5>
<div class="paragraph">
<p>returns the result of a mathematical operation.</p>
</div>
<div class="paragraph">
<p>arguments:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>v1: left value operand</p>
</li>
<li>
<p>op: operator (string value)</p>
</li>
<li>
<p>v2: right value operand</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>arithmetical operators:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>+</p>
</li>
<li>
<p>-</p>
</li>
<li>
<p>*</p>
</li>
<li>
<p>/</p>
</li>
<li>
<p>%</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>example:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>{{math 1 '+' 2}}</pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="split"><a class="anchor" href="#split"></a>3.2.1.8. split</h5>
<div class="paragraph">
<p>splits a string into an array based on a split string.</p>
</div>
<div class="paragraph">
<p>example:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>&lt;ul&gt;
{{#each (split 'my.example.string' '.')}}
  &lt;li&gt;{{this}}&lt;/li&gt;
{{/each}}
&lt;/ul&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>outputs</p>
</div>
<div class="literalblock">
<div class="content">
<pre>&lt;ul&gt;
  &lt;li&gt;my&lt;/li&gt;
  &lt;li&gt;example&lt;/li&gt;
  &lt;li&gt;string&lt;/li&gt;
&lt;/ul&gt;</pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="svg"><a class="anchor" href="#svg"></a>3.2.1.9. svg</h5>
<div class="paragraph">
<p>outputs a svg tag with lazy loading, and missing image replacement message. The
image url is the concatenation of an arbitrary number of helper arguments</p>
</div>
<div class="literalblock">
<div class="content">
<pre>{{{svg baseUri scheduledOpId "/" substation "/before/"
computationPhaseOrdinal}}}</pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="i18n"><a class="anchor" href="#i18n"></a>3.2.1.10. i18n</h5>
<div class="paragraph">
<p>outputs a i18n result from a key and some parameters. There are two ways of
configurationÂ :</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Pass an object as sole argument. The object must contain a key field (string)
and an optional parameter field (map of parameterKey &#8658; value)</p>
<div class="literalblock">
<div class="content">
<pre>{{i18n card.data.i18nTitle}}</pre>
</div>
</div>
</li>
<li>
<p>Pass a string key as sole argument and use hash parameters
(<a href="https://handlebarsjs.com/">see Handlebars doc Literals section</a>) for i18n string
parameters.</p>
</li>
</ul>
</div>
<div class="literalblock">
<div class="content">
<pre>&lt;!--
emergency.title=Emergency situation happened on {{date}}. Cause : {{cause}}.
--&gt;
{{i18n "emergency.title" date="2018-06-14" cause="Broken Coffee Machine"}}</pre>
</div>
</div>
<div class="paragraph">
<p>outputs</p>
</div>
<div class="literalblock">
<div class="content">
<pre>Emergency situation happened on 2018-06-14. Cause : Broken Cofee Machine</pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="sort"><a class="anchor" href="#sort"></a>3.2.1.11. sort</h5>
<div class="paragraph">
<p>sorts an array or some object&#8217;s properties (first argument) using an optional
field name (second argument) to sort the collection on this fields natural
order.</p>
</div>
<div class="paragraph">
<p>If there is no field argument provided :</p>
</div>
<div class="ulist">
<ul>
<li>
<p>for an array, the original order of the array is kept ;</p>
</li>
<li>
<p>for an object, the structure is sorted by the object field name.</p>
</li>
</ul>
</div>
<div class="literalblock">
<div class="content">
<pre>&lt;!--
users :

{"john": { "firstName": "John", "lastName": "Cleese"},
"graham": { "firstName": "Graham", "lastName": "Chapman"},
"terry": { "firstName": "Terry", "lastName": "Gilliam"},
"eric": { "firstName": "Eric", "lastName": "Idle"},
"terry": { "firstName": "Terry", "lastName": "Jones"},
"michael": { "firstName": "Michael", "lastName": "Palin"},
--&gt;

&lt;ul&gt;
{{#each (sort users)}}
    &lt;li&gt;{{this.firstName}} {{this.lastName}}&lt;/li&gt;
{{/each}}
&lt;/ul&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>outputs :</p>
</div>
<div class="literalblock">
<div class="content">
<pre>&lt;ul&gt;
  &lt;li&gt;Eric Idle&lt;/li&gt;
  &lt;li&gt;Graham Chapman&lt;/li&gt;
  &lt;li&gt;John Cleese&lt;/li&gt;
  &lt;li&gt;Michael Pallin&lt;/li&gt;
  &lt;li&gt;Terry Gilliam&lt;/li&gt;
  &lt;li&gt;Terry Jones&lt;/li&gt;
&lt;/ul&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>and</p>
</div>
<div class="literalblock">
<div class="content">
<pre>&lt;ul&gt;
{{#each (sort users "lastName")}}
    &lt;li&gt;{{this.firstName}} {{this.lastName&lt;/li&gt;
{{/each}}
&lt;/ul&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>outputs :</p>
</div>
<div class="literalblock">
<div class="content">
<pre>&lt;ul&gt;
  &lt;li&gt;Graham Chapman&lt;/li&gt;
  &lt;li&gt;John Cleese&lt;/li&gt;
  &lt;li&gt;Terry Gilliam&lt;/li&gt;
  &lt;li&gt;Eric Idle&lt;/li&gt;
  &lt;li&gt;Terry Jones&lt;/li&gt;
  &lt;li&gt;Michael Pallin&lt;/li&gt;
&lt;/ul&gt;</pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="arrayContains"><a class="anchor" href="#arrayContains"></a>3.2.1.12. arrayContains</h5>
<div class="paragraph">
<p>Verify if an array contains a specified element. If the array does contain the element, it returns true. Otherwise, it returns false.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>&lt;p {{#if (arrayContains colors 'red')}}class="text-danger"{{/if}}&gt;test&lt;/p&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>If the colors array contains 'red', the output is:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>&lt;p class="text-danger"&gt;test&lt;/p&gt;</pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="times"><a class="anchor" href="#times"></a>3.2.1.13. times</h5>
<div class="paragraph">
<p>Allows to perform the same action a certain number of times. Internally, this uses a for loop.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>{{#times 3}}
  &lt;p&gt;test&lt;/p&gt;
{{/times}}</pre>
</div>
</div>
<div class="paragraph">
<p>outputs :</p>
</div>
<div class="literalblock">
<div class="content">
<pre>&lt;p&gt;test&lt;/p&gt;
&lt;p&gt;test&lt;/p&gt;
&lt;p&gt;test&lt;/p&gt;</pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="toBreakage"><a class="anchor" href="#toBreakage"></a>3.2.1.14. toBreakage</h5>
<div class="paragraph">
<p>Change the breakage of a string. The arguments that you can specify are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>lowercase &#8658; The string will be lowercased</p>
</li>
<li>
<p>uppercase &#8658; The string will be uppercased</p>
</li>
</ul>
</div>
<div class="literalblock">
<div class="content">
<pre>{{toBreakage key 'lowercase'}}s</pre>
</div>
</div>
<div class="paragraph">
<p>If the value of the key variable is "TEST", the output will be:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>tests</pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="keyValue"><a class="anchor" href="#keyValue"></a>3.2.1.15. keyValue</h5>
<div class="paragraph">
<p>This allows to traverse a map.</p>
</div>
<div class="paragraph">
<p>Notice that this should normally be feasible by using the built-in each helper, but a client was having some troubles using it so we added this custom helper.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>{{#keyValue studentGrades}}
  &lt;p&gt;{{key}}: {{value}}&lt;/p&gt;
{{/keyValue}}</pre>
</div>
</div>
<div class="paragraph">
<p>If the value of the studentGrades map is:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>{
  'student1': 15,
  'student2': 12,
  'student3': 9
}</pre>
</div>
</div>
<div class="paragraph">
<p>The output will be:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>&lt;p&gt;student1: 15&lt;/p&gt;
&lt;p&gt;student2: 12&lt;/p&gt;
&lt;p&gt;student3: 9&lt;/p&gt;</pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_keepspacesandendofline"><a class="anchor" href="#_keepspacesandendofline"></a>3.2.1.16. keepSpacesAndEndOfLine</h5>
<div class="paragraph">
<p>Convert a string to a light HTML by replacing :</p>
</div>
<div class="ulist">
<ul>
<li>
<p>each new line character with &lt;br/&gt;</p>
</li>
<li>
<p>spaces with &amp;nbsp; when there is at least two consecutive spaces.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_charts"><a class="anchor" href="#_charts"></a>3.2.2. Charts</h4>
<div class="paragraph">
<p>The library <a href="https://www.chartjs.org/">charts.js</a> is integrate in operator fabric, it means it&#8217;s possible to show charts in cards, you can find a bundle example in the operator fabric git (<a href="https://github.com/opfab/operatorfabric-core/tree/develop/src/test/utils/karate/businessconfig/resources/bundle_api_test">src/test/utils/karate/businessconfig/resources/bundle_test_api</a>).</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="response_cards"><a class="anchor" href="#response_cards"></a>4. Response cards</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Within your template, you can allow the user to perform some action (respond to a form, answer a question, &#8230;&#8203;). The user fills these information and then clicks on a submit button. When he submits this action, a new card is created and emitted to a third-party tool.</p>
</div>
<div class="paragraph">
<p>This card is called "a child card" as it is attached to the card where the question came from : "the parent card". This child card is also send to the users that have received the parent card. From the ui point of view, the information of the child cards can be integrated in real time in the parent card if configured.</p>
</div>
<div class="paragraph">
<p>The process can be represented as follow :</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="../images/ResponseCardSequence.jpg" alt="ResponseCardSequence">
</div>
</div>
<div class="paragraph">
<p>Notice that the response will be associated to the entity and not to the user, i.e the user responds on behalf of his entity. A user can respond more than one time to a card (a future evolution could add the possibility to limit to one response per entity).</p>
</div>
<div class="paragraph">
<p>You can view a screenshot of an example of card with responses :</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="../images/ResponseCardScreenshot2.png" alt="ResponseCardScreenshot2">
</div>
</div>
<div class="sect2">
<h3 id="_steps_needed_to_use_a_response_card"><a class="anchor" href="#_steps_needed_to_use_a_response_card"></a>4.1. Steps needed to use a response card</h3>
<div class="sect3">
<h4 id="_define_a_third_party_tool"><a class="anchor" href="#_define_a_third_party_tool"></a>4.1.1. Define a third party tool</h4>
<div class="paragraph">
<p>The response card is to be received by a third party application for business processing. The third-party application will receive the card as an HTTP POST request. The card is in json format (the same format as when we send a card). The field data in the json contains the user response.</p>
</div>
<div class="paragraph">
<p>The url of the third party receiving the response card is to be set in the .yml of the publication service. Here is an example with two third parties configured.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>externalRecipients-url: "{\
           third-party1: \"http://thirdparty1/test1\", \
           third-party2: \"http://thirdparty2:8090/test2\", \
           }"</pre>
</div>
</div>
<div class="paragraph">
<p>The name to use for the third-party is the publisherId of the parent card.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>For the url, do not use localhost if you run OperatorFabric in a docker, as the publication-service will not be able to join your third party.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_configure_the_response_in_config_json"><a class="anchor" href="#_configure_the_response_in_config_json"></a>4.1.2. Configure the response in config.json</h4>
<div class="paragraph">
<p>A card can have a response only if it&#8217;s in a process/state that is configured for. To do that you need to setup the good  configuration in the config.json of the concerned process. Here is an example of configuration :</p>
</div>
<div class="literalblock">
<div class="content">
<pre>{
  "id": "defaultProcess",
  "name": "Test",
  "version": "1",
  "states": {
    "questionState": {
      "name": "question.title",
      "color": "#8bcdcd",
      "response": {
        "state": "responseState",
        "externalRecipients":["externalRecipient1", "externalRecipient2"],
        "btnColor": "GREEN",
        "btnText": {
          "key": "question.button.text"
        }
      },
      "details": [
        {
          "title": {
            "key": "question.title"
          },
          "templateName": "question",
          "styles": [
            "style"
          ]
        }
      ],
      "acknowledgementAllowed": false
    }
  }
}</pre>
</div>
</div>
<div class="paragraph">
<p>We define here a state name "questionState" with a response field. Now, if we send a card with process "defaultProcess" and state "questionState" , the user will have the possibility to respond if he has the good privileges.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The field "state" in the response field is used to define the state to use for the response (the child card).</p>
</li>
<li>
<p>The field "externalRecipients" define the recipients of the response card. These recipients are keys referenced in the config file of cards-publication service, in "externalRecipients-url" element. This field is optional.</p>
</li>
<li>
<p>The field "btnColor" define the color of the submit button for the response, it is optional and there is 3 possibilities : RED , GREEN , YELLOW</p>
</li>
<li>
<p>The field "btnText"is the i18n key of the title of the submit button, it is optional.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_design_the_question_form_in_the_template"><a class="anchor" href="#_design_the_question_form_in_the_template"></a>4.1.3. Design the question form in the template</h4>
<div class="paragraph">
<p>For the user to response you need to define the response form in the template with standard HTML syntax</p>
</div>
<div class="paragraph">
<p>To enable operator fabric to send the response, you need to implement a javascript function in your template called templateGateway.validyForm which return an object containing three fields :</p>
</div>
<div class="ulist">
<ul>
<li>
<p>valid (<em>boolean</em>) : true if the user input is valid</p>
</li>
<li>
<p>errorMsg (<em>string</em>) : message in case of invalid user input. If valid is true this field is not necessary.</p>
</li>
<li>
<p>formData (<em>any</em>) : the user input to send in the data field of the child card. If valid is false this field is not necessary.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This method will be called by OperatorFabric when user click on the button to send the response</p>
</div>
<div class="paragraph">
<p>You can find an example in the file src/test/utils/karate/businessconfig/resources/bundle_defaultProcess/template/en/question.handlebars.</p>
</div>
</div>
<div class="sect3">
<h4 id="_define_permissions"><a class="anchor" href="#_define_permissions"></a>4.1.4. Define permissions</h4>
<div class="paragraph">
<p>To respond to a card a user must have the right privileges, it is done using "perimeters". The user must be in a group that is attached to a perimeter with  a right "Write" for the concerned process/state, the state being the response state defined in the config.json.</p>
</div>
<div class="paragraph">
<p>Here is an example of definition of a perimeter :</p>
</div>
<div class="literalblock">
<div class="content">
<pre>{
  "id" : "perimeterQuestion",
  "process" : "defaultProcess",
  "stateRights" : [
    {
      "state" : "responseState",
      "right" : "Write"
    }
  ]
}</pre>
</div>
</div>
<div class="paragraph">
<p>To configure it in OperatorFabric , you need to make a POST of this json file to the end point /users/perimeters.</p>
</div>
<div class="paragraph">
<p>To add it to a group name for example "mygroup", you need to make a PATCH request  to end point 'users/groups/mygroup/perimeters' with payload ["perimeterQuestion"]</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If you don&#8217;t want OperatorFabric to check for user perimeter when responding to a card, you can add the variable "checkPerimeterForResponseCard" and set it to false, in the config file of cards-publication and in web-ui.json.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_send_a_question_card"><a class="anchor" href="#_send_a_question_card"></a>4.2. Send a question card</h3>
<div class="paragraph">
<p>The question card is like a usual card except that you have the field "entitiesAllowedToRespond" to set with the entities allowed to respond to the card. If the user is not in the entity, he will not be able to respond.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>...
"process"  :"defaultProcess",
"processInstanceId" : "process4",
"state": "questionState",
"entitiesAllowedToRespond": ["ENTITY1","ENTITY2"],
"severity" : "ACTION",
...</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_integrate_child_cards"><a class="anchor" href="#_integrate_child_cards"></a>4.3. Integrate child cards</h3>
<div class="paragraph">
<p>For each user response, a child card containing the response is emitted and stored in OperatorFabric like a normal card. It is not directly visible on the ui but this child card can be integrated in real time to the parent card of all the users watching the card. To do that, you need  some code in the template to process child data:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>You can access child cards via the javascript method templateGateway.childCards() which returns an array of the child cards. The structure of a child card is the same as the structure of a classic card.</p>
</li>
<li>
<p>As child cards are arriving in real time, you need to define a method call templateGateway.applyChildCards() which will be called by OperatorFabric each time the list of child cards is evolving.</p>
</li>
<li>
<p>To integrate the child cards when loading the card you need to call to <em>templateGateway.applyChildCards()</em>. (OperatorFabric is not calling the method on card loading)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can find an example in the file src/test/utils/karate/businessconfig/resources/bundle_defaultProcess/template/en/question.handlebars.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_archived_cards"><a class="anchor" href="#_archived_cards"></a>5. Archived Cards</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_key_concepts"><a class="anchor" href="#_key_concepts"></a>5.1. Key concepts</h3>
<div class="paragraph">
<p>Every time a card is published, in addition to being delivered to the users
and persisted as a "current" card in MongoDB, it is also immediately
persisted in the archived cards.</p>
</div>
<div class="paragraph">
<p>Archived cards are similar in structure to current cards, but they are managed differently.
Current cards are uniquely identified by their id (made up of the publisher and the process id).
That is because if a new card is published with id as an existing card, it will replace it in the
card collection. This way, the current card reflects the current state of a process instance.
In the archived cards collection however, both cards will be kept, so that the archived cards
show all the states that a given process instance went through.</p>
</div>
</div>
<div class="sect2">
<h3 id="_archives_screen_in_the_ui"><a class="anchor" href="#_archives_screen_in_the_ui"></a>5.2. Archives screen in the UI</h3>
<div class="paragraph">
<p>The Archives screen in the UI allows the users to query these archives with different filters.
The layout of this screen is very similar to the Feed screen: the results are displayed in a
(paginated) card list, and the user can display the associated card details by clicking a card in the list.</p>
</div>
<div class="paragraph">
<p>The results of these queries are limited to cards that the user is allowed to see, either :</p>
</div>
<div class="ulist">
<ul>
<li>
<p>because this user is direct recipient of the card,</p>
</li>
<li>
<p>because he belongs to a group (or entity) that is a recipient,</p>
</li>
<li>
<p>or because he belongs to a group that has the right to receive the card (via definition of perimeters)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If a card is sent to an entity and a group, then this user must be part of both the group and the entity.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="users_management"><a class="anchor" href="#users_management"></a>6. User management</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The User service manages users, groups, entities and perimeters (linked to groups).</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Users</dt>
<dd>
<p>represent account information for a person destined to receive cards in the OperatorFabric instance.</p>
</dd>
<dt class="hdlist1">Groups</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>represent set of users destined to receive collectively some cards.</p>
</li>
<li>
<p>has a set of perimeters to define rights for card reception in OperatorFabric.</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">Entities</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>represent set of users destined to receive collectively some cards.</p>
</li>
<li>
<p>can be used in a way to handle rights on card reception in OperatorFabric.</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
The user define here is an internal representation of the individual card recipient in <code>OperatorFabric</code> the authentication is leave to specific OAuth2 external service.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
In the following commands the <code>$token</code> is an authentication token currently valid for the <code>OAuth2</code> service used by the current <code>OperatorFabric</code> system.
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="_users_groups_entities_and_perimeters"><a class="anchor" href="#_users_groups_entities_and_perimeters"></a>6.1. Users, groups, entities and perimeters</h3>
<div class="paragraph">
<p>User service manages users, groups, entities and perimeters.</p>
</div>
<div class="sect3">
<h4 id="_users"><a class="anchor" href="#_users"></a>6.1.1. Users</h4>
<div class="paragraph">
<p>Users are the individuals and mainly physical person who can log in OperatorFabric.</p>
</div>
<div class="paragraph">
<p>The access to this service has to be authorized, in the <code>OAuth2</code> service used by the current <code>OperatorFabric</code> instance, at least to access User information and to manage Users. The membership of groups and entities are stored in the user information.</p>
</div>
<div class="sect4">
<h5 id="_automated_user_creation"><a class="anchor" href="#_automated_user_creation"></a>6.1.1.1. Automated user creation</h5>
<div class="paragraph">
<p>In case of a user does exist in a provided authentication service but he does not exist in the <code>OperatorFabric</code>
instance, when he is authenticated and connected for the first time in the <code>OperatorFabric</code> instance, the user is
automatically created in the system without attached group or entity.
The administration of the groups, entities and perimeters is dealt by the administrator manually.
More details about automated user creation
<a href="../../../../documentation/current/deployment/index.html#opfab_spec_conf">here</a>
.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_groups"><a class="anchor" href="#_groups"></a>6.1.2. Groups</h4>
<div class="paragraph">
<p>The notion of group is loose and can be used to simulate role in <code>OperatorFabric</code>.
Groups are used to send cards to several users without a name specifically. The information about membership to a
group is stored in the user information. A group contains a list of perimeters which define the rights of reception/writing for a couple process/state. The rules used to send cards are described in the
<a href="../../../../documentation/current/reference_doc/index.html#card_recipients">recipients section</a>
.</p>
</div>
</div>
<div class="sect3">
<h4 id="_entities"><a class="anchor" href="#_entities"></a>6.1.3. Entities</h4>
<div class="paragraph">
<p>Entities are used to send cards to several users without a name specifically. The information about membership to an
entity is stored in the user information. Examples using entities can be found
<a href="../../../../documentation/current/reference_doc/index.html#_send_to_several_users">here</a>
.</p>
</div>
</div>
<div class="sect3">
<h4 id="_perimeters"><a class="anchor" href="#_perimeters"></a>6.1.4. Perimeters</h4>
<div class="paragraph">
<p>Perimeters are used to define rights for reading/writing cards. A perimeter is composed of an identifier (unique), a process name and a list of state/rights couple.
Possible rights for receiving/writing cards are :</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Receive : the rights for receiving a card</p>
</li>
<li>
<p>Write : the rights for writing a card, that is to say respond to a card or create a new card</p>
</li>
<li>
<p>ReceiveAndWrite : the rights for receiving and writing a card</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_alternative_way_to_manage_groups_and_entities"><a class="anchor" href="#_alternative_way_to_manage_groups_and_entities"></a>6.1.5. Alternative way to manage groups and entities</h4>
<div class="paragraph">
<p>The standard way to handle groups and entities in <code>OperatorFabric</code> instance is dealt on the user information.
There is an alternative way to manage groups and entities through the authentication token, the groups and entities are defined by the administrator of the authentication service.
See
<a href="../../../../documentation/current/deployment/index.html#jwt_mode">here</a>
for more details to use this feature.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_ui_customization"><a class="anchor" href="#_ui_customization"></a>7. UI Customization</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_ui_configuration"><a class="anchor" href="#_ui_configuration"></a>7.1. UI configuration</h3>
<div class="paragraph">
<p>The web-ui.json file permit to configure parameters for customization , the list of parameters is
<a href="../deployment/index.html#ui_properties">described here</a></p>
</div>
</div>
<div class="sect2">
<h3 id="menu_entries"><a class="anchor" href="#menu_entries"></a>7.2. Menu Entries</h3>
<div class="paragraph">
<p>It is possible to declare specific business menu in the upper part of  OperatorFabric. Those elements are declared  in the <code>config.json</code> file of the bundles.</p>
</div>
<div class="paragraph">
<p>If there are several items to declare for a businessconfig service, a title for the businessconfig menu section need to be declared
within the <code>i18nLabelKey</code> attribute, otherwise the first and only <code>menu entry</code> item is used to create an entry in the
menu nav bar of OperatorFabric.</p>
</div>
<div class="sect3">
<h4 id="_config_json_declaration"><a class="anchor" href="#_config_json_declaration"></a>7.2.1. config.json declaration</h4>
<div class="paragraph">
<p>This kind of objects contains the following attributesÂ :</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>id</code>: identifier of the entry menu in the UI;</p>
</li>
<li>
<p><code>url</code>: url opening a new page in a tab in the browser;</p>
</li>
<li>
<p><code>label</code>: it&#8217;s an i18n key used to l10n the entry in the UI.</p>
</li>
<li>
<p><code>linkType</code>: Defines how business menu links are displayed in the navigation bar and how
they open. Possible values:</p>
<div class="ulist">
<ul>
<li>
<p>TAB: Only a text link is displayed, and clicking it opens the link in a new tab.</p>
</li>
<li>
<p>IFRAME: Only a text link is displayed, and clicking it opens the link in an iframe in the main content zone below
the navigation bar.</p>
</li>
<li>
<p>BOTH: Both a text link and a little arrow icon are displayed. Clicking the text link opens the link in an iframe
while clicking the icon opens in a new tab. This is also the default value.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_examples_2"><a class="anchor" href="#_examples_2"></a>7.2.2. Examples</h4>
<div class="paragraph">
<p>In the following examples, only the part relative to menu entries in the <code>config.json</code> file is detailed, the other parts are omitted and represented with a 'â¦'.</p>
</div>
<div class="paragraph">
<p><strong>Single menu entry</strong></p>
</div>
<div class="literalblock">
<div class="content">
<pre>{
	â¦
	"menuEntries":[{
			"id": "identifer-single-menu-entry",
			"url": "https://opfab.github.io",
			"label": "single-menu-entry-i18n-key",
			"linkType": "BOTH"
		}],
}</pre>
</div>
</div>
<div class="paragraph">
<p><strong>Several menu entries</strong></p>
</div>
<div class="paragraph">
<p>Here a sample with 3 menu entries.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>{
	â¦
	"i18nLabelKey":"businessconfig-name-in-menu-navbar",
	"menuEntries": [{
			"id": "firstEntryIdentifier",
			"url": "https://opfab.github.io/whatisopfab/",
			"label": "first-menu-entry",
			"linkType": "BOTH"
		},
		{
			"id": "secondEntryIdentifier",
			"url": "https://www.lfenergy.org/",
			"label": "second-menu-entry"
		} ,
		{
			"id": "businessconfigEntryIdentifier",
			"url": "https://opfab.github.io",
			"label": "businessconfig-menu-entry"
		}]
}</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_operator_fabric_theme"><a class="anchor" href="#_operator_fabric_theme"></a>7.2.3. Operator Fabric theme</h4>
<div class="paragraph">
<p>If the page opened via the menu is in a iframe, the current theme of operator fabric will be passed as a parameter in the request send to the web site. The parameter is named opfab_theme and has the value of the current theme : DAY, NIGHT or LEGACY.</p>
</div>
<div class="paragraph">
<p>Example :</p>
</div>
<div class="literalblock">
<div class="content">
<pre> http://mysite.com/index.htm?opfab_theme=NIGHT</pre>
</div>
</div>
<div class="paragraph">
<p>When user is switching theme and the iframe is opened, the iframe will be reloaded.</p>
</div>
</div>
</div>
</div>
</div>
</div>
</body>
</html>